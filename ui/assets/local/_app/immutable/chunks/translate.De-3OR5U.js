import{r as D,t as W,b as k,i as C,c as F,d as y,e as L}from"./format-time.Dn4a2B__.js";import{d as N}from"./index.XTc-EU-b.js";import{c as $}from"./pagination.Dy4jb3no.js";import{S as f}from"./time-picker.CExCidqE.js";import{C as K,s as B,x as g,i as S,f as A,a as q,u as Y,g as P,e as Q,t as V,l as M,q as H,v as h}from"./scheduler.D6mQsyhd.js";import{i as v}from"./workflows.CygT-snF.js";import{n as m,o as U,b as j,p as E,c as z,a as J,q as G}from"./has.BnvKvYqj.js";import{t as X}from"./tokenize.4Yn0ayNB.js";import{i as w}from"./time-format.Dg4nx8-3.js";import{u as Z}from"./update-query-parameters.X4au3Pkh.js";import{S as x,i as ee,g as te,b as p,e as re,t as _}from"./index.CDeUyeTp.js";import{t as oe}from"./translate.BBe5dcco.js";function se(t,e){D(2,arguments);var r=W(t).getTime(),o=k(e);return new Date(r+o)}var ae=36e5;function Be(t,e){D(2,arguments);var r=k(e);return se(t,r*ae)}const ne={workflowId:"WorkflowId",workflowType:"WorkflowType",timeRange:"StartTime",executionStatus:"ExecutionStatus",closeTime:"CloseTime",runId:"RunId"},ie=(t,e)=>!(t===null&&!m(e)||t===void 0||t===""||typeof t=="string"&&t==="undefined"),b=({value:t,type:e,conditional:r})=>e===f.BOOL?t.toLowerCase()==="true":e===f.KEYWORDLIST&&j(r)?t:`"${t}"`,le=t=>{const e=ne[t]??t;return typeof e=="string"&&/\s/g.test(e)?"`"+e+"`":e},ue=(t,e,r,o="=",s,l)=>{const i=le(t);return r==="All"?"":l?`${i} ${r}`:m(o)?`\`${i}\` ${o} ${r}`:C(r)||F(r)?s||K(v)?`${i} ${o} "${y(r)}"`:`${i} BETWEEN "${y(r)}" AND "${L()}"`:U(o)?`\`${i}\` ${o} ${b({value:r,type:e,conditional:o})}`:`\`${i}\`${o}${b({value:r,type:e,conditional:o})}`},ce=(t,e)=>t.map(({attribute:r,type:o,value:s,conditional:l,operator:i,parenthesis:a,customDate:u})=>{if(ie(s,l)){let n=ue(r,o,s,l,e,u);return a==="("?n=`(${n}`:a===")"&&(n=`${n})`),i&&(n=`${n} ${i} `),n}}).filter(Boolean),fe=(t=[],e=!1)=>ce(t,e).join(""),I=t=>e=>e.toLowerCase()===t.toLowerCase(),me=(t,e)=>t[e+1],de=(t,e)=>t[e+2],pe=(t,e)=>t[e+3],_e=(t,e)=>t[e-2],Te=I(f.DATETIME),ye=I(f.BOOL),d=()=>({attribute:"",type:f.KEYWORD,value:"",operator:"",parenthesis:"",conditional:""}),ge={ExecutionStatus:f.KEYWORD,StartTime:f.DATETIME,CloseTime:f.DATETIME,WorkflowId:f.KEYWORD,WorkflowType:f.KEYWORD,RunId:f.KEYWORD},qe=(t,e=ge)=>{const r=X(t),o=[];let s=d();if(!t)return[];try{return r.forEach((l,i)=>{const a=me(r,i),u=de(r,i);if(e[l])if(s.attribute=l,s.type=e[l],m(a)){const n=`${a} ${u}`,c=m(n)?pe(r,i):u;s.value=c.toLocaleLowerCase()==="null"?null:c}else if(Te(e[l])){const n=u,c=w(n);if(E(a)){const T=r[i+4],R=w(T);c&&R?(s.value=`BETWEEN "${n}" AND "${T}"`,s.customDate=!0):console.error("Error parsing Datetime field from query")}else c?s.value=n:console.error("Error parsing Datetime field from query")}else ye(s.type)?(s.value=a.replace("=",""),s.conditional="="):s.value=u;if(!s.conditional&&z(l)){const n=`${l} ${a}`;m(n)?s.conditional=n:s.conditional=l}J(l)&&(s.parenthesis=l),G(l)&&!E(_e(r,i))&&(s.operator=l,o.push(s),s=d()),i===r.length-1&&(o.push(s),s=d())}),o}catch(l){return console.error("Error setting filter parameters: ",l),[]}},he=t=>{const e=t.filter(a=>a.attribute==="ExecutionStatus"&&a.value),r=t.filter(a=>a.attribute==="WorkflowId"&&a.value),o=t.filter(a=>a.attribute==="WorkflowType"&&a.value),s=t.filter(a=>a.attribute==="RunId"&&a.value),l=t.filter(a=>(a.attribute==="StartTime"||a.attribute==="CloseTime")&&a.value),i=[e,r,s,o,l].filter(a=>a.length);return i.forEach((a,u)=>{var n,c;a.length&&((n=i[u+1])!=null&&n.length)?a[a.length-1].operator="AND":a.length&&!((c=i[u+1])!=null&&c.length)&&(a[a.length-1].operator="")}),[...e,...r,...s,...o,...l]},Ee=t=>(t.forEach((e,r)=>{const o=t[r-1];o&&!o.operator&&(o.operator="AND");const s=t[r+1];s||(e.operator=""),e.operator==="OR"&&(s==null?void 0:s.attribute)!==e.attribute?(e.parenthesis="",e.operator=""):e.operator==="OR"&&(o==null?void 0:o.operator)!=="OR"?e.parenthesis="(":(o==null?void 0:o.operator)==="OR"&&e.operator!=="OR"?e.parenthesis=")":e.parenthesis=""}),t),Ye=N((t,e,r=!1)=>{const o=r?he(e):Ee(e),s=fe(o);Z({url:t,parameter:"query",value:s,allowEmpty:!1,clearParameters:[$]})},300),O=["Running","TimedOut","Completed","Failed","ContinuedAsNew","Canceled","Terminated"];function Pe(t){return O.includes(t)}const Qe=["All",...O];function we(t){let e;const r=t[5].default,o=q(r,t,t[4],null);return{c(){o&&o.c()},l(s){o&&o.l(s)},m(s,l){o&&o.m(s,l),e=!0},p(s,l){o&&o.p&&(!e||l&16)&&Y(o,r,s,s[4],e?Q(r,s[4],l,null):P(s[4]),null)},i(s){e||(_(o,s),e=!0)},o(s){p(o,s),e=!1},d(s){o&&o.d(s)}}}function be(t){let e;return{c(){e=V(t[1])},l(r){e=M(r,t[1])},m(r,o){S(r,e,o)},p(r,o){o&2&&H(e,r[1])},i:h,o:h,d(r){r&&A(e)}}}function De(t){let e,r,o,s;const l=[be,we],i=[];function a(u,n){return u[1]!==u[0]?0:1}return e=a(t),r=i[e]=l[e](t),{c(){r.c(),o=g()},l(u){r.l(u),o=g()},m(u,n){i[e].m(u,n),S(u,o,n),s=!0},p(u,[n]){let c=e;e=a(u),e===c?i[e].p(u,n):(te(),p(i[c],1,1,()=>{i[c]=null}),re(),r=i[e],r?r.p(u,n):(r=i[e]=l[e](u),r.c()),_(r,1),r.m(o.parentNode,o))},i(u){s||(_(r),s=!0)},o(u){p(r),s=!1},d(u){u&&A(o),i[e].d(u)}}}function ke(t,e,r){let o,{$$slots:s={},$$scope:l}=e,{key:i}=e,{count:a=void 0}=e,{replace:u=void 0}=e;return t.$$set=n=>{"key"in n&&r(0,i=n.key),"count"in n&&r(2,a=n.count),"replace"in n&&r(3,u=n.replace),"$$scope"in n&&r(4,l=n.$$scope)},t.$$.update=()=>{t.$$.dirty&13&&r(1,o=oe(i,{...u,count:a}))},[i,o,a,u,l,s]}class Ve extends x{constructor(e){super(),ee(this,e,ke,De,B,{key:0,count:2,replace:3})}}export{Ve as T,qe as a,Be as b,Ee as c,se as d,d as e,Qe as f,Pe as i,fe as t,Ye as u,O as w};
