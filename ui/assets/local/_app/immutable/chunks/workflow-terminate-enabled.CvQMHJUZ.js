import{s as N,O as g,Q as k,h as T,t as y,j as D,k as E,l as C,f as w,m as I,i as A,n as b,v as M,R as O,w as Q,b as L,d as U}from"./scheduler.D6mQsyhd.js";import{S as V,i as z,h as W,c as R,a as v,m as P,t as S,b as j,d as q}from"./index.CDeUyeTp.js";import{M as B}from"./modal.DXStuOTo.js";import{t as h}from"./translate.BBe5dcco.js";import{h as X,t as Y}from"./workflows.Dscw5v3j.js";import{t as F}from"./toaster.DX6n9ZJ4.js";import{i as G}from"./is-network-error.DxxRlstw.js";import{I as Z}from"./input.DXCKzLeZ.js";function x(t){let e,o=h("workflows.cancel-modal-title")+"",a;return{c(){e=T("h3"),a=y(o),this.h()},l(r){e=D(r,"H3",{slot:!0});var l=E(e);a=C(l,o),l.forEach(w),this.h()},h(){I(e,"slot","title")},m(r,l){A(r,e,l),b(e,a)},p:M,d(r){r&&w(e)}}}function $(t){let e,o=h("workflows.cancel-modal-confirmation")+"",a;return{c(){e=T("p"),a=y(o)},l(r){e=D(r,"P",{});var l=E(e);a=C(l,o),l.forEach(w)},m(r,l){A(r,e,l),b(e,a)},p:M,d(r){r&&w(e)}}}function ee(t){let e,o,a,r;function l(n){t[7](n)}function i(n){t[8](n)}let m={id:"cancel-confirmation-modal","data-testid":"cancel-confirmation-modal",confirmText:h("common.confirm"),cancelText:h("common.cancel"),loading:t[2],confirmType:"destructive",$$slots:{content:[$],title:[x]},$$scope:{ctx:t}};return t[3]!==void 0&&(m.error=t[3]),t[0]!==void 0&&(m.open=t[0]),e=new B({props:m}),g.push(()=>W(e,"error",l)),g.push(()=>W(e,"open",i)),e.$on("confirmModal",t[4]),{c(){R(e.$$.fragment)},l(n){v(e.$$.fragment,n)},m(n,s){P(e,n,s),r=!0},p(n,[s]){const c={};s&4&&(c.loading=n[2]),s&1024&&(c.$$scope={dirty:s,ctx:n}),!o&&s&8&&(o=!0,c.error=n[3],k(()=>o=!1)),!a&&s&1&&(a=!0,c.open=n[0],k(()=>a=!1)),e.$set(c)},i(n){r||(S(e.$$.fragment,n),r=!0)},o(n){j(e.$$.fragment,n),r=!1},d(n){q(e,n)}}}function oe(t,e,o){let a,r=M,l=()=>(r(),r=O(s,u=>o(9,a=u)),s);t.$$.on_destroy.push(()=>r());let{open:i}=e,{workflow:m}=e,{namespace:n}=e,{refresh:s}=e;l();let c,f="";const _=async()=>{o(3,f=""),o(2,c=!0);try{await X({namespace:n,workflow:m}),o(0,i=!1),Q(s,a=Date.now(),a),F.push({id:"workflow-cancelation-success-toast",message:h("workflows.cancel-success")})}catch(u){o(3,f=G(u)?u.message:h("common.unknown-error"))}finally{o(2,c=!1)}};function p(u){f=u,o(3,f)}function H(u){i=u,o(0,i)}return t.$$set=u=>{"open"in u&&o(0,i=u.open),"workflow"in u&&o(5,m=u.workflow),"namespace"in u&&o(6,n=u.namespace),"refresh"in u&&l(o(1,s=u.refresh))},[i,s,c,f,_,m,n,p,H]}class _e extends V{constructor(e){super(),z(this,e,oe,ee,N,{open:0,workflow:5,namespace:6,refresh:1})}}function ne(t){let e,o=h("workflows.terminate-modal-title")+"",a;return{c(){e=T("h3"),a=y(o),this.h()},l(r){e=D(r,"H3",{slot:!0});var l=E(e);a=C(l,o),l.forEach(w),this.h()},h(){I(e,"slot","title")},m(r,l){A(r,e,l),b(e,a)},p:M,d(r){r&&w(e)}}}function te(t){let e,o,a=h("workflows.terminate-modal-confirmation")+"",r,l,i,m,n;function s(f){t[9](f)}let c={id:"workflow-termination-reason",class:"mt-4",placeholder:h("common.reason-placeholder"),label:h("common.reason-placeholder"),labelHidden:!0};return t[2]!==void 0&&(c.value=t[2]),i=new Z({props:c}),g.push(()=>W(i,"value",s)),{c(){e=T("div"),o=T("p"),r=y(a),l=L(),R(i.$$.fragment),this.h()},l(f){e=D(f,"DIV",{slot:!0});var _=E(e);o=D(_,"P",{});var p=E(o);r=C(p,a),p.forEach(w),l=U(_),v(i.$$.fragment,_),_.forEach(w),this.h()},h(){I(e,"slot","content")},m(f,_){A(f,e,_),b(e,o),b(o,r),b(e,l),P(i,e,null),n=!0},p(f,_){const p={};!m&&_&4&&(m=!0,p.value=f[2],k(()=>m=!1)),i.$set(p)},i(f){n||(S(i.$$.fragment,f),n=!0)},o(f){j(i.$$.fragment,f),n=!1},d(f){f&&w(e),q(i)}}}function re(t){let e,o,a,r;function l(n){t[10](n)}function i(n){t[11](n)}let m={id:"terminate-confirmation-modal","data-testid":"terminate-confirmation-modal",loading:t[4],confirmText:h("workflows.terminate"),cancelText:h("common.cancel"),confirmType:"destructive",$$slots:{content:[te],title:[ne]},$$scope:{ctx:t}};return t[3]!==void 0&&(m.error=t[3]),t[0]!==void 0&&(m.open=t[0]),e=new B({props:m}),g.push(()=>W(e,"error",l)),g.push(()=>W(e,"open",i)),e.$on("cancelModal",t[5]),e.$on("confirmModal",t[6]),{c(){R(e.$$.fragment)},l(n){v(e.$$.fragment,n)},m(n,s){P(e,n,s),r=!0},p(n,[s]){const c={};s&16&&(c.loading=n[4]),s&8196&&(c.$$scope={dirty:s,ctx:n}),!o&&s&8&&(o=!0,c.error=n[3],k(()=>o=!1)),!a&&s&1&&(a=!0,c.open=n[0],k(()=>a=!1)),e.$set(c)},i(n){r||(S(e.$$.fragment,n),r=!0)},o(n){j(e.$$.fragment,n),r=!1},d(n){q(e,n)}}}function ae(t,e,o){let a,r=M,l=()=>(r(),r=O(s,d=>o(12,a=d)),s);t.$$.on_destroy.push(()=>r());let{open:i}=e,{workflow:m}=e,{namespace:n}=e,{refresh:s}=e;l();let c="",f="",_=!1;const p=()=>{o(0,i=!1),o(2,c="")},H=async()=>{o(3,f=""),o(4,_=!0);try{await Y({workflow:m,namespace:n,reason:c}),o(0,i=!1),o(2,c=""),Q(s,a=Date.now(),a),F.push({id:"workflow-termination-success-toast",message:h("workflows.terminate-success")})}catch(d){o(3,f=G(d)?d.message:h("common.unknown-error"))}finally{o(4,_=!1)}};function u(d){c=d,o(2,c)}function J(d){f=d,o(3,f)}function K(d){i=d,o(0,i)}return t.$$set=d=>{"open"in d&&o(0,i=d.open),"workflow"in d&&o(7,m=d.workflow),"namespace"in d&&o(8,n=d.namespace),"refresh"in d&&l(o(1,s=d.refresh))},[i,s,c,f,_,p,H,m,n,u,J,K]}class he extends V{constructor(e){super(),z(this,e,ae,re,N,{open:0,workflow:7,namespace:8,refresh:1})}}const pe=(t,e,o)=>!t.disableWriteActions&&!t.workflowCancelDisabled&&!e.namespaceWriteDisabled(o),we=(t,e,o)=>!t.disableWriteActions&&!t.workflowResetDisabled&&!e.namespaceWriteDisabled(o),be=(t,e,o)=>!t.disableWriteActions&&!t.workflowTerminateDisabled&&!e.namespaceWriteDisabled(o);export{_e as C,he as T,be as a,we as b,pe as w};
