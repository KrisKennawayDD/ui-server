import{r as w,t as A,b as k,i as W,c as F,d as T,e as C}from"./format-time.DHKJZWez.js";import{d as L}from"./index.DCL_qX-C.js";import{c as $}from"./pagination.DtS5s0gd.js";import{S as f}from"./time-picker.DJKq47sd.js";import{B,s as K,w as g,i as S,f as I,a as N,u as q,g as Y,e as P,t as Q,l as V,q as M,v as h}from"./scheduler.CnYDgCRb.js";import{s as H}from"./advanced-visibility.B1bUhm9-.js";import{o as m,p as U,d as j,q as E,e as v,c as z,r as J}from"./has.HNIa2swf.js";import{t as G}from"./tokenize.CmfjQ-T9.js";import{i as b}from"./time-format.DbjpxZci.js";import{u as X}from"./update-query-parameters.DmP6hXJd.js";import{S as Z,i as x,g as ee,b as d,e as te,t as _}from"./index.DW7Zsqzm.js";import{t as re}from"./translate.BBe5dcco.js";function oe(r,e){w(2,arguments);var t=A(r).getTime(),o=k(e);return new Date(t+o)}var se=36e5;function Ke(r,e){w(2,arguments);var t=k(e);return oe(r,t*se)}const ae={workflowId:"WorkflowId",workflowType:"WorkflowType",timeRange:"StartTime",executionStatus:"ExecutionStatus",closeTime:"CloseTime",runId:"RunId"},ne=(r,e)=>!(r===null&&!m(e)||r===void 0||r===""||typeof r=="string"&&r==="undefined"),D=({value:r,type:e,conditional:t})=>e===f.BOOL?r.toLowerCase()==="true":e===f.KEYWORDLIST&&j(t)?r:`"${r}"`,ie=r=>{const e=ae[r]??r;return typeof e=="string"&&/\s/g.test(e)?"`"+e+"`":e},le=(r,e,t,o="=",s,l)=>{const i=ie(r);return t==="All"?"":l?`${i} ${t}`:m(o)?`\`${i}\` ${o} ${t}`:W(t)||F(t)?s||B(H)?`${i} ${o} "${T(t)}"`:`${i} BETWEEN "${T(t)}" AND "${C()}"`:U(o)?`\`${i}\` ${o} ${D({value:t,type:e,conditional:o})}`:`\`${i}\`${o}${D({value:t,type:e,conditional:o})}`},ue=(r,e)=>r.map(({attribute:t,type:o,value:s,conditional:l,operator:i,parenthesis:a,customDate:u})=>{if(ne(s,l)){let n=le(t,o,s,l,e,u);return a==="("?n=`(${n}`:a===")"&&(n=`${n})`),i&&(n=`${n} ${i} `),n}}).filter(Boolean),ce=(r=[],e=!1)=>ue(r,e).join(""),O=r=>e=>e.toLowerCase()===r.toLowerCase(),fe=(r,e)=>r[e+1],me=(r,e)=>r[e+2],pe=(r,e)=>r[e+3],de=(r,e)=>r[e-2],_e=O(f.DATETIME),ye=O(f.BOOL),p=()=>({attribute:"",type:f.KEYWORD,value:"",operator:"",parenthesis:"",conditional:""}),Te={ExecutionStatus:f.KEYWORD,StartTime:f.DATETIME,CloseTime:f.DATETIME,WorkflowId:f.KEYWORD,WorkflowType:f.KEYWORD,RunId:f.KEYWORD},Ne=(r,e=Te)=>{const t=G(r),o=[];let s=p();if(!r)return[];try{return t.forEach((l,i)=>{const a=fe(t,i),u=me(t,i);if(e[l])if(s.attribute=l,s.type=e[l],m(a)){const n=`${a} ${u}`,c=m(n)?pe(t,i):u;s.value=c.toLocaleLowerCase()==="null"?null:c}else if(_e(e[l])){const n=u,c=b(n);if(E(a)){const y=t[i+4],R=b(y);c&&R?(s.value=`BETWEEN "${n}" AND "${y}"`,s.customDate=!0):console.error("Error parsing Datetime field from query")}else c?s.value=n:console.error("Error parsing Datetime field from query")}else ye(s.type)?(s.value=a.replace("=",""),s.conditional="="):s.value=u;if(!s.conditional&&v(l)){const n=`${l} ${a}`;m(n)?s.conditional=n:s.conditional=l}z(l)&&(s.parenthesis=l),J(l)&&!E(de(t,i))&&(s.operator=l,o.push(s),s=p()),i===t.length-1&&(o.push(s),s=p())}),o}catch(l){return console.error("Error setting filter parameters: ",l),[]}},ge=r=>{const e=r.filter(a=>a.attribute==="ExecutionStatus"&&a.value),t=r.filter(a=>a.attribute==="WorkflowId"&&a.value),o=r.filter(a=>a.attribute==="WorkflowType"&&a.value),s=r.filter(a=>a.attribute==="RunId"&&a.value),l=r.filter(a=>(a.attribute==="StartTime"||a.attribute==="CloseTime")&&a.value),i=[e,t,s,o,l].filter(a=>a.length);return i.forEach((a,u)=>{var n,c;a.length&&((n=i[u+1])!=null&&n.length)?a[a.length-1].operator="AND":a.length&&!((c=i[u+1])!=null&&c.length)&&(a[a.length-1].operator="")}),[...e,...t,...s,...o,...l]},he=r=>(r.forEach((e,t)=>{const o=r[t-1];o&&!o.operator&&(o.operator="AND");const s=r[t+1];s||(e.operator=""),e.operator==="OR"&&(s==null?void 0:s.attribute)!==e.attribute?(e.parenthesis="",e.operator=""):e.operator==="OR"&&(o==null?void 0:o.operator)!=="OR"?e.parenthesis="(":(o==null?void 0:o.operator)==="OR"&&e.operator!=="OR"?e.parenthesis=")":e.parenthesis=""}),r),qe=L((r,e,t=!1)=>{const o=t?ge(e):he(e),s=ce(o);X({url:r,parameter:"query",value:s,allowEmpty:!1,clearParameters:[$]})},300);function Ee(r){let e;const t=r[5].default,o=N(t,r,r[4],null);return{c(){o&&o.c()},l(s){o&&o.l(s)},m(s,l){o&&o.m(s,l),e=!0},p(s,l){o&&o.p&&(!e||l&16)&&q(o,t,s,s[4],e?P(t,s[4],l,null):Y(s[4]),null)},i(s){e||(_(o,s),e=!0)},o(s){d(o,s),e=!1},d(s){o&&o.d(s)}}}function be(r){let e;return{c(){e=Q(r[1])},l(t){e=V(t,r[1])},m(t,o){S(t,e,o)},p(t,o){o&2&&M(e,t[1])},i:h,o:h,d(t){t&&I(e)}}}function De(r){let e,t,o,s;const l=[be,Ee],i=[];function a(u,n){return u[1]!==u[0]?0:1}return e=a(r),t=i[e]=l[e](r),{c(){t.c(),o=g()},l(u){t.l(u),o=g()},m(u,n){i[e].m(u,n),S(u,o,n),s=!0},p(u,[n]){let c=e;e=a(u),e===c?i[e].p(u,n):(ee(),d(i[c],1,1,()=>{i[c]=null}),te(),t=i[e],t?t.p(u,n):(t=i[e]=l[e](u),t.c()),_(t,1),t.m(o.parentNode,o))},i(u){s||(_(t),s=!0)},o(u){d(t),s=!1},d(u){u&&I(o),i[e].d(u)}}}function we(r,e,t){let o,{$$slots:s={},$$scope:l}=e,{key:i}=e,{count:a=void 0}=e,{replace:u=void 0}=e;return r.$$set=n=>{"key"in n&&t(0,i=n.key),"count"in n&&t(2,a=n.count),"replace"in n&&t(3,u=n.replace),"$$scope"in n&&t(4,l=n.$$scope)},r.$$.update=()=>{r.$$.dirty&13&&t(1,o=re(i,{...u,count:a}))},[i,o,a,u,l,s]}class Ye extends Z{constructor(e){super(),x(this,e,we,De,K,{key:0,count:2,replace:3})}}export{Ye as T,Ne as a,Ke as b,he as c,oe as d,p as e,ce as t,qe as u};
