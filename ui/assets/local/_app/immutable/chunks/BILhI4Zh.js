import"./CWj6FrbW.js";import"./69_IOA4Y.js";import{p as tt,s as a,m as d,R as u,l as $,ag as et,g as e,a as ot,f as st,e as rt,d as at,r as G,b as nt}from"./BZ1i_Yzi.js";import{e as ct}from"./D5cC3u49.js";import{t as Y,c as lt,a as E}from"./B11KKQxI.js";import{i as ut}from"./Pfo2U1_a.js";import{e as it}from"./DT_Kaee1.js";import{i as ft}from"./EXou6kTq.js";import{p as mt}from"./DQFlnzBt.js";import{e as q,a as i,s as pt,b as wt}from"./nHCSEYHe.js";import{a as dt}from"./Dm8LSs3h.js";import{p as vt}from"./Dj0_KlMa.js";import{S as ht}from"./DLRGkYcE.js";import{w as C,q as gt,r as kt,b as D,d as yt}from"./ntMYgoxQ.js";import{w as K}from"./Cmv-jVV9.js";import{c as _t}from"./aSfmkhKo.js";import{S as xt}from"./0qJr_BNk.js";import{g as N}from"./jjbbOiV_.js";import{t as Ct,c as St}from"./BnK2GRz3.js";import{u as Wt}from"./nE2X74LK.js";import{W as It}from"./ASPrLBMs.js";const O=(v,h,s)=>{const f=Math.pow(3600/v,1/s),g=v*Math.pow(f,h);return Math.min(3600,Math.round(g))};var bt=Y("<button><!></button>"),$t=Y('<div class="flex min-h-[24px] flex-wrap items-center gap-2"></div>');function Jt(v,h){tt(h,!1);const[s,F]=pt(),f=()=>i(vt,"$page",s),g=()=>i(gt,"$queryWithParentWorkflowId",s),r=()=>i(C,"$workflowCount",s),H=()=>i(yt,"$disableWorkflowCountsRefresh",s),S=()=>i(K,"$workflowFilters",s),P=()=>i(kt,"$refresh",s),m=d(),p=d();let R=mt(h,"staticQuery",8,""),B=d([]),k=d([]),y,w=1,_=d(!1);const Q=5,W=100;dt(()=>{A()});const L=()=>{if(w+=1,clearInterval(y),w<=W){const t=O(Q,w,W)*1e3;y=setInterval(()=>M(),t)}},A=()=>{clearInterval(y),a(k,[]),q(C,u(r).newCount=0,u(r)),w=1,a(_,!0)},M=async()=>{L();try{const{count:t,groups:o}=await D({namespace:e(m),query:e(p)});q(C,u(r).newCount=parseInt(t)-r().count,u(r)),a(k,N(o))}catch(t){console.error("Fetching workflow counts failed: ",t==null?void 0:t.message)}finally{a(_,!1)}},U=async()=>{if(A(),!H()){const t=O(Q,w,W)*1e3;y=setInterval(()=>M(),t)}try{const{count:t,groups:o}=await D({namespace:e(m),query:e(p)});q(C,u(r).count=parseInt(t),u(r)),a(B,N(o))}catch(t){console.error("Fetching workflow counts failed: ",t==null?void 0:t.message)}finally{a(_,!1)}},j=t=>{if(!S().some(n=>n.attribute==="ExecutionStatus"&&n.value===t)){const n={attribute:"ExecutionStatus",type:xt.KEYWORD,value:t,operator:"",conditional:"=",parenthesis:""};wt(K,[...S(),n]);const c=Ct(St(S()));Wt({url:f().url,parameter:"query",value:c,clearParameters:[_t]})}};$(()=>f(),()=>{a(m,f().params.namespace)}),$(()=>(et(R()),g()),()=>{a(p,R()||g())}),$(()=>(e(p),e(m),P()),()=>{e(p),e(m),P(),U()}),ot(),ft();var I=$t();it(I,5,()=>e(B),({count:t,status:o})=>o,(t,o)=>{let n=()=>e(o).count,c=()=>e(o).status;var T=lt(),z=st(T);{var J=l=>{var x=bt(),X=rt(x);const Z=at(()=>e(k).find(b=>b.status===c())?e(k).find(b=>b.status===c()).count-n():0);It(X,{get status(){return c()},get count(){return n()},get newCount(){return e(Z)},get"test-id"(){return`workflow-status-${c()??""}`}}),G(x),ct("click",x,()=>j(c())),E(l,x)},V=l=>{ht(l,{class:"h-6 w-24 rounded-sm"})};ut(z,l=>{e(_)?l(V,!1):l(J)})}E(t,T)}),G(I),E(v,I),nt(),F()}export{Jt as W};
