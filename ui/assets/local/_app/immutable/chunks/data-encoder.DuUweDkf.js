import{C as o}from"./scheduler.D6mQsyhd.js";import{p as i}from"./stores.BDo9-UMc.js";import{t as k}from"./translate.BBe5dcco.js";import{a as f}from"./auth-user.Dqvoc5oP.js";import{c as u,o as m,p as E,i as A,v as O,s as h,a as y}from"./data-encoder-config.DRFArlwH.js";import{s as T}from"./parse-with-big-int.BKSBwM2t.js";const b=(e,a=u,n=m)=>{var t;return o(n)&&o(a)||((t=e==null?void 0:e.codec)==null?void 0:t.endpoint)||o(a)||""},x=(e,a=E,n=u,d=m)=>{var s,r;const t=o(d)&&o(n),p=(s=e==null?void 0:e.codec)!=null&&s.endpoint?!!((r=e==null?void 0:e.codec)!=null&&r.passAccessToken):!!o(a);return t?!!o(a):p},P=(e,a=A,n=u,d=m)=>{var s,r;const t=o(d)&&o(n),p=(s=e==null?void 0:e.codec)!=null&&s.endpoint?!!((r=e==null?void 0:e.codec)!=null&&r.includeCredentials):!!o(a);return t?!!o(a):p};async function C({type:e,payloads:a,namespace:n=o(i).params.namespace,settings:d=o(i).data.settings}){const t=b(d),p=x(d),s=P(d),r={"Content-Type":"application/json","X-Namespace":n};if(p)if(O(t)){let c=o(f).accessToken;const l=o(f).idToken;globalThis!=null&&globalThis.AccessToken?c=await(globalThis==null?void 0:globalThis.AccessToken()):l&&(r["Authorization-Extras"]=l),r.Authorization=`Bearer ${c}`}else return h(),a;const v=s?{headers:r,credentials:"include",method:"POST",body:T(a)}:{headers:r,method:"POST",body:T(a)};return fetch(t+`/${e}`,v).then(c=>{if(c.ok===!1)throw{statusCode:c.status,statusText:c.statusText,response:c,message:k(`common.${e}-failed`)};return c.json()}).then(c=>(y(),c)).catch(c=>{if(h(c),e==="decode")return a;throw c})}async function z({payloads:e,namespace:a=o(i).params.namespace,settings:n=o(i).data.settings}){return C({type:"decode",payloads:e,namespace:a,settings:n})}async function B({payloads:e,namespace:a=o(i).params.namespace,settings:n=o(i).data.settings}){return C({type:"encode",payloads:e,namespace:a,settings:n})}export{x as a,P as b,z as d,B as e,b as g};
