import{s as O,O as g,Q as k,h as T,t as y,j as D,k as E,l as C,f as w,m as I,i as A,n as b,v as M,R as Q,w as V,b as U,d as X}from"./scheduler.DpGMy-aI.js";import{S as z,i as B,h as W,c as R,a as P,m as S,t as j,b as q,d as N}from"./index.D6yvRDVo.js";import{M as F}from"./modal.jYFXws3y.js";import{t as h}from"./translate.BBe5dcco.js";import{h as Y,t as Z}from"./workflows.DT6GUvng.js";import{t as G}from"./toaster.Z0YCmz8g.js";import{i as J}from"./is-network-error.C2uLOQyq.js";import{I as v}from"./input.N_-lgQp1.js";function x(t){let e,n=h("workflows.cancel-modal-title")+"",a;return{c(){e=T("h3"),a=y(n),this.h()},l(r){e=D(r,"H3",{slot:!0});var l=E(e);a=C(l,n),l.forEach(w),this.h()},h(){I(e,"slot","title")},m(r,l){A(r,e,l),b(e,a)},p:M,d(r){r&&w(e)}}}function $(t){let e,n=h("workflows.cancel-modal-confirmation")+"",a;return{c(){e=T("p"),a=y(n)},l(r){e=D(r,"P",{});var l=E(e);a=C(l,n),l.forEach(w)},m(r,l){A(r,e,l),b(e,a)},p:M,d(r){r&&w(e)}}}function ee(t){let e,n,a,r;function l(o){t[7](o)}function i(o){t[8](o)}let m={id:"cancel-confirmation-modal","data-testid":"cancel-confirmation-modal",confirmText:h("common.confirm"),cancelText:h("common.cancel"),loading:t[2],confirmType:"destructive",$$slots:{content:[$],title:[x]},$$scope:{ctx:t}};return t[3]!==void 0&&(m.error=t[3]),t[0]!==void 0&&(m.open=t[0]),e=new F({props:m}),g.push(()=>W(e,"error",l)),g.push(()=>W(e,"open",i)),e.$on("confirmModal",t[4]),{c(){R(e.$$.fragment)},l(o){P(e.$$.fragment,o)},m(o,s){S(e,o,s),r=!0},p(o,[s]){const c={};s&4&&(c.loading=o[2]),s&1024&&(c.$$scope={dirty:s,ctx:o}),!n&&s&8&&(n=!0,c.error=o[3],k(()=>n=!1)),!a&&s&1&&(a=!0,c.open=o[0],k(()=>a=!1)),e.$set(c)},i(o){r||(j(e.$$.fragment,o),r=!0)},o(o){q(e.$$.fragment,o),r=!1},d(o){N(e,o)}}}function ne(t,e,n){let a,r=M,l=()=>(r(),r=Q(s,u=>n(9,a=u)),s);t.$$.on_destroy.push(()=>r());let{open:i}=e,{workflow:m}=e,{namespace:o}=e,{refresh:s}=e;l();let c,f="";const _=async()=>{n(3,f=""),n(2,c=!0);try{await Y({namespace:o,workflow:m}),n(0,i=!1),V(s,a=Date.now(),a),G.push({id:"workflow-cancelation-success-toast",message:h("workflows.cancel-success")})}catch(u){n(3,f=J(u)?u.message:h("common.unknown-error"))}finally{n(2,c=!1)}};function p(u){f=u,n(3,f)}function H(u){i=u,n(0,i)}return t.$$set=u=>{"open"in u&&n(0,i=u.open),"workflow"in u&&n(5,m=u.workflow),"namespace"in u&&n(6,o=u.namespace),"refresh"in u&&l(n(1,s=u.refresh))},[i,s,c,f,_,m,o,p,H]}class _e extends z{constructor(e){super(),B(this,e,ne,ee,O,{open:0,workflow:5,namespace:6,refresh:1})}}function oe(t){let e,n=h("workflows.terminate-modal-title")+"",a;return{c(){e=T("h3"),a=y(n),this.h()},l(r){e=D(r,"H3",{slot:!0});var l=E(e);a=C(l,n),l.forEach(w),this.h()},h(){I(e,"slot","title")},m(r,l){A(r,e,l),b(e,a)},p:M,d(r){r&&w(e)}}}function te(t){let e,n,a=h("workflows.terminate-modal-confirmation")+"",r,l,i,m,o;function s(f){t[9](f)}let c={id:"workflow-termination-reason",class:"mt-4",placeholder:h("common.reason-placeholder"),label:h("common.reason-placeholder"),labelHidden:!0};return t[2]!==void 0&&(c.value=t[2]),i=new v({props:c}),g.push(()=>W(i,"value",s)),{c(){e=T("div"),n=T("p"),r=y(a),l=U(),R(i.$$.fragment),this.h()},l(f){e=D(f,"DIV",{slot:!0});var _=E(e);n=D(_,"P",{});var p=E(n);r=C(p,a),p.forEach(w),l=X(_),P(i.$$.fragment,_),_.forEach(w),this.h()},h(){I(e,"slot","content")},m(f,_){A(f,e,_),b(e,n),b(n,r),b(e,l),S(i,e,null),o=!0},p(f,_){const p={};!m&&_&4&&(m=!0,p.value=f[2],k(()=>m=!1)),i.$set(p)},i(f){o||(j(i.$$.fragment,f),o=!0)},o(f){q(i.$$.fragment,f),o=!1},d(f){f&&w(e),N(i)}}}function re(t){let e,n,a,r;function l(o){t[10](o)}function i(o){t[11](o)}let m={id:"terminate-confirmation-modal","data-testid":"terminate-confirmation-modal",loading:t[4],confirmText:h("workflows.terminate"),cancelText:h("common.cancel"),confirmType:"destructive",$$slots:{content:[te],title:[oe]},$$scope:{ctx:t}};return t[3]!==void 0&&(m.error=t[3]),t[0]!==void 0&&(m.open=t[0]),e=new F({props:m}),g.push(()=>W(e,"error",l)),g.push(()=>W(e,"open",i)),e.$on("cancelModal",t[5]),e.$on("confirmModal",t[6]),{c(){R(e.$$.fragment)},l(o){P(e.$$.fragment,o)},m(o,s){S(e,o,s),r=!0},p(o,[s]){const c={};s&16&&(c.loading=o[4]),s&8196&&(c.$$scope={dirty:s,ctx:o}),!n&&s&8&&(n=!0,c.error=o[3],k(()=>n=!1)),!a&&s&1&&(a=!0,c.open=o[0],k(()=>a=!1)),e.$set(c)},i(o){r||(j(e.$$.fragment,o),r=!0)},o(o){q(e.$$.fragment,o),r=!1},d(o){N(e,o)}}}function ae(t,e,n){let a,r=M,l=()=>(r(),r=Q(s,d=>n(12,a=d)),s);t.$$.on_destroy.push(()=>r());let{open:i}=e,{workflow:m}=e,{namespace:o}=e,{refresh:s}=e;l();let c="",f="",_=!1;const p=()=>{n(0,i=!1),n(2,c="")},H=async()=>{n(3,f=""),n(4,_=!0);try{await Z({workflow:m,namespace:o,reason:c}),n(0,i=!1),n(2,c=""),V(s,a=Date.now(),a),G.push({id:"workflow-termination-success-toast",message:h("workflows.terminate-success")})}catch(d){n(3,f=J(d)?d.message:h("common.unknown-error"))}finally{n(4,_=!1)}};function u(d){c=d,n(2,c)}function K(d){f=d,n(3,f)}function L(d){i=d,n(0,i)}return t.$$set=d=>{"open"in d&&n(0,i=d.open),"workflow"in d&&n(7,m=d.workflow),"namespace"in d&&n(8,o=d.namespace),"refresh"in d&&l(n(1,s=d.refresh))},[i,s,c,f,_,p,H,m,o,u,K,L]}class he extends z{constructor(e){super(),B(this,e,ae,re,O,{open:0,workflow:7,namespace:8,refresh:1})}}const pe=(t,e,n)=>!t.disableWriteActions&&!t.workflowCancelDisabled&&!e.namespaceWriteDisabled(n),we=(t,e,n)=>!t.disableWriteActions&&!t.workflowResetDisabled&&!e.namespaceWriteDisabled(n),be=(t,e,n)=>!t.disableWriteActions&&!t.workflowTerminateDisabled&&!e.namespaceWriteDisabled(n);export{_e as C,he as T,be as a,we as b,pe as w};
