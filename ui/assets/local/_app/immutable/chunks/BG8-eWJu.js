import"./CWj6FrbW.js";import"./69_IOA4Y.js";import{p as ye,s as ee,m as le,g as v,l as de,a as De,aJ as we,f as I,c as B,e as q,d as C,r as j,t as ce,b as ze}from"./BZ1i_Yzi.js";import{s as ge}from"./BtIgVYD3.js";import{i as te}from"./Pfo2U1_a.js";import{t as ae,a as p,c as w}from"./B11KKQxI.js";import{s as y}from"./DBXxAZ3D.js";import{a as Ne}from"./BqyZnqh5.js";import{e as ke}from"./D5cC3u49.js";import{i as Le}from"./EXou6kTq.js";import{l as ue,p as o}from"./DQFlnzBt.js";import{a as Ae,s as Ke}from"./nHCSEYHe.js";import{w as Ee,d as fe,o as Be}from"./Dm8LSs3h.js";import{A as Fe}from"./CR4vVWSJ.js";import{E as me}from"./BH5Z54-t.js";import{I as xe}from"./CYULiNvw.js";import{L as Te}from"./CJSepuex.js";import{F as Me}from"./CcN69p23.js";import{p as Re}from"./ekiUO8I7.js";import{o as he,p as Se,b as Ue,d as G}from"./aSfmkhKo.js";import{m as He}from"./BqNaQ_Wm.js";import{P as Oe}from"./Eh9NQq1d.js";const ve={key:Se,loading:!0,updating:!1,hasNext:!1,hasPrevious:!1,index:0,previousPageSize:G,pageSize:G,indexData:{},visibleItems:[],hasNextIndexData:!1,indexStart:0,indexEnd:0,activeIndex:0},pe=S=>{const a=S[0];if(!a)return G;const f=parseInt(a.toString());return isNaN(f)?G:f},We=(S,a=void 0)=>{if(a){const f=parseInt(a.toString());return isNaN(f)?pe(S):f}else return pe(S)};function Je(S=he,a=void 0){const f=We(S,a),F=Ee({...ve,previousPageSize:f,pageSize:f}),{set:Q,update:m}=F,n=fe([Re],([e])=>{const t=e.url.searchParams.get(Se);return t?Ue(t):void 0}),{subscribe:k}=fe([F,n],([e,t])=>{var L,H,O;const l=((L=e.indexData[e.index])==null?void 0:L.items)??[],g=((H=e.indexData[e.index])==null?void 0:H.start)??0,i=((O=e.indexData[e.index])==null?void 0:O.end)??0,Y=!!e.indexData[e.index+1];return{...e,visibleItems:l,indexStart:g,indexEnd:i,hasNextIndexData:Y,pageSize:t??e.pageSize}}),V=(e,t,l)=>{const g=l.index,i={...l,indexData:{...l.indexData},hasNext:!!e,updating:!1,loading:!1};return t.length?(i.indexData[g]?(i.index=g+1,i.indexData[i.index]={nextToken:e,start:i.indexData[g].end+1,end:i.indexData[g].end+t.length,items:t},i.hasPrevious=!0):(i.indexData[g]={nextToken:e,start:1,end:t.length,items:t},i.hasPrevious=!1),i):{...i,hasNext:!1}},X=e=>{var l;const t={...e,index:e.index+1,hasPrevious:!0,loading:!1,updating:!1};return(l=t.indexData[t.index])!=null&&l.nextToken||(t.hasNext=!1),t},z=e=>{const t={...e,hasNext:!0,updating:!1,loading:!1,index:e.index>0?e.index-1:0};return t.index===0&&(t.hasPrevious=!1),t},T=e=>{var g,i;const t={...e},l=((i=(g=t.indexData[t.index])==null?void 0:g.items)==null?void 0:i.length)??0;return t.activeIndex<l-1&&(t.activeIndex=t.activeIndex+1),t},M=e=>{const t={...e},l=t.activeIndex>=1?t.activeIndex-1:0;return t.activeIndex=l,t},R=(e,t)=>({...e,activeIndex:t}),U=(e,t)=>({...e,pageSize:t,previousPageSize:t,index:0,indexData:{},loading:!0,updating:!1});return{subscribe:k,nextPageWithItems:(e,t)=>m(l=>V(e,t,l)),nextPage:()=>m(e=>X(e)),previousPage:()=>m(e=>z(e)),setUpdating:()=>m(e=>({...e,updating:!0})),reset:()=>Q(ve),resetPageSize:e=>m(t=>U(t,e)),nextRow:()=>m(e=>T(e)),previousRow:()=>m(e=>M(e)),setActiveIndex:e=>m(t=>R(t,e))}}var qe=ae("<p> </p>"),Ce=ae('<nav class="flex shrink-0 items-center gap-2" slot="actions-end"><!> <!> <div class="flex gap-1"><p> </p> <!></div> <!></nav>'),je=ae("<!> <!>",1);function xt(S,a){const f=ue(a,["children","$$slots","$$events","$$legacy"]),F=ue(f,["id","maxHeight","onError","onFetch","onShiftUp","onShiftDown","onSpace","total","pageSizeSelectLabel","emptyStateTitle","emptyStateMessage","errorTitle","errorMessage","itemsKeyname","previousButtonLabel","nextButtonLabel","pageSizeOptions"]);ye(a,!1);const[Q,m]=Ke(),n=()=>Ae(u,"$store",Q),k=le();let V=o(a,"id",8,null),X=o(a,"maxHeight",8,""),z=o(a,"onError",8,void 0),T=o(a,"onFetch",8),M=o(a,"onShiftUp",8,void 0),R=o(a,"onShiftDown",8,void 0),U=o(a,"onSpace",8,void 0),e=o(a,"total",8,""),t=o(a,"pageSizeSelectLabel",8),l=o(a,"emptyStateTitle",8,""),g=o(a,"emptyStateMessage",8,""),i=o(a,"errorTitle",8,""),Y=o(a,"errorMessage",8,""),L=o(a,"itemsKeyname",8,"items"),H=o(a,"previousButtonLabel",8),O=o(a,"nextButtonLabel",8),Z=o(a,"pageSizeOptions",8,he),u=Je(Z(),Z()[0]),N=le();function Pe(){v(N)&&ee(N,void 0)}Be(()=>{W()});async function W(){const r=await T()();try{const d=await r(n().pageSize,""),{nextPageToken:s}=d,c=d[L()]||[];u.nextPageWithItems(s,c)}catch(d){ee(N,d),z()&&z()(v(N))}}async function ne(){if(Pe(),u.setUpdating(),n().hasNextIndexData)u.nextPage();else try{const d=await(await T()())(n().pageSize,n().indexData[n().index].nextToken),{nextPageToken:s}=d,c=d[L()]||[];u.nextPageWithItems(s,c)}catch(r){He(r)&&z()&&z()(r)}}async function _e(r){const d=r.shiftKey;switch(r.code){case"ArrowRight":case"KeyL":n().hasNext&&!n().updating&&ne();break;case"ArrowLeft":case"KeyH":n().hasPrevious&&!n().updating&&u.previousPage();break;case"ArrowUp":case"KeyK":d&&M()?(M()(r),u.reset(),W()):u.previousRow();break;case"ArrowDown":case"KeyJ":d&&R()?(R()(r),u.reset(),W()):u.nextRow();break;case"Space":U()&&U()(r);break}}de(()=>n(),()=>{ee(k,!n().loading&&n().pageSize!==n().previousPageSize)}),de(()=>(v(k),n()),()=>{v(k)&&(u.resetPageSize(n().pageSize),W())}),De(),Le();var re=je();ke("keydown",we,_e);var se=I(re);y(se,a,"header",{get visibleItems(){return n().visibleItems}},null);var be=B(se,2);Oe(be,{get updating(){return n().updating},get visibleItems(){return n().visibleItems},get maxHeight(){return X()},get id(){return V()},children:(r,d)=>{var s=w(),c=I(s);y(c,a,"default",{get visibleItems(){return n().visibleItems}},null),p(r,s)},$$slots:{default:!0,caption:(r,d)=>{var s=w(),c=I(s);y(c,a,"caption",{},null),p(r,s)},headers:(r,d)=>{var s=w(),c=I(s);y(c,a,"headers",{get visibleItems(){return n().visibleItems}},null),p(r,s)},empty:(r,d)=>{var s=w(),c=I(s);{var J=x=>{var P=w(),A=I(P);y(A,a,"loading",{},K=>{Te(K,{})}),p(x,P)},$=(x,P)=>{{var A=_=>{var D=w(),E=I(D);y(E,a,"error",{},h=>{me(h,{get title(){return i()},children:(b,ie)=>{const Ie=C(()=>{var oe;return((oe=v(N))==null?void 0:oe.message)??Y()});Fe(b,{intent:"error",get title(){return v(Ie)}})},$$slots:{default:!0}})}),p(_,D)},K=_=>{var D=w(),E=I(D);y(E,a,"empty",{},h=>{me(h,{get title(){return l()},get content(){return g()}})}),p(_,D)};te(x,_=>{v(N)?_(A):_(K,!1)},P)}};te(c,x=>{n().loading?x(J):x($,!1)})}p(r,s)},"actions-start":(r,d)=>{const s=C(()=>String(n().pageSize));Me(r,{get label(){return t()},get parameter(){return n().key},get value(){return v(s)},get options(){return Z()}})},"actions-end":(r,d)=>{var s=Ce(),c=q(s);y(c,a,"actions-end-additional",{},null);var J=B(c,2);const $=C(()=>!n().hasPrevious);xe(J,{get label(){return H()},get disabled(){return v($)},icon:"arrow-left",$$events:{click(...h){var b;(b=u.previousPage)==null||b.apply(this,h)}}});var x=B(J,2),P=q(x),A=q(P);j(P);var K=B(P,2);{var _=h=>{var b=qe(),ie=q(b);j(b),ce(()=>ge(ie,`of ${e()??""}`)),p(h,b)};te(K,h=>{e()&&h(_)})}j(x);var D=B(x,2);const E=C(()=>!n().hasNext);xe(D,{get label(){return O()},get disabled(){return v(E)},icon:"arrow-right",$$events:{click:ne}}),j(s),ce(()=>{Ne(s,"aria-label",F["aria-label"]),ge(A,`${n().indexStart??""}â€“${n().indexEnd??""}`)}),p(r,s)}}}),p(S,re),ze(),m()}export{xt as A};
