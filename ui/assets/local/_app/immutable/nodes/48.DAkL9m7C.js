import{s as re,Z as oe,O as ie,h as V,b as H,t as I,j as O,k as j,f as g,d as R,l as C,m as A,i as Q,n as u,q as le,Q as fe,c as ae,v as X}from"../chunks/scheduler.9nPpm2FE.js";import{S as me,i as ue,h as ce,c as Z,a as z,m as q,t as B,b as G,d as J}from"../chunks/index.DU2w1i_i.js";import{g as se}from"../chunks/entry.BnrqSNdt.js";import{p as de}from"../chunks/stores.DQl3R5KN.js";import{P as pe}from"../chunks/page-title.BVcIpxci.js";import{t as E}from"../chunks/translate.BBe5dcco.js";import{B as ne}from"../chunks/button.ASfs1XfZ.js";import{I as ge}from"../chunks/input.DnIzuT8h.js";import{L as _e}from"../chunks/link.CRLUV_UH.js";import{M as he}from"../chunks/modal.CIlu75QW.js";import{N as ve,e as be}from"../chunks/nexus-form.B3k6GOw9.js";import{j as te,h as Ne}from"../chunks/route-for.CQm-TdAU.js";import{u as $e,d as we}from"../chunks/nexus-service.2mU2UEnf.js";import{n as Ee}from"../chunks/namespaces.aUGB5IqN.js";import{e as Le}from"../chunks/encode-payload.MCQ021qC.js";function De(e){let n=E("nexus.back-to-endpoint")+"",t;return{c(){t=I(n)},l(a){t=C(a,n)},m(a,i){Q(a,t,i)},p:X,d(a){a&&g(t)}}}function ke(e){let n=E("common.save")+"",t;return{c(){t=I(n)},l(a){t=C(a,n)},m(a,i){Q(a,t,i)},p:X,d(a){a&&g(t)}}}function Pe(e){let n=E("common.cancel")+"",t;return{c(){t=I(n)},l(a){t=C(a,n)},m(a,i){Q(a,t,i)},p:X,d(a){a&&g(t)}}}function Te(e){let n=E("common.delete")+"",t;return{c(){t=I(n)},l(a){t=C(a,n)},m(a,i){Q(a,t,i)},p:X,d(a){a&&g(t)}}}function Ie(e){let n=E("common.cancel")+"",t;return{c(){t=I(n)},l(a){t=C(a,n)},m(a,i){Q(a,t,i)},p:X,d(a){a&&g(t)}}}function Ce(e){let n,t=E("nexus.delete-modal-title")+"",a;return{c(){n=V("h3"),a=I(t),this.h()},l(i){n=O(i,"H3",{slot:!0});var s=j(n);a=C(s,t),s.forEach(g),this.h()},h(){A(n,"slot","title")},m(i,s){Q(i,n,s),u(n,a)},p:X,d(i){i&&g(n)}}}function He(e){let n,t,a=E("nexus.delete-modal-confirmation-preface")+"",i,s,m,_=e[0].spec.name+"",d,$,h=E("nexus.delete-modal-confirmation-postface")+"",S,b,l,v=E("nexus.type-confirm-preface")+"",P,L,M,N=e[0].spec.name+"",F,D,x=E("nexus.type-confirm-postface")+"",o,W,k,Y,K;function f(p){e[16](p)}let r={id:"delete-endpoint",labelHidden:!0,label:E("nexus.delete-endpoint")};return e[11]!==void 0&&(r.value=e[11]),k=new ge({props:r}),ie.push(()=>ce(k,"value",f)),{c(){n=V("div"),t=V("p"),i=I(a),s=H(),m=V("strong"),d=I(_),$=I(`?
      `),S=I(h),b=H(),l=V("p"),P=I(v),L=H(),M=V("strong"),F=I(N),D=H(),o=I(x),W=H(),Z(k.$$.fragment),this.h()},l(p){n=O(p,"DIV",{slot:!0,class:!0});var c=j(n);t=O(c,"P",{});var w=j(t);i=C(w,a),s=R(w),m=O(w,"STRONG",{class:!0});var U=j(m);d=C(U,_),U.forEach(g),$=C(w,`?
      `),S=C(w,h),w.forEach(g),b=R(c),l=O(c,"P",{});var T=j(l);P=C(T,v),L=R(T),M=O(T,"STRONG",{class:!0});var y=j(M);F=C(y,N),y.forEach(g),D=R(T),o=C(T,x),T.forEach(g),W=R(c),z(k.$$.fragment,c),c.forEach(g),this.h()},h(){A(m,"class","select-all"),A(M,"class","select-all"),A(n,"slot","content"),A(n,"class","flex flex-col gap-4")},m(p,c){Q(p,n,c),u(n,t),u(t,i),u(t,s),u(t,m),u(m,d),u(t,$),u(t,S),u(n,b),u(n,l),u(l,P),u(l,L),u(l,M),u(M,F),u(l,D),u(l,o),u(n,W),q(k,n,null),K=!0},p(p,c){(!K||c&1)&&_!==(_=p[0].spec.name+"")&&le(d,_),(!K||c&1)&&N!==(N=p[0].spec.name+"")&&le(F,N);const w={};!Y&&c&2048&&(Y=!0,w.value=p[11],fe(()=>Y=!1)),k.$set(w)},i(p){K||(B(k.$$.fragment,p),K=!0)},o(p){G(k.$$.fragment,p),K=!1},d(p){p&&g(n),J(k)}}}function Re(e){let n,t,a,i,s,m,_=e[0].spec.name+"",d,$,h,S,b,l,v,P,L,M,N,F,D,x,o,W,k;a=new _e({props:{href:te(e[12].params.id),icon:"chevron-left",$$slots:{default:[De]},$$scope:{ctx:e}}}),h=new ve({props:{endpoint:e[0],nameHintText:e[9],nameRegexPattern:e[8],targetNamespaceList:e[1],callerNamespaceList:e[2],error:e[5],isCloud:e[7],nameDisabled:!0}}),v=new ne({props:{class:"max-sm:w-full",loading:e[6],$$slots:{default:[ke]},$$scope:{ctx:e}}}),v.$on("click",function(){oe(e[3])&&e[3].apply(this,arguments)}),L=new ne({props:{class:"max-sm:hidden",variant:"ghost",$$slots:{default:[Pe]},$$scope:{ctx:e}}}),L.$on("click",e[13]),N=new ne({props:{class:"max-sm:w-full",variant:"destructive",$$slots:{default:[Te]},$$scope:{ctx:e}}}),N.$on("click",e[14]),D=new ne({props:{class:"w-full sm:hidden",variant:"ghost",$$slots:{default:[Ie]},$$scope:{ctx:e}}}),D.$on("click",e[15]);function Y(f){e[17](f)}let K={id:"delete-endpoint-modal",loading:e[6],confirmType:"destructive",confirmText:E("common.delete"),cancelText:E("common.cancel"),confirmDisabled:e[11]!==e[0].spec.name,$$slots:{content:[He],title:[Ce]},$$scope:{ctx:e}};return e[10]!==void 0&&(K.open=e[10]),o=new he({props:K}),ie.push(()=>ce(o,"open",Y)),o.$on("confirmModal",function(){oe(e[4])&&e[4].apply(this,arguments)}),o.$on("cancelModal",e[18]),{c(){n=V("div"),t=V("div"),Z(a.$$.fragment),i=H(),s=V("div"),m=V("h1"),d=I(_),$=H(),Z(h.$$.fragment),S=H(),b=V("div"),l=V("div"),Z(v.$$.fragment),P=H(),Z(L.$$.fragment),M=H(),Z(N.$$.fragment),F=H(),Z(D.$$.fragment),x=H(),Z(o.$$.fragment),this.h()},l(f){n=O(f,"DIV",{class:!0});var r=j(n);t=O(r,"DIV",{class:!0});var p=j(t);z(a.$$.fragment,p),p.forEach(g),i=R(r),s=O(r,"DIV",{class:!0});var c=j(s);m=O(c,"H1",{"data-testid":!0});var w=j(m);d=C(w,_),w.forEach(g),c.forEach(g),$=R(r),z(h.$$.fragment,r),S=R(r),b=O(r,"DIV",{class:!0});var U=j(b);l=O(U,"DIV",{class:!0});var T=j(l);z(v.$$.fragment,T),P=R(T),z(L.$$.fragment,T),T.forEach(g),M=R(U),z(N.$$.fragment,U),F=R(U),z(D.$$.fragment,U),U.forEach(g),r.forEach(g),x=R(f),z(o.$$.fragment,f),this.h()},h(){A(t,"class","relative flex flex-col gap-4 text-sm"),A(m,"data-testid","namespace-selector-title"),A(s,"class","flex flex-col gap-1"),A(l,"class","items-centeritems-center flex w-full flex-row gap-4 max-sm:flex-col"),A(b,"class","flex w-full flex-row items-center justify-between gap-4 max-sm:flex-col xl:w-1/2"),A(n,"class","flex flex-col gap-8")},m(f,r){Q(f,n,r),u(n,t),q(a,t,null),u(n,i),u(n,s),u(s,m),u(m,d),u(n,$),q(h,n,null),u(n,S),u(n,b),u(b,l),q(v,l,null),u(l,P),q(L,l,null),u(b,M),q(N,b,null),u(b,F),q(D,b,null),Q(f,x,r),q(o,f,r),k=!0},p(f,[r]){e=f;const p={};r&4096&&(p.href=te(e[12].params.id)),r&524288&&(p.$$scope={dirty:r,ctx:e}),a.$set(p),(!k||r&1)&&_!==(_=e[0].spec.name+"")&&le(d,_);const c={};r&1&&(c.endpoint=e[0]),r&512&&(c.nameHintText=e[9]),r&256&&(c.nameRegexPattern=e[8]),r&2&&(c.targetNamespaceList=e[1]),r&4&&(c.callerNamespaceList=e[2]),r&32&&(c.error=e[5]),r&128&&(c.isCloud=e[7]),h.$set(c);const w={};r&64&&(w.loading=e[6]),r&524288&&(w.$$scope={dirty:r,ctx:e}),v.$set(w);const U={};r&524288&&(U.$$scope={dirty:r,ctx:e}),L.$set(U);const T={};r&524288&&(T.$$scope={dirty:r,ctx:e}),N.$set(T);const y={};r&524288&&(y.$$scope={dirty:r,ctx:e}),D.$set(y);const ee={};r&64&&(ee.loading=e[6]),r&2049&&(ee.confirmDisabled=e[11]!==e[0].spec.name),r&526337&&(ee.$$scope={dirty:r,ctx:e}),!W&&r&1024&&(W=!0,ee.open=e[10],fe(()=>W=!1)),o.$set(ee)},i(f){k||(B(a.$$.fragment,f),B(h.$$.fragment,f),B(v.$$.fragment,f),B(L.$$.fragment,f),B(N.$$.fragment,f),B(D.$$.fragment,f),B(o.$$.fragment,f),k=!0)},o(f){G(a.$$.fragment,f),G(h.$$.fragment,f),G(v.$$.fragment,f),G(L.$$.fragment,f),G(N.$$.fragment,f),G(D.$$.fragment,f),G(o.$$.fragment,f),k=!1},d(f){f&&(g(n),g(x)),J(a),J(h),J(v),J(L),J(N),J(D),J(o,f)}}}function Se(e,n,t){let a;ae(e,de,o=>t(12,a=o));let{endpoint:i}=n,{targetNamespaceList:s=[]}=n,{callerNamespaceList:m=[]}=n,{onUpdate:_}=n,{onDelete:d}=n,{error:$=void 0}=n,{loading:h=!1}=n,{isCloud:S=!1}=n,{nameRegexPattern:b=/^[a-zA-Z][a-zA-Z0-9-]*[a-zA-Z0-9]$/}=n,{nameHintText:l=E("nexus.endpoint-name-hint-with-dash")}=n,v=!1,P="";const L=()=>se(te(a.params.id)),M=()=>t(10,v=!0),N=()=>se(te(a.params.id));function F(o){P=o,t(11,P)}function D(o){v=o,t(10,v)}const x=()=>t(10,v=!1);return e.$$set=o=>{"endpoint"in o&&t(0,i=o.endpoint),"targetNamespaceList"in o&&t(1,s=o.targetNamespaceList),"callerNamespaceList"in o&&t(2,m=o.callerNamespaceList),"onUpdate"in o&&t(3,_=o.onUpdate),"onDelete"in o&&t(4,d=o.onDelete),"error"in o&&t(5,$=o.error),"loading"in o&&t(6,h=o.loading),"isCloud"in o&&t(7,S=o.isCloud),"nameRegexPattern"in o&&t(8,b=o.nameRegexPattern),"nameHintText"in o&&t(9,l=o.nameHintText)},[i,s,m,_,d,$,h,S,b,l,v,P,a,L,M,N,F,D,x]}class Me extends me{constructor(n){super(),ue(this,n,Se,Re,re,{endpoint:0,targetNamespaceList:1,callerNamespaceList:2,onUpdate:3,onDelete:4,error:5,loading:6,isCloud:7,nameRegexPattern:8,nameHintText:9})}}function Ue(e){let n,t,a,i;return n=new pe({props:{title:`Edit ${E("nexus.nexus-endpoint",{id:e[4].params.id})}`,url:e[4].url.href}}),a=new Me({props:{endpoint:e[3],loading:e[1],targetNamespaceList:e[2],onUpdate:e[5],onDelete:e[6],error:e[0]}}),{c(){Z(n.$$.fragment),t=H(),Z(a.$$.fragment)},l(s){z(n.$$.fragment,s),t=R(s),z(a.$$.fragment,s)},m(s,m){q(n,s,m),Q(s,t,m),q(a,s,m),i=!0},p(s,[m]){const _={};m&16&&(_.title=`Edit ${E("nexus.nexus-endpoint",{id:s[4].params.id})}`),m&16&&(_.url=s[4].url.href),n.$set(_);const d={};m&8&&(d.endpoint=s[3]),m&2&&(d.loading=s[1]),m&4&&(d.targetNamespaceList=s[2]),m&1&&(d.error=s[0]),a.$set(d)},i(s){i||(B(n.$$.fragment,s),B(a.$$.fragment,s),i=!0)},o(s){G(n.$$.fragment,s),G(a.$$.fragment,s),i=!1},d(s){s&&g(t),J(n,s),J(a,s)}}}function Ve(e,n,t){let a,i,s,m,_;ae(e,Ee,l=>t(8,s=l)),ae(e,be,l=>t(9,m=l)),ae(e,de,l=>t(4,_=l));let{data:d}=n,$,h=!1;const S=async()=>{t(0,$=void 0),t(1,h=!0);const l={...m};l.id=a.id,l.version=a.version;const v=await Le(JSON.stringify(l.spec.descriptionString),"json/plain");l.spec.description=v[0],delete l.spec.allowedCallerNamespaces,delete l.spec.descriptionString;try{await $e(a.id,l),se(te(a.id),{invalidateAll:!0})}catch(P){t(0,$=P),console.error("Error updating endpoint",P)}finally{t(1,h=!1)}},b=async()=>{t(0,$=void 0),t(1,h=!0);try{await we(a.id,a.version),se(Ne())}catch(l){t(0,$=l),console.error("Error deleting endpoint",l)}finally{t(1,h=!1)}};return e.$$set=l=>{"data"in l&&t(7,d=l.data)},e.$$.update=()=>{e.$$.dirty&128&&t(3,{endpoint:a}=d,a),e.$$.dirty&256&&t(2,i=s.map(l=>({namespace:l.namespaceInfo.name})))},[$,h,i,a,_,S,b,d,s]}class Ye extends me{constructor(n){super(),ue(this,n,Ve,Ue,re,{data:7})}}export{Ye as component};
