import{s as K,d as b,x as ne,i as j,h as S,j as q,k as D,l as F,e as L,n as O,f as R,c as A,m as M,t as Q,L as G}from"../chunks/scheduler.gES7FyoG.js";import{S as U,i as X,d as B,t as I,a as k,g as se,e as ae,m as N,c as T,b as H}from"../chunks/index.DpnGbpCk.js";import{p as Z}from"../chunks/stores.B0SQCL2i.js";import{P as le}from"../chunks/page-title.ClCB4mI7.js";import{t as ie}from"../chunks/translate.DzDeFYDI.js";import{e as V}from"../chunks/each.CDwUSmAp.js";import{E as fe}from"../chunks/event-summary-row.SB9gBnx6.js";import{B as W}from"../chunks/button.DnzbVSae.js";import{g as ue}from"../chunks/index.C5GB247I.js";import{i as me}from"../chunks/index.CPpkv-UM.js";import{f as pe}from"../chunks/events-service.Db4JJbCt.js";import{f as C,a as ce}from"../chunks/events.CKkD_kJV.js";import{w as de}from"../chunks/workflow-run.BG9FHm2N.js";function Y(t,r,e){const a=t.slice();return a[23]=r[e],a[25]=e,a}function ge(t){let r;return{c(){r=Q("Show Previous 10")},l(e){r=M(e,"Show Previous 10")},m(e,a){j(e,r,a)},d(e){e&&b(r)}}}function J(t){let r,e;function a(...s){return t[20](t[23],...s)}return r=new fe({props:{event:t[23],index:t[25],expanded:t[23].id===t[2],group:t[6].find(a),initialItem:t[3][0]}}),{c(){H(r.$$.fragment)},l(s){T(r.$$.fragment,s)},m(s,o){N(r,s,o),e=!0},p(s,o){t=s;const m={};o&2&&(m.event=t[23]),o&6&&(m.expanded=t[23].id===t[2]),o&66&&(m.group=t[6].find(a)),o&8&&(m.initialItem=t[3][0]),r.$set(m)},i(s){e||(k(r.$$.fragment,s),e=!0)},o(s){I(r.$$.fragment,s),e=!1},d(s){B(r,s)}}}function he(t){let r;return{c(){r=Q("Show Next 10")},l(e){r=M(e,"Show Next 10")},m(e,a){j(e,r,a)},d(e){e&&b(r)}}}function _e(t){let r,e,a,s,o,m,p,d,g,$;e=new W({props:{variant:"secondary",size:"xs",leadingIcon:"arrow-up",disabled:t[0][0]==="1"||t[5],"data-testid":"load-previous",$$slots:{default:[ge]},$$scope:{ctx:t}}}),e.$on("click",t[7]);let h=V(t[1]),i=[];for(let n=0;n<h.length;n+=1)i[n]=J(Y(t,h,n));const P=n=>I(i[n],1,1,()=>{i[n]=null});return g=new W({props:{variant:"secondary",size:"xs",leadingIcon:"arrow-down",disabled:t[0][t[0].length-1]===t[4]||t[5],"data-testid":"load-next",$$slots:{default:[he]},$$scope:{ctx:t}}}),g.$on("click",t[8]),{c(){r=O("div"),H(e.$$.fragment),a=R(),s=O("table"),o=O("thead"),m=R(),p=O("tbody");for(let n=0;n<i.length;n+=1)i[n].c();d=R(),H(g.$$.fragment),this.h()},l(n){r=D(n,"DIV",{class:!0,"data-testid":!0});var l=F(r);T(e.$$.fragment,l),a=L(l),s=D(l,"TABLE",{});var f=F(s);o=D(f,"THEAD",{}),F(o).forEach(b),m=L(f),p=D(f,"TBODY",{class:!0});var _=F(p);for(let u=0;u<i.length;u+=1)i[u].l(_);_.forEach(b),f.forEach(b),d=L(l),T(g.$$.fragment,l),l.forEach(b),this.h()},h(){q(p,"class","svelte-4cez6d"),q(r,"class","flex flex-col gap-2 px-8 pb-24 pt-2"),q(r,"data-testid","event-summary-log")},m(n,l){j(n,r,l),N(e,r,null),S(r,a),S(r,s),S(s,o),S(s,m),S(s,p);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(p,null);S(r,d),N(g,r,null),$=!0},p(n,[l]){const f={};if(l&33&&(f.disabled=n[0][0]==="1"||n[5]),l&67108864&&(f.$$scope={dirty:l,ctx:n}),e.$set(f),l&78){h=V(n[1]);let u;for(u=0;u<h.length;u+=1){const w=Y(n,h,u);i[u]?(i[u].p(w,l),k(i[u],1)):(i[u]=J(w),i[u].c(),k(i[u],1),i[u].m(p,null))}for(se(),u=h.length;u<i.length;u+=1)P(u);ae()}const _={};l&49&&(_.disabled=n[0][n[0].length-1]===n[4]||n[5]),l&67108864&&(_.$$scope={dirty:l,ctx:n}),g.$set(_)},i(n){if(!$){k(e.$$.fragment,n);for(let l=0;l<h.length;l+=1)k(i[l]);k(g.$$.fragment,n),$=!0}},o(n){I(e.$$.fragment,n),i=i.filter(Boolean);for(let l=0;l<i.length;l+=1)I(i[l]);I(g.$$.fragment,n),$=!1},d(n){n&&b(r),B(e),ne(i,n),B(g)}}}function we(t,r,e){let a,s,o,m,p,d,g,$,h,i,P,n,l,f,_,u,w;A(t,C,c=>e(3,f=c)),A(t,ce,c=>e(17,_=c)),A(t,de,c=>e(18,u=c)),A(t,Z,c=>e(19,w=c));var z;const x=()=>{G(C,f=[],f)},ee=async(c,v,E)=>{f.length||(x(),G(C,f=await pe({namespace:c,workflowId:v,runId:E}),f))},te=()=>{const c=parseInt(p[0]),v=[],E=c-10;for(let y=0;y<10;y++)E+y>0&&v.push((E+y).toString());e(0,p=[...v,...p])},re=()=>{const c=parseInt(p[p.length-1]),v=[],E=c+1;for(let y=0;y<10;y++)E+y<=f.length&&v.push((E+y).toString());e(0,p=[...p,...v])},oe=(c,v)=>me(c)&&v.eventIds.has(c.id);return t.$$.update=()=>{t.$$.dirty&524288&&e(2,{id:a,namespace:s,workflow:o,run:m}=w.params,a,(e(16,s),e(19,w)),(e(15,o),e(19,w)),(e(14,m),e(19,w))),t.$$.dirty&4&&e(0,p=[a]),t.$$.dirty&114688&&ee(s,o,m),t.$$.dirty&262144&&e(13,{workflow:d}=u,d),t.$$.dirty&8192&&e(12,g=d==null?void 0:d.pendingActivities),t.$$.dirty&8192&&e(11,$=d==null?void 0:d.pendingNexusOperations),t.$$.dirty&6152&&e(10,h=ue(f,"ascending",g,$)),t.$$.dirty&132096&&e(6,i=_==="ascending"?h:[...h].reverse()),t.$$.dirty&9&&e(1,P=f.filter(c=>p.includes(c.id))),t.$$.dirty&2&&e(5,n=!P.length),t.$$.dirty&520&&e(4,l=e(9,z=f[f.length-1])===null||z===void 0?void 0:z.id)},[p,P,a,f,l,n,i,te,re,z,h,$,g,d,m,o,s,_,u,w,oe]}class ve extends U{constructor(r){super(),X(this,r,we,_e,K,{})}}function ye(t){let r,e,a,s;return r=new le({props:{title:`${ie("workflows.workflow-history")} | ${t[1]} | Event ${t[2]}`,url:t[0].url.href}}),a=new ve({}),{c(){H(r.$$.fragment),e=R(),H(a.$$.fragment)},l(o){T(r.$$.fragment,o),e=L(o),T(a.$$.fragment,o)},m(o,m){N(r,o,m),j(o,e,m),N(a,o,m),s=!0},p(o,[m]){const p={};m&1&&(p.url=o[0].url.href),r.$set(p)},i(o){s||(k(r.$$.fragment,o),k(a.$$.fragment,o),s=!0)},o(o){I(r.$$.fragment,o),I(a.$$.fragment,o),s=!1},d(o){o&&b(e),B(r,o),B(a,o)}}}function $e(t,r,e){let a;A(t,Z,m=>e(0,a=m));const s=a.params.workflow,o=a.params.id;return[a,s,o]}class Fe extends U{constructor(r){super(),X(this,r,$e,ye,K,{})}}export{Fe as component};
