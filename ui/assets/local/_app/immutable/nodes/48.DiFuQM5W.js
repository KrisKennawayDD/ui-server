import{r as Me}from"../chunks/index.DYMvb8Iz.js";import{e as he,b as Ke,g as Te}from"../chunks/route-for.jLvizIlZ.js";import{s as ve,d as _,i as h,h as R,j as K,k as B,l as G,e as D,q as Ge,n as J,f as V,c as de,v as oe,U as Xe,m as X,t as Y,O as te,a3 as re,w as Ie,P as Ye,o as ye}from"../chunks/scheduler.gES7FyoG.js";import{S as Ce,i as Oe,d as S,t as k,a as w,m as P,c as Q,b as E,h as ne,g as $e,e as ge}from"../chunks/index.DpnGbpCk.js";import{p as qe}from"../chunks/stores.NKpufGBN.js";import{P as Ze}from"../chunks/page-title.ClCB4mI7.js";import{w as xe}from"../chunks/entry.Dj-pX-S-.js";import{c as et,e as tt,g as rt,P as nt}from"../chunks/workflows.DfImfSPr.js";import{A as st}from"../chunks/add-search-attributes.RApwPmin.js";import{A as Fe}from"../chunks/alert.B7mQa_SE.js";import{B as be}from"../chunks/button.CA8dgZi9.js";import{C as Ne}from"../chunks/card.B8kKqjal.js";import{I as ot}from"../chunks/icon.iMHg4y68.js";import{I as ke}from"../chunks/input.C4qUEoot.js";import{L as Ae}from"../chunks/label.B6iMAtLr.js";import{L as Re}from"../chunks/link.B4C3m8Pj.js";import{E as Se}from"../chunks/editor.CFHOcmDB.js";import{T as at}from"../chunks/tooltip.BwIPcgk-.js";import{t as z}from"../chunks/translate.DzDeFYDI.js";import{g as lt}from"../chunks/pollers-service.D1lCALqE.js";import{c as ut}from"../chunks/search-attributes.Cvjl-ds4.js";import{t as Pe}from"../chunks/toaster.DccIofeo.js";import{p as Qe}from"../chunks/format-time.35r7NIm2.js";import{u as Ee}from"../chunks/update-query-parameters.BXrjRzCY.js";import{w as ft}from"../chunks/workflow-create-disabled.Cc3SseCF.js";import{v as it}from"../chunks/v4.BOvFkHkt.js";const pt=async function({params:n,parent:t}){var l,a;const e=await t();if(((l=e==null?void 0:e.settings)==null?void 0:l.disableWriteActions)||((a=e==null?void 0:e.settings)==null?void 0:a.startWorkflowDisabled)){const{namespace:d}=n;Me(302,he({namespace:d}))}},Zt=Object.freeze(Object.defineProperty({__proto__:null,load:pt},Symbol.toStringTag,{value:"Module"}));function mt(n){let t=z("workflows.back-to-workflows")+"",e;return{c(){e=Y(t)},l(r){e=X(r,t)},m(r,l){h(r,e,l)},p:oe,d(r){r&&_(e)}}}function ct(n){let t;return{c(){t=Y("Random UUID")},l(e){t=X(e,"Random UUID")},m(e,r){h(e,t,r)},d(e){e&&_(t)}}}function We(n){let t,e;return t=new Fe({props:{intent:n[10]>0?"success":"warning",title:n[10]?"Task Queue is Active":"Task Queue is Inactive",$$slots:{default:[gt]},$$scope:{ctx:n}}}),{c(){E(t.$$.fragment)},l(r){Q(t.$$.fragment,r)},m(r,l){P(t,r,l),e=!0},p(r,l){const a={};l[0]&1024&&(a.intent=r[10]>0?"success":"warning"),l[0]&1024&&(a.title=r[10]?"Task Queue is Active":"Task Queue is Inactive"),l[0]&17410|l[1]&2048&&(a.$$scope={dirty:l,ctx:r}),t.$set(a)},i(r){e||(w(t.$$.fragment,r),e=!0)},o(r){k(t.$$.fragment,r),e=!1},d(r){S(t,r)}}}function $t(n){let t;return{c(){t=Y("View Task Queue")},l(e){t=X(e,"View Task Queue")},m(e,r){h(e,t,r)},d(e){e&&_(t)}}}function gt(n){let t,e,r,l,a=Qe("Worker",n[10])+"",d,m,u,i;return u=new Re({props:{href:Te({namespace:n[14],queue:n[1]}),newTab:!0,$$slots:{default:[$t]},$$scope:{ctx:n}}}),{c(){t=J("div"),e=J("p"),r=Y(n[10]),l=V(),d=Y(a),m=V(),E(u.$$.fragment),this.h()},l(o){t=B(o,"DIV",{class:!0});var $=G(t);e=B($,"P",{});var g=G(e);r=X(g,n[10]),l=D(g),d=X(g,a),g.forEach(_),m=D($),Q(u.$$.fragment,$),$.forEach(_),this.h()},h(){K(t,"class","flex w-full items-center justify-between")},m(o,$){h(o,t,$),R(t,e),R(e,r),R(e,l),R(e,d),R(t,m),P(u,t,null),i=!0},p(o,$){(!i||$[0]&1024)&&ye(r,o[10]),(!i||$[0]&1024)&&a!==(a=Qe("Worker",o[10])+"")&&ye(d,a);const g={};$[0]&16386&&(g.href=Te({namespace:o[14],queue:o[1]})),$[1]&2048&&(g.$$scope={dirty:$,ctx:o}),u.$set(g)},i(o){i||(w(u.$$.fragment,o),i=!0)},o(o){k(u.$$.fragment,o),i=!1},d(o){o&&_(t),S(u)}}}function je(n){let t,e,r,l,a;function d(o){n[28](o)}function m(o){n[29](o)}function u(o){n[30](o)}let i={};return n[3]!==void 0&&(i.input=n[3]),n[6]!==void 0&&(i.encoding=n[6]),n[7]!==void 0&&(i.messageType=n[7]),t=new nt({props:i}),te.push(()=>ne(t,"input",d)),te.push(()=>ne(t,"encoding",m)),te.push(()=>ne(t,"messageType",u)),{c(){E(t.$$.fragment)},l(o){Q(t.$$.fragment,o)},m(o,$){P(t,o,$),a=!0},p(o,$){const g={};!e&&$[0]&8&&(e=!0,g.input=o[3],re(()=>e=!1)),!r&&$[0]&64&&(r=!0,g.encoding=o[6],re(()=>r=!1)),!l&&$[0]&128&&(l=!0,g.messageType=o[7],re(()=>l=!1)),t.$set(g)},i(o){a||(w(t.$$.fragment,o),a=!0)},o(o){k(t.$$.fragment,o),a=!1},d(o){S(t,o)}}}function De(n){let t,e,r,l,a;t=new Ne({props:{class:"flex flex-col gap-2",$$slots:{default:[_t]},$$scope:{ctx:n}}});function d(u){n[33](u)}let m={};return n[12]!==void 0&&(m.attributesToAdd=n[12]),r=new st({props:m}),te.push(()=>ne(r,"attributesToAdd",d)),{c(){E(t.$$.fragment),e=V(),E(r.$$.fragment)},l(u){Q(t.$$.fragment,u),e=D(u),Q(r.$$.fragment,u)},m(u,i){P(t,u,i),h(u,e,i),P(r,u,i),a=!0},p(u,i){const o={};i[0]&48|i[1]&2048&&(o.$$scope={dirty:i,ctx:u}),t.$set(o);const $={};!l&&i[0]&4096&&(l=!0,$.attributesToAdd=u[12],re(()=>l=!1)),r.$set($)},i(u){a||(w(t.$$.fragment,u),w(r.$$.fragment,u),a=!0)},o(u){k(t.$$.fragment,u),k(r.$$.fragment,u),a=!1},d(u){u&&_(e),S(t,u),S(r,u)}}}function dt(n){let t,e;return t=new ot({props:{name:"info"}}),{c(){E(t.$$.fragment)},l(r){Q(t.$$.fragment,r)},m(r,l){P(t,r,l),e=!0},p:oe,i(r){e||(w(t.$$.fragment,r),e=!0)},o(r){k(t.$$.fragment,r),e=!1},d(r){S(t,r)}}}function _t(n){let t,e,r=z("workflows.user-metadata")+"",l,a,d,m=z("workflows.markdown-supported")+"",u,i,o,$,g,C,W,U,T,N,v,j;return o=new at({props:{topRight:!0,width:200,text:z("workflows.markdown-description"),$$slots:{default:[dt]},$$scope:{ctx:n}}}),g=new Ae({props:{label:z("workflows.summary"),for:"summary"}}),W=new Se({props:{content:n[4],class:"min-h-48"}}),W.$on("change",n[31]),T=new Ae({props:{label:z("workflows.details"),for:"details"}}),v=new Se({props:{content:n[5]}}),v.$on("change",n[32]),{c(){t=J("div"),e=J("h3"),l=Y(r),a=V(),d=J("p"),u=Y(m),i=V(),E(o.$$.fragment),$=V(),E(g.$$.fragment),C=V(),E(W.$$.fragment),U=V(),E(T.$$.fragment),N=V(),E(v.$$.fragment),this.h()},l(f){t=B(f,"DIV",{class:!0});var b=G(t);e=B(b,"H3",{});var L=G(e);l=X(L,r),L.forEach(_),a=D(b),d=B(b,"P",{class:!0});var O=G(d);u=X(O,m),i=D(O),Q(o.$$.fragment,O),O.forEach(_),b.forEach(_),$=D(f),Q(g.$$.fragment,f),C=D(f),Q(W.$$.fragment,f),U=D(f),Q(T.$$.fragment,f),N=D(f),Q(v.$$.fragment,f),this.h()},h(){K(d,"class","flex items-center gap-1 text-sm text-subtle"),K(t,"class","flex flex-wrap justify-between")},m(f,b){h(f,t,b),R(t,e),R(e,l),R(t,a),R(t,d),R(d,u),R(d,i),P(o,d,null),h(f,$,b),P(g,f,b),h(f,C,b),P(W,f,b),h(f,U,b),P(T,f,b),h(f,N,b),P(v,f,b),j=!0},p(f,b){const L={};b[1]&2048&&(L.$$scope={dirty:b,ctx:f}),o.$set(L);const O={};b[0]&16&&(O.content=f[4]),W.$set(O);const H={};b[0]&32&&(H.content=f[5]),v.$set(H)},i(f){j||(w(o.$$.fragment,f),w(g.$$.fragment,f),w(W.$$.fragment,f),w(T.$$.fragment,f),w(v.$$.fragment,f),j=!0)},o(f){k(o.$$.fragment,f),k(g.$$.fragment,f),k(W.$$.fragment,f),k(T.$$.fragment,f),k(v.$$.fragment,f),j=!1},d(f){f&&(_(t),_($),_(C),_(U),_(N)),S(o),S(g,f),S(W,f),S(T,f),S(v,f)}}}function wt(n){let t=z("common.more-options")+"",e;return{c(){e=Y(t)},l(r){e=X(r,t)},m(r,l){h(r,e,l)},p:oe,d(r){r&&_(e)}}}function bt(n){let t=z("workflows.start-workflow")+"",e;return{c(){e=Y(t)},l(r){e=X(r,t)},m(r,l){h(r,e,l)},p:oe,d(r){r&&_(e)}}}function Ve(n){let t,e;return t=new Fe({props:{intent:"error",title:n[9]}}),{c(){E(t.$$.fragment)},l(r){Q(t.$$.fragment,r)},m(r,l){P(t,r,l),e=!0},p(r,l){const a={};l[0]&512&&(a.title=r[9]),t.$set(a)},i(r){e||(w(t.$$.fragment,r),e=!0)},o(r){k(t.$$.fragment,r),e=!1},d(r){S(t,r)}}}function kt(n){let t,e,r,l,a,d,m,u,i,o,$,g,C,W,U=n[8],T,N,v,j,f,b,L,O,H;function fe(s){n[22](s)}let x={id:"workflowId",required:!0,label:"Workflow ID",class:"w-full grow"};n[0]!==void 0&&(x.value=n[0]),e=new ke({props:x}),te.push(()=>ne(e,"value",fe)),e.$on("blur",n[23]),a=new be({props:{class:"mt-0 md:mt-6",variant:"secondary",leadingIcon:"retry",$$slots:{default:[ct]},$$scope:{ctx:n}}}),a.$on("click",n[17]);function Z(s){n[24](s)}let ie={id:"taskQueue",required:!0,label:"Task Queue",class:"grow"};n[1]!==void 0&&(ie.value=n[1]),u=new ke({props:ie}),te.push(()=>ne(u,"value",Z)),u.$on("blur",n[25]);let I=n[10]!==void 0&&We(n);function _e(s){n[26](s)}let pe={id:"workflowType",required:!0,label:"Workflow Type"};n[2]!==void 0&&(pe.value=n[2]),g=new ke({props:pe}),te.push(()=>ne(g,"value",_e)),g.$on("blur",n[27]);let F=je(n),y=n[11]&&De(n);j=new be({props:{variant:"ghost",class:"max-sm:w-full",trailingIcon:n[11]?"chevron-up":"chevron-down",$$slots:{default:[wt]},$$scope:{ctx:n}}}),j.$on("click",n[34]),b=new be({props:{disabled:!n[13],"data-testid":"start-workflow-button",class:"max-sm:w-full",$$slots:{default:[bt]},$$scope:{ctx:n}}}),b.$on("click",n[16]);let A=n[9]&&Ve(n);return{c(){t=J("div"),E(e.$$.fragment),l=V(),E(a.$$.fragment),d=V(),m=J("div"),E(u.$$.fragment),o=V(),I&&I.c(),$=V(),E(g.$$.fragment),W=V(),F.c(),T=V(),y&&y.c(),N=V(),v=J("div"),E(j.$$.fragment),f=V(),E(b.$$.fragment),L=V(),A&&A.c(),O=Ie(),this.h()},l(s){t=B(s,"DIV",{class:!0});var c=G(t);Q(e.$$.fragment,c),l=D(c),Q(a.$$.fragment,c),c.forEach(_),d=D(s),m=B(s,"DIV",{class:!0});var ee=G(m);Q(u.$$.fragment,ee),ee.forEach(_),o=D(s),I&&I.l(s),$=D(s),Q(g.$$.fragment,s),W=D(s),F.l(s),T=D(s),y&&y.l(s),N=D(s),v=B(s,"DIV",{class:!0});var M=G(v);Q(j.$$.fragment,M),f=D(M),Q(b.$$.fragment,M),M.forEach(_),L=D(s),A&&A.l(s),O=Ie(),this.h()},h(){K(t,"class","flex w-full flex-col justify-between gap-2 sm:items-center md:flex-row md:gap-4"),K(m,"class","flex w-full items-center justify-between gap-4"),K(v,"class","mt-4 flex w-full flex-row justify-between gap-4 max-sm:flex-col")},m(s,c){h(s,t,c),P(e,t,null),R(t,l),P(a,t,null),h(s,d,c),h(s,m,c),P(u,m,null),h(s,o,c),I&&I.m(s,c),h(s,$,c),P(g,s,c),h(s,W,c),F.m(s,c),h(s,T,c),y&&y.m(s,c),h(s,N,c),h(s,v,c),P(j,v,null),R(v,f),P(b,v,null),h(s,L,c),A&&A.m(s,c),h(s,O,c),H=!0},p(s,c){const ee={};!r&&c[0]&1&&(r=!0,ee.value=s[0],re(()=>r=!1)),e.$set(ee);const M={};c[1]&2048&&(M.$$scope={dirty:c,ctx:s}),a.$set(M);const me={};!i&&c[0]&2&&(i=!0,me.value=s[1],re(()=>i=!1)),u.$set(me),s[10]!==void 0?I?(I.p(s,c),c[0]&1024&&w(I,1)):(I=We(s),I.c(),w(I,1),I.m($.parentNode,$)):I&&($e(),k(I,1,1,()=>{I=null}),ge());const ce={};!C&&c[0]&4&&(C=!0,ce.value=s[2],re(()=>C=!1)),g.$set(ce),c[0]&256&&ve(U,U=s[8])?($e(),k(F,1,1,oe),ge(),F=je(s),F.c(),w(F,1),F.m(T.parentNode,T)):F.p(s,c),s[11]?y?(y.p(s,c),c[0]&2048&&w(y,1)):(y=De(s),y.c(),w(y,1),y.m(N.parentNode,N)):y&&($e(),k(y,1,1,()=>{y=null}),ge());const ae={};c[0]&2048&&(ae.trailingIcon=s[11]?"chevron-up":"chevron-down"),c[1]&2048&&(ae.$$scope={dirty:c,ctx:s}),j.$set(ae);const le={};c[0]&8192&&(le.disabled=!s[13]),c[1]&2048&&(le.$$scope={dirty:c,ctx:s}),b.$set(le),s[9]?A?(A.p(s,c),c[0]&512&&w(A,1)):(A=Ve(s),A.c(),w(A,1),A.m(O.parentNode,O)):A&&($e(),k(A,1,1,()=>{A=null}),ge())},i(s){H||(w(e.$$.fragment,s),w(a.$$.fragment,s),w(u.$$.fragment,s),w(I),w(g.$$.fragment,s),w(F),w(y),w(j.$$.fragment,s),w(b.$$.fragment,s),w(A),H=!0)},o(s){k(e.$$.fragment,s),k(a.$$.fragment,s),k(u.$$.fragment,s),k(I),k(g.$$.fragment,s),k(F),k(y),k(j.$$.fragment,s),k(b.$$.fragment,s),k(A),H=!1},d(s){s&&(_(t),_(d),_(m),_(o),_($),_(W),_(T),_(N),_(v),_(L),_(O)),S(e),S(a),S(u),I&&I.d(s),S(g,s),F.d(s),y&&y.d(s),S(j),S(b),A&&A.d(s)}}}function ht(n){let t,e,r,l,a="Start a Workflow",d,m,u;return e=new Re({props:{href:`${he({namespace:n[14]})}?${n[15]}`,"data-testid":"back-to-workflows",icon:"chevron-left",$$slots:{default:[mt]},$$scope:{ctx:n}}}),m=new Ne({props:{class:"flex w-full flex-col gap-4 xl:w-3/4 2xl:w-1/2",$$slots:{default:[kt]},$$scope:{ctx:n}}}),{c(){t=J("div"),E(e.$$.fragment),r=V(),l=J("h1"),l.textContent=a,d=V(),E(m.$$.fragment),this.h()},l(i){t=B(i,"DIV",{class:!0});var o=G(t);Q(e.$$.fragment,o),r=D(o),l=B(o,"H1",{class:!0,"data-testid":!0,"data-svelte-h":!0}),Ge(l)!=="svelte-wf0qpn"&&(l.textContent=a),d=D(o),Q(m.$$.fragment,o),o.forEach(_),this.h()},h(){K(l,"class","mb-4 overflow-hidden"),K(l,"data-testid","start-workflow"),K(t,"class","flex w-full flex-col gap-4 pb-20")},m(i,o){h(i,t,o),P(e,t,null),R(t,r),R(t,l),R(t,d),P(m,t,null),u=!0},p(i,o){const $={};o[0]&49152&&($.href=`${he({namespace:i[14]})}?${i[15]}`),o[1]&2048&&($.$$scope={dirty:o,ctx:i}),e.$set($);const g={};o[0]&32767|o[1]&2048&&(g.$$scope={dirty:o,ctx:i}),m.$set(g)},i(i){u||(w(e.$$.fragment,i),w(m.$$.fragment,i),u=!0)},o(i){k(e.$$.fragment,i),k(m.$$.fragment,i),u=!1},d(i){i&&_(t),S(e),S(m)}}}function vt(n,t,e){let r,l,a,d,m,u,i,o=oe,$=()=>(o(),o=Ye(j,p=>e(38,i=p)),j),g;de(n,qe,p=>e(21,m=p)),de(n,ut,p=>e(37,u=p)),de(n,et,p=>e(15,g=p)),n.$$.on_destroy.push(()=>o());let C="",W="",U="",T="",N="",v="",j=xe("json/plain");$();let f="",b=0,L="",O="",H="",fe,x=!1,Z=[];Xe(()=>{e(0,C=m.url.searchParams.get("workflowId")||""),e(1,W=m.url.searchParams.get("taskQueue")||""),e(2,U=m.url.searchParams.get("workflowType")||""),L=m.url.searchParams.get("workflowId")||"",O=m.url.searchParams.get("workflowType")||"",(L||O)&&pe(L,O)});const ie=async()=>{try{e(9,H="");const{runId:p}=await rt({namespace:r,workflowId:C,taskQueue:W,workflowType:U,input:T,summary:N,details:v,encoding:i,messageType:f,searchAttributes:Z});Pe.push({variant:"success",duration:5e3,message:z("workflows.start-workflow-success"),link:Ke({namespace:r,workflow:C,run:p})})}catch(p){e(9,H=(p==null?void 0:p.message)||z("workflows.start-workflow-error")),Pe.push({variant:"error",message:z("workflows.start-workflow-error")})}},I=()=>{e(0,C=it()),Ee({parameter:"workflowId",value:C,url:m.url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},_e=async p=>{if(p){const{pollers:se}=await lt({namespace:r,queue:p});e(10,fe=se.length)}},pe=async(p,se)=>{var ue;const q=await tt({namespace:r,workflowId:p,workflowType:se});if(e(3,T=q.input),j.set(q.encoding),e(7,f=q.messageType),e(8,b=Date.now()),e(4,N=q.summary),e(5,v=q.details),q!=null&&q.searchAttributes){const Be=Object.keys(u);Object.entries(q.searchAttributes).forEach(([we,Je])=>{Be.includes(we)&&e(12,Z=[...Z,{label:we,value:Je,type:u[we]}])})}(Object.keys((ue=q==null?void 0:q.searchAttributes)!==null&&ue!==void 0?ue:{}).length||q!=null&&q.summary||q!=null&&q.details)&&e(11,x=!0)},F=(p,se)=>{const ue=p.target.value;Ee({parameter:se,value:ue,url:m.url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},y=p=>{try{return JSON.parse(p),!0}catch{return!1}};function A(p){C=p,e(0,C)}const s=p=>F(p,"workflowId");function c(p){W=p,e(1,W)}const ee=p=>F(p,"taskQueue");function M(p){U=p,e(2,U)}const me=p=>F(p,"workflowType");function ce(p){T=p,e(3,T)}function ae(p){j=p,$(e(6,j))}function le(p){f=p,e(7,f)}const Ue=p=>e(4,N=p.detail.value),Le=p=>e(5,v=p.detail.value);function He(p){Z=p,e(12,Z)}const ze=()=>e(11,x=!x);return n.$$.update=()=>{n.$$.dirty[0]&2097152&&e(14,{namespace:r}=m.params,r),n.$$.dirty[0]&2097152&&e(19,l=m.url.searchParams.get("taskQueue")),n.$$.dirty[0]&8&&e(20,a=!T||y(T)),n.$$.dirty[0]&3145735&&e(13,d=!!C&&!!W&&!!U&&!!a&&!ft(m)),n.$$.dirty[0]&524288&&_e(l)},[C,W,U,T,N,v,j,f,b,H,fe,x,Z,d,r,g,ie,I,F,l,a,m,A,s,c,ee,M,me,ce,ae,le,Ue,Le,He,ze]}class Tt extends Ce{constructor(t){super(),Oe(this,t,vt,ht,ve,{},null,[-1,-1])}}function It(n){let t,e,r,l;return t=new Ze({props:{title:"Start Workflow",url:n[0].url.href}}),r=new Tt({}),{c(){E(t.$$.fragment),e=V(),E(r.$$.fragment)},l(a){Q(t.$$.fragment,a),e=D(a),Q(r.$$.fragment,a)},m(a,d){P(t,a,d),h(a,e,d),P(r,a,d),l=!0},p(a,[d]){const m={};d&1&&(m.url=a[0].url.href),t.$set(m)},i(a){l||(w(t.$$.fragment,a),w(r.$$.fragment,a),l=!0)},o(a){k(t.$$.fragment,a),k(r.$$.fragment,a),l=!1},d(a){a&&_(e),S(t,a),S(r,a)}}}function yt(n,t,e){let r;return de(n,qe,l=>e(0,r=l)),[r]}class xt extends Ce{constructor(t){super(),Oe(this,t,yt,It,ve,{})}}export{xt as component,Zt as universal};
