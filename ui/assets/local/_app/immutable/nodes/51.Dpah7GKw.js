import{s as re,a2 as oe,O as ie,d as g,o as le,a3 as fe,i as x,h as u,j as A,k as V,l as O,e as H,m as I,n as j,f as R,t as C,c as ae,v as X}from"../chunks/scheduler.gES7FyoG.js";import{S as me,i as ue,h as ce,d as z,t as Z,a as B,m as G,c as q,b as J}from"../chunks/index.DpnGbpCk.js";import{g as se}from"../chunks/entry.DvysN0vy.js";import{p as de}from"../chunks/stores.DNIlqTA7.js";import{P as pe}from"../chunks/page-title.ClCB4mI7.js";import{t as E}from"../chunks/translate.DzDeFYDI.js";import{B as ne}from"../chunks/button.8dBRSgFy.js";import{I as ge}from"../chunks/input.BJGbSm4T.js";import{L as _e}from"../chunks/link.BJBjrbgF.js";import{M as he}from"../chunks/modal.BW9WLPHO.js";import{N as ve,e as be}from"../chunks/nexus-form.DHMoFBTL.js";import{j as te,h as Ne}from"../chunks/route-for.D8R1TGjB.js";import{u as $e,d as we}from"../chunks/nexus-service.CK_RZdBy.js";import{n as Ee}from"../chunks/namespaces.DgRsVgYf.js";import{e as Le}from"../chunks/encode-payload.CLe3YVTy.js";function De(e){let n=E("nexus.back-to-endpoint")+"",t;return{c(){t=C(n)},l(a){t=I(a,n)},m(a,i){x(a,t,i)},p:X,d(a){a&&g(t)}}}function ke(e){let n=E("common.save")+"",t;return{c(){t=C(n)},l(a){t=I(a,n)},m(a,i){x(a,t,i)},p:X,d(a){a&&g(t)}}}function Pe(e){let n=E("common.cancel")+"",t;return{c(){t=C(n)},l(a){t=I(a,n)},m(a,i){x(a,t,i)},p:X,d(a){a&&g(t)}}}function Te(e){let n=E("common.delete")+"",t;return{c(){t=C(n)},l(a){t=I(a,n)},m(a,i){x(a,t,i)},p:X,d(a){a&&g(t)}}}function Ie(e){let n=E("common.cancel")+"",t;return{c(){t=C(n)},l(a){t=I(a,n)},m(a,i){x(a,t,i)},p:X,d(a){a&&g(t)}}}function Ce(e){let n,t=E("nexus.delete-modal-title")+"",a;return{c(){n=j("h3"),a=C(t),this.h()},l(i){n=V(i,"H3",{slot:!0});var s=O(n);a=I(s,t),s.forEach(g),this.h()},h(){A(n,"slot","title")},m(i,s){x(i,n,s),u(n,a)},p:X,d(i){i&&g(n)}}}function He(e){let n,t,a=E("nexus.delete-modal-confirmation-preface")+"",i,s,m,_=e[0].spec.name+"",d,$,h=E("nexus.delete-modal-confirmation-postface")+"",S,b,l,v=E("nexus.type-confirm-preface")+"",P,L,M,N=e[0].spec.name+"",F,D,K=E("nexus.type-confirm-postface")+"",o,W,k,Y,Q;function f(p){e[16](p)}let r={id:"delete-endpoint",labelHidden:!0,label:E("nexus.delete-endpoint")};return e[11]!==void 0&&(r.value=e[11]),k=new ge({props:r}),ie.push(()=>ce(k,"value",f)),{c(){n=j("div"),t=j("p"),i=C(a),s=R(),m=j("strong"),d=C(_),$=C(`?
      `),S=C(h),b=R(),l=j("p"),P=C(v),L=R(),M=j("strong"),F=C(N),D=R(),o=C(K),W=R(),J(k.$$.fragment),this.h()},l(p){n=V(p,"DIV",{slot:!0,class:!0});var c=O(n);t=V(c,"P",{});var w=O(t);i=I(w,a),s=H(w),m=V(w,"STRONG",{class:!0});var U=O(m);d=I(U,_),U.forEach(g),$=I(w,`?
      `),S=I(w,h),w.forEach(g),b=H(c),l=V(c,"P",{});var T=O(l);P=I(T,v),L=H(T),M=V(T,"STRONG",{class:!0});var y=O(M);F=I(y,N),y.forEach(g),D=H(T),o=I(T,K),T.forEach(g),W=H(c),q(k.$$.fragment,c),c.forEach(g),this.h()},h(){A(m,"class","select-all"),A(M,"class","select-all"),A(n,"slot","content"),A(n,"class","flex flex-col gap-4")},m(p,c){x(p,n,c),u(n,t),u(t,i),u(t,s),u(t,m),u(m,d),u(t,$),u(t,S),u(n,b),u(n,l),u(l,P),u(l,L),u(l,M),u(M,F),u(l,D),u(l,o),u(n,W),G(k,n,null),Q=!0},p(p,c){(!Q||c&1)&&_!==(_=p[0].spec.name+"")&&le(d,_),(!Q||c&1)&&N!==(N=p[0].spec.name+"")&&le(F,N);const w={};!Y&&c&2048&&(Y=!0,w.value=p[11],fe(()=>Y=!1)),k.$set(w)},i(p){Q||(B(k.$$.fragment,p),Q=!0)},o(p){Z(k.$$.fragment,p),Q=!1},d(p){p&&g(n),z(k)}}}function Re(e){let n,t,a,i,s,m,_=e[0].spec.name+"",d,$,h,S,b,l,v,P,L,M,N,F,D,K,o,W,k;a=new _e({props:{href:te(e[12].params.id),icon:"chevron-left",$$slots:{default:[De]},$$scope:{ctx:e}}}),h=new ve({props:{endpoint:e[0],nameHintText:e[9],nameRegexPattern:e[8],targetNamespaceList:e[1],callerNamespaceList:e[2],error:e[5],isCloud:e[7],nameDisabled:!0}}),v=new ne({props:{class:"max-sm:w-full",loading:e[6],$$slots:{default:[ke]},$$scope:{ctx:e}}}),v.$on("click",function(){oe(e[3])&&e[3].apply(this,arguments)}),L=new ne({props:{class:"max-sm:hidden",variant:"ghost",$$slots:{default:[Pe]},$$scope:{ctx:e}}}),L.$on("click",e[13]),N=new ne({props:{class:"max-sm:w-full",variant:"destructive",$$slots:{default:[Te]},$$scope:{ctx:e}}}),N.$on("click",e[14]),D=new ne({props:{class:"w-full sm:hidden",variant:"ghost",$$slots:{default:[Ie]},$$scope:{ctx:e}}}),D.$on("click",e[15]);function Y(f){e[17](f)}let Q={id:"delete-endpoint-modal",loading:e[6],confirmType:"destructive",confirmText:E("common.delete"),cancelText:E("common.cancel"),confirmDisabled:e[11]!==e[0].spec.name,$$slots:{content:[He],title:[Ce]},$$scope:{ctx:e}};return e[10]!==void 0&&(Q.open=e[10]),o=new he({props:Q}),ie.push(()=>ce(o,"open",Y)),o.$on("confirmModal",function(){oe(e[4])&&e[4].apply(this,arguments)}),o.$on("cancelModal",e[18]),{c(){n=j("div"),t=j("div"),J(a.$$.fragment),i=R(),s=j("div"),m=j("h1"),d=C(_),$=R(),J(h.$$.fragment),S=R(),b=j("div"),l=j("div"),J(v.$$.fragment),P=R(),J(L.$$.fragment),M=R(),J(N.$$.fragment),F=R(),J(D.$$.fragment),K=R(),J(o.$$.fragment),this.h()},l(f){n=V(f,"DIV",{class:!0});var r=O(n);t=V(r,"DIV",{class:!0});var p=O(t);q(a.$$.fragment,p),p.forEach(g),i=H(r),s=V(r,"DIV",{class:!0});var c=O(s);m=V(c,"H1",{"data-testid":!0});var w=O(m);d=I(w,_),w.forEach(g),c.forEach(g),$=H(r),q(h.$$.fragment,r),S=H(r),b=V(r,"DIV",{class:!0});var U=O(b);l=V(U,"DIV",{class:!0});var T=O(l);q(v.$$.fragment,T),P=H(T),q(L.$$.fragment,T),T.forEach(g),M=H(U),q(N.$$.fragment,U),F=H(U),q(D.$$.fragment,U),U.forEach(g),r.forEach(g),K=H(f),q(o.$$.fragment,f),this.h()},h(){A(t,"class","relative flex flex-col gap-4 text-sm"),A(m,"data-testid","namespace-selector-title"),A(s,"class","flex flex-col gap-1"),A(l,"class","items-centeritems-center flex w-full flex-row gap-4 max-sm:flex-col"),A(b,"class","flex w-full flex-row items-center justify-between gap-4 max-sm:flex-col xl:w-1/2"),A(n,"class","flex flex-col gap-8")},m(f,r){x(f,n,r),u(n,t),G(a,t,null),u(n,i),u(n,s),u(s,m),u(m,d),u(n,$),G(h,n,null),u(n,S),u(n,b),u(b,l),G(v,l,null),u(l,P),G(L,l,null),u(b,M),G(N,b,null),u(b,F),G(D,b,null),x(f,K,r),G(o,f,r),k=!0},p(f,[r]){e=f;const p={};r&4096&&(p.href=te(e[12].params.id)),r&524288&&(p.$$scope={dirty:r,ctx:e}),a.$set(p),(!k||r&1)&&_!==(_=e[0].spec.name+"")&&le(d,_);const c={};r&1&&(c.endpoint=e[0]),r&512&&(c.nameHintText=e[9]),r&256&&(c.nameRegexPattern=e[8]),r&2&&(c.targetNamespaceList=e[1]),r&4&&(c.callerNamespaceList=e[2]),r&32&&(c.error=e[5]),r&128&&(c.isCloud=e[7]),h.$set(c);const w={};r&64&&(w.loading=e[6]),r&524288&&(w.$$scope={dirty:r,ctx:e}),v.$set(w);const U={};r&524288&&(U.$$scope={dirty:r,ctx:e}),L.$set(U);const T={};r&524288&&(T.$$scope={dirty:r,ctx:e}),N.$set(T);const y={};r&524288&&(y.$$scope={dirty:r,ctx:e}),D.$set(y);const ee={};r&64&&(ee.loading=e[6]),r&2049&&(ee.confirmDisabled=e[11]!==e[0].spec.name),r&526337&&(ee.$$scope={dirty:r,ctx:e}),!W&&r&1024&&(W=!0,ee.open=e[10],fe(()=>W=!1)),o.$set(ee)},i(f){k||(B(a.$$.fragment,f),B(h.$$.fragment,f),B(v.$$.fragment,f),B(L.$$.fragment,f),B(N.$$.fragment,f),B(D.$$.fragment,f),B(o.$$.fragment,f),k=!0)},o(f){Z(a.$$.fragment,f),Z(h.$$.fragment,f),Z(v.$$.fragment,f),Z(L.$$.fragment,f),Z(N.$$.fragment,f),Z(D.$$.fragment,f),Z(o.$$.fragment,f),k=!1},d(f){f&&(g(n),g(K)),z(a),z(h),z(v),z(L),z(N),z(D),z(o,f)}}}function Se(e,n,t){let a;ae(e,de,o=>t(12,a=o));let{endpoint:i}=n,{targetNamespaceList:s=[]}=n,{callerNamespaceList:m=[]}=n,{onUpdate:_}=n,{onDelete:d}=n,{error:$=void 0}=n,{loading:h=!1}=n,{isCloud:S=!1}=n,{nameRegexPattern:b=/^[a-zA-Z][a-zA-Z0-9-]*[a-zA-Z0-9]$/}=n,{nameHintText:l=E("nexus.endpoint-name-hint-with-dash")}=n,v=!1,P="";const L=()=>se(te(a.params.id)),M=()=>t(10,v=!0),N=()=>se(te(a.params.id));function F(o){P=o,t(11,P)}function D(o){v=o,t(10,v)}const K=()=>t(10,v=!1);return e.$$set=o=>{"endpoint"in o&&t(0,i=o.endpoint),"targetNamespaceList"in o&&t(1,s=o.targetNamespaceList),"callerNamespaceList"in o&&t(2,m=o.callerNamespaceList),"onUpdate"in o&&t(3,_=o.onUpdate),"onDelete"in o&&t(4,d=o.onDelete),"error"in o&&t(5,$=o.error),"loading"in o&&t(6,h=o.loading),"isCloud"in o&&t(7,S=o.isCloud),"nameRegexPattern"in o&&t(8,b=o.nameRegexPattern),"nameHintText"in o&&t(9,l=o.nameHintText)},[i,s,m,_,d,$,h,S,b,l,v,P,a,L,M,N,F,D,K]}class Me extends me{constructor(n){super(),ue(this,n,Se,Re,re,{endpoint:0,targetNamespaceList:1,callerNamespaceList:2,onUpdate:3,onDelete:4,error:5,loading:6,isCloud:7,nameRegexPattern:8,nameHintText:9})}}function Ue(e){let n,t,a,i;return n=new pe({props:{title:`Edit ${E("nexus.nexus-endpoint",{id:e[4].params.id})}`,url:e[4].url.href}}),a=new Me({props:{endpoint:e[3],loading:e[1],targetNamespaceList:e[2],onUpdate:e[5],onDelete:e[6],error:e[0]}}),{c(){J(n.$$.fragment),t=R(),J(a.$$.fragment)},l(s){q(n.$$.fragment,s),t=H(s),q(a.$$.fragment,s)},m(s,m){G(n,s,m),x(s,t,m),G(a,s,m),i=!0},p(s,[m]){const _={};m&16&&(_.title=`Edit ${E("nexus.nexus-endpoint",{id:s[4].params.id})}`),m&16&&(_.url=s[4].url.href),n.$set(_);const d={};m&8&&(d.endpoint=s[3]),m&2&&(d.loading=s[1]),m&4&&(d.targetNamespaceList=s[2]),m&1&&(d.error=s[0]),a.$set(d)},i(s){i||(B(n.$$.fragment,s),B(a.$$.fragment,s),i=!0)},o(s){Z(n.$$.fragment,s),Z(a.$$.fragment,s),i=!1},d(s){s&&g(t),z(n,s),z(a,s)}}}function Ve(e,n,t){let a,i,s,m,_;ae(e,Ee,l=>t(8,s=l)),ae(e,be,l=>t(9,m=l)),ae(e,de,l=>t(4,_=l));let{data:d}=n,$,h=!1;const S=async()=>{t(0,$=void 0),t(1,h=!0);const l={...m};l.id=a.id,l.version=a.version;const v=await Le({input:JSON.stringify(l.spec.descriptionString),encoding:"json/plain"});l.spec.description=v[0],delete l.spec.allowedCallerNamespaces,delete l.spec.descriptionString;try{await $e(a.id,l),se(te(a.id),{invalidateAll:!0})}catch(P){t(0,$=P),console.error("Error updating endpoint",P)}finally{t(1,h=!1)}},b=async()=>{t(0,$=void 0),t(1,h=!0);try{await we(a.id,a.version),se(Ne())}catch(l){t(0,$=l),console.error("Error deleting endpoint",l)}finally{t(1,h=!1)}};return e.$$set=l=>{"data"in l&&t(7,d=l.data)},e.$$.update=()=>{e.$$.dirty&128&&t(3,{endpoint:a}=d,a),e.$$.dirty&256&&t(2,i=s.map(l=>({namespace:l.namespaceInfo.name})))},[$,h,i,a,_,S,b,d,s]}class Ye extends me{constructor(n){super(),ue(this,n,Ve,Ue,re,{data:7})}}export{Ye as component};
