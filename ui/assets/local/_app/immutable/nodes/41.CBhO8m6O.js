import{s as ae,h as T,j,k as C,f as p,i as w,c as L,b as O,d as R,m as B,n as W,t as J,l as K,v as P,O as Z,Q as x,x as ee,y as we,q as fe}from"../chunks/scheduler.9nPpm2FE.js";import{S as ue,i as ie,g as ce,b as _,e as me,t as d,c as k,a as b,m as y,d as v,h as te}from"../chunks/index.DU2w1i_i.js";import{p as pe}from"../chunks/stores.DecLyLlX.js";import{P as ke}from"../chunks/page-title.BVcIpxci.js";import{t as h}from"../chunks/translate.BBe5dcco.js";import{W as be}from"../chunks/workflow-padded-layout.BE4USKwK.js";import{h as ne,u as ye}from"../chunks/await_block.C06z0U3r.js";import{e as re}from"../chunks/each.YVmQpE2s.js";import{P as ve}from"../chunks/payload-input.CKoKfnh8.js";import{B as qe}from"../chunks/button.BXOQo1Ef.js";import{C as Ie}from"../chunks/card.L31Vb8Ak.js";import{C as Ee}from"../chunks/code-block.D9JcvN74.js";import{E as de}from"../chunks/empty-state.nqX-v1X5.js";import{L as Pe}from"../chunks/loading.DGykYoBQ.js";import{S as Te,O as je}from"../chunks/option.CnzPzPjm.js";import{T as Ce}from"../chunks/toggle-switch.DBclTWX7.js";import{a as De}from"../chunks/query-service.EflxbSgQ.js";import{a as Se}from"../chunks/auth-user.CQOTPxnA.js";import{w as Ve}from"../chunks/workflow-run.7tvanB5-.js";import{e as Be}from"../chunks/encode-payload.C423bTK5.js";import{s as Oe}from"../chunks/parse-with-big-int.BnqXezm8.js";function oe(s){s[30]=s[32][0],s[31]=s[32][1];const e=typeof s[30]!="string"?Oe(s[30]):s[30];s[33]=e}function le(s,e,t){const n=s.slice();return n[32]=e[t].name,n[35]=e[t].description!==void 0?e[t].description:"",n}function Re(s){let e,t,n,r,a,o;t=new Ie({props:{class:"mt-7 flex h-fit w-full flex-col gap-2",$$slots:{default:[Ae]},$$scope:{ctx:s}}});let f={ctx:s,current:null,token:null,hasCatch:!0,pending:Ge,then:ze,catch:Fe,value:32,error:34,blocks:[,,,]};return ne(a=Promise.all([s[6],s[7]]),f),{c(){e=T("div"),k(t.$$.fragment),n=O(),r=T("div"),f.block.c(),this.h()},l(l){e=j(l,"DIV",{class:!0});var u=C(e);b(t.$$.fragment,u),n=R(u),r=j(u,"DIV",{class:!0});var c=C(r);f.block.l(c),c.forEach(p),u.forEach(p),this.h()},h(){B(r,"class","flex w-full flex-col gap-2"),B(e,"class","flex w-3/4 gap-4 max-2xl:w-full max-lg:flex-col")},m(l,u){w(l,e,u),y(t,e,null),W(e,n),W(e,r),f.block.m(r,f.anchor=null),f.mount=()=>r,f.anchor=null,o=!0},p(l,u){s=l;const c={};u[0]&535|u[1]&128&&(c.$$scope={dirty:u,ctx:s}),t.$set(c),f.ctx=s,u[0]&192&&a!==(a=Promise.all([s[6],s[7]]))&&ne(a,f)||ye(f,s,u)},i(l){o||(d(t.$$.fragment,l),d(f.block),o=!0)},o(l){_(t.$$.fragment,l);for(let u=0;u<3;u+=1){const c=f.blocks[u];_(c)}o=!1},d(l){l&&p(e),v(t),f.block.d(),f.token=null,f=null}}}function We(s){let e,t,n,r,a=h("workflows.no-workers-failure-message")+"",o,f;return t=new Pe({}),{c(){e=T("div"),k(t.$$.fragment),n=O(),r=T("p"),o=J(a),this.h()},l(l){e=j(l,"DIV",{class:!0});var u=C(e);b(t.$$.fragment,u),n=R(u),r=j(u,"P",{class:!0});var c=C(r);o=K(c,a),c.forEach(p),u.forEach(p),this.h()},h(){B(r,"class","-mt-10"),B(e,"class","text-center")},m(l,u){w(l,e,u),y(t,e,null),W(e,n),W(e,r),W(r,o),f=!0},p:P,i(l){f||(d(t.$$.fragment,l),f=!0)},o(l){_(t.$$.fragment,l),f=!1},d(l){l&&p(e),v(t)}}}function Qe(s){var n,r;let e,t;return e=new de({props:{title:h("common.error-occurred"),content:h("workflows.no-workers-running-message"),error:(r=(n=s[3].metadata)==null?void 0:n.error)==null?void 0:r.message}}),{c(){k(e.$$.fragment)},l(a){b(e.$$.fragment,a)},m(a,o){y(e,a,o),t=!0},p(a,o){var l,u;const f={};o[0]&8&&(f.error=(u=(l=a[3].metadata)==null?void 0:l.error)==null?void 0:u.message),e.$set(f)},i(a){t||(d(e.$$.fragment,a),t=!0)},o(a){_(e.$$.fragment,a),t=!1},d(a){v(e,a)}}}function Le(s){let e=s[32]+"",t;return{c(){t=J(e)},l(n){t=K(n,e)},m(n,r){w(n,t,r)},p(n,r){r[0]&4&&e!==(e=n[32]+"")&&fe(t,e)},d(n){n&&p(t)}}}function se(s){let e,t;return e=new je({props:{value:s[32],description:s[35],$$slots:{default:[Le]},$$scope:{ctx:s}}}),{c(){k(e.$$.fragment)},l(n){b(e.$$.fragment,n)},m(n,r){y(e,n,r),t=!0},p(n,r){const a={};r[0]&4&&(a.value=n[32]),r[0]&4&&(a.description=n[35]),r[0]&4|r[1]&128&&(a.$$scope={dirty:r,ctx:n}),e.$set(a)},i(n){t||(d(e.$$.fragment,n),t=!0)},o(n){_(e.$$.fragment,n),t=!1},d(n){v(e,n)}}}function Ne(s){let e,t,n=re(s[2]),r=[];for(let o=0;o<n.length;o+=1)r[o]=se(le(s,n,o));const a=o=>_(r[o],1,1,()=>{r[o]=null});return{c(){for(let o=0;o<r.length;o+=1)r[o].c();e=ee()},l(o){for(let f=0;f<r.length;f+=1)r[f].l(o);e=ee()},m(o,f){for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(o,f);w(o,e,f),t=!0},p(o,f){if(f[0]&4){n=re(o[2]);let l;for(l=0;l<n.length;l+=1){const u=le(o,n,l);r[l]?(r[l].p(u,f),d(r[l],1)):(r[l]=se(u),r[l].c(),d(r[l],1),r[l].m(e.parentNode,e))}for(ce(),l=n.length;l<r.length;l+=1)a(l);me()}},i(o){if(!t){for(let f=0;f<n.length;f+=1)d(r[f]);t=!0}},o(o){r=r.filter(Boolean);for(let f=0;f<r.length;f+=1)_(r[f]);t=!1},d(o){o&&p(e),we(r,o)}}}function Ue(s){let e=(s[9]?h("workflows.run-query"):h("workflows.refresh-query"))+"",t;return{c(){t=J(e)},l(n){t=K(n,e)},m(n,r){w(n,t,r)},p(n,r){r[0]&512&&e!==(e=(n[9]?h("workflows.run-query"):h("workflows.refresh-query"))+"")&&fe(t,e)},d(n){n&&p(t)}}}function Ae(s){let e,t,n,r,a,o,f,l,u,c;function D(i){s[19](i)}let q={id:"query-select",label:h("workflows.query-type"),class:"min-w-fit","data-testid":"query-select",required:!0,$$slots:{default:[Ne]},$$scope:{ctx:s}};s[0]!==void 0&&(q.value=s[0]),e=new Te({props:q}),Z.push(()=>te(e,"value",D));function S(i){s[20](i)}let I={label:h("workflows.query-arg")};return s[1]!==void 0&&(I.input=s[1]),a=new ve({props:I}),Z.push(()=>te(a,"input",S)),u=new qe({props:{loading:s[4],variant:s[9]?"primary":"secondary",leadingIcon:s[9]?null:"retry",disabled:s[4],$$slots:{default:[Ue]},$$scope:{ctx:s}}}),u.$on("click",s[21]),{c(){k(e.$$.fragment),n=O(),r=T("div"),k(a.$$.fragment),f=O(),l=T("div"),k(u.$$.fragment),this.h()},l(i){b(e.$$.fragment,i),n=R(i),r=j(i,"DIV",{class:!0});var m=C(r);b(a.$$.fragment,m),m.forEach(p),f=R(i),l=j(i,"DIV",{class:!0});var E=C(l);b(u.$$.fragment,E),E.forEach(p),this.h()},h(){B(r,"class","flex flex-col gap-1"),B(l,"class","flex w-full flex-wrap items-end justify-end gap-4")},m(i,m){y(e,i,m),w(i,n,m),w(i,r,m),y(a,r,null),w(i,f,m),w(i,l,m),y(u,l,null),c=!0},p(i,m){const E={};m[0]&4|m[1]&128&&(E.$$scope={dirty:m,ctx:i}),!t&&m[0]&1&&(t=!0,E.value=i[0],x(()=>t=!1)),e.$set(E);const Q={};!o&&m[0]&2&&(o=!0,Q.input=i[1],x(()=>o=!1)),a.$set(Q);const g={};m[0]&16&&(g.loading=i[4]),m[0]&512&&(g.variant=i[9]?"primary":"secondary"),m[0]&512&&(g.leadingIcon=i[9]?null:"retry"),m[0]&16&&(g.disabled=i[4]),m[0]&512|m[1]&128&&(g.$$scope={dirty:m,ctx:i}),u.$set(g)},i(i){c||(d(e.$$.fragment,i),d(a.$$.fragment,i),d(u.$$.fragment,i),c=!0)},o(i){_(e.$$.fragment,i),_(a.$$.fragment,i),_(u.$$.fragment,i),c=!1},d(i){i&&(p(n),p(r),p(f),p(l)),v(e,i),v(a),v(u)}}}function Fe(s){var n;let e,t;return e=new de({props:{title:h("common.error-occurred"),error:(n=s[34])==null?void 0:n.message}}),{c(){k(e.$$.fragment)},l(r){b(e.$$.fragment,r)},m(r,a){y(e,r,a),t=!0},p(r,a){var f;const o={};a[0]&192&&(o.error=(f=r[34])==null?void 0:f.message),e.$set(o)},i(r){t||(d(e.$$.fragment,r),t=!0)},o(r){_(e.$$.fragment,r),t=!1},d(r){v(e,r)}}}function ze(s){oe(s);let e,t,n,r,a;return t=new Ce({props:{label:h("workflows.json-formatting"),labelPosition:"left",id:"json-formatting",checked:s[5]}}),t.$on("change",s[22]),r=new Ee({props:{content:s[33],language:s[5]?"json":"text",copyIconTitle:h("common.copy-icon-title"),copySuccessIconTitle:h("common.copy-success-icon-title"),testId:"query-result",class:s[9]&&"opacity-50"}}),{c(){e=T("div"),k(t.$$.fragment),n=O(),k(r.$$.fragment),this.h()},l(o){e=j(o,"DIV",{class:!0});var f=C(e);b(t.$$.fragment,f),f.forEach(p),n=R(o),b(r.$$.fragment,o),this.h()},h(){B(e,"class","ml-auto")},m(o,f){w(o,e,f),y(t,e,null),w(o,n,f),y(r,o,f),a=!0},p(o,f){oe(o);const l={};f[0]&32&&(l.checked=o[5]),t.$set(l);const u={};f[0]&192&&(u.content=o[33]),f[0]&32&&(u.language=o[5]?"json":"text"),f[0]&512&&(u.class=o[9]&&"opacity-50"),r.$set(u)},i(o){a||(d(t.$$.fragment,o),d(r.$$.fragment,o),a=!0)},o(o){_(t.$$.fragment,o),_(r.$$.fragment,o),a=!1},d(o){o&&(p(e),p(n)),v(t),v(r,o)}}}function Ge(s){return{c:P,l:P,m:P,p:P,i:P,o:P,d:P}}function He(s){let e,t,n,r;const a=[Qe,We,Re],o=[];function f(l,u){return l[8]?0:l[2].length?2:1}return t=f(s),n=o[t]=a[t](s),{c(){e=T("section"),n.c()},l(l){e=j(l,"SECTION",{});var u=C(e);n.l(u),u.forEach(p)},m(l,u){w(l,e,u),o[t].m(e,null),r=!0},p(l,u){let c=t;t=f(l),t===c?o[t].p(l,u):(ce(),_(o[c],1,1,()=>{o[c]=null}),me(),n=o[t],n?n.p(l,u):(n=o[t]=a[t](l),n.c()),d(n,1),n.m(e,null))},i(l){r||(d(n),r=!0)},o(l){_(n),r=!1},d(l){l&&p(e),o[t].d()}}}function Je(s,e,t){let n,r,a,o,f,l;L(s,Se,$=>t(23,o=$)),L(s,pe,$=>t(24,f=$)),L(s,Ve,$=>t(3,l=$));var u,c,D,q,S,I;const{namespace:i,workflow:m,run:E}=f.params,Q={id:m,runId:E};let g,N,V="",U="",A=!1,F=!0,M,z;const X=()=>{t(4,A=!1),t(17,N=g),t(18,U=V)},Y=async $=>{var G;t(4,A=!0);let H;try{t(7,z=V?Be(V,"json/plain",!1):Promise.resolve(null)),H=await z}catch{X();return}t(6,M=De({namespace:i,workflow:Q,queryType:$,queryArgs:H?{payloads:H}:null},(G=f.data)===null||G===void 0?void 0:G.settings,o==null?void 0:o.accessToken).finally(()=>{X()}))};function _e($){g=$,t(0,g),t(2,a),t(16,I),t(3,l),t(13,D),t(14,q),t(15,S)}function ge($){V=$,t(1,V)}const $e=()=>Y(g),he=()=>t(5,F=!F);return s.$$.update=()=>{s.$$.dirty[0]&57352&&t(2,a=(t(15,S=t(14,q=t(13,D=l==null?void 0:l.metadata)===null||D===void 0?void 0:D.definition)===null||q===void 0?void 0:q.queryDefinitions)===null||S===void 0?void 0:S.filter($=>($==null?void 0:$.name)!=="__stack_trace"))||[]),s.$$.dirty[0]&65541&&t(0,g=g||(t(16,I=a==null?void 0:a[0])===null||I===void 0?void 0:I.name)),s.$$.dirty[0]&393219&&t(9,n=N!==g||V!==U),s.$$.dirty[0]&6152&&t(8,r=t(12,c=t(11,u=l.metadata)===null||u===void 0?void 0:u.error)===null||c===void 0?void 0:c.message)},[g,V,a,l,A,F,M,z,r,n,Y,u,c,D,q,S,I,N,U,_e,ge,$e,he]}class Ke extends ue{constructor(e){super(),ie(this,e,Je,He,ae,{},null,[-1,-1])}}function Me(s){let e,t;return e=new Ke({}),{c(){k(e.$$.fragment)},l(n){b(e.$$.fragment,n)},m(n,r){y(e,n,r),t=!0},i(n){t||(d(e.$$.fragment,n),t=!0)},o(n){_(e.$$.fragment,n),t=!1},d(n){v(e,n)}}}function Xe(s){let e,t,n,r;return e=new ke({props:{title:`${h("workflows.queries-tab")} | ${s[1]}`,url:s[0].url.href}}),n=new be({props:{$$slots:{default:[Me]},$$scope:{ctx:s}}}),{c(){k(e.$$.fragment),t=O(),k(n.$$.fragment)},l(a){b(e.$$.fragment,a),t=R(a),b(n.$$.fragment,a)},m(a,o){y(e,a,o),w(a,t,o),y(n,a,o),r=!0},p(a,[o]){const f={};o&1&&(f.url=a[0].url.href),e.$set(f);const l={};o&4&&(l.$$scope={dirty:o,ctx:a}),n.$set(l)},i(a){r||(d(e.$$.fragment,a),d(n.$$.fragment,a),r=!0)},o(a){_(e.$$.fragment,a),_(n.$$.fragment,a),r=!1},d(a){a&&p(t),v(e,a),v(n,a)}}}function Ye(s,e,t){let n;L(s,pe,a=>t(0,n=a));const r=n.params.workflow;return[n,r]}class kt extends ue{constructor(e){super(),ie(this,e,Ye,Xe,ae,{})}}export{kt as component};
