import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as dt,e as r,r as e,b as ut,c as d,t as V,d as i,l as J,s as L,m as M,ag as xt,a as Rt,f as x,g as t,n as Pt,aK as Kt}from"../chunks/BZ1i_Yzi.js";import{t as w,a,c as X,b as _t}from"../chunks/B11KKQxI.js";import{i as ct}from"../chunks/EXou6kTq.js";import{a as it,s as yt,b as ae}from"../chunks/nHCSEYHe.js";import{p as Ft}from"../chunks/ekiUO8I7.js";import{P as se}from"../chunks/BSbw5w3E.js";import{s as m}from"../chunks/BtIgVYD3.js";import{a as Bt}from"../chunks/C5EvHk3S.js";import{i as ot}from"../chunks/Pfo2U1_a.js";import{P as Nt,W as oe}from"../chunks/CLQz9pfK.js";import{T as le,a as ne,b as Ht}from"../chunks/yMB5vANo.js";import{t as T}from"../chunks/D2OY9xdY.js";import{a as ie,b as de,c as ue,d as ce,e as ve,f as fe,p as _e,h as me,i as pe,j as ge,g as he}from"../chunks/DyPqULYf.js";import{p as we}from"../chunks/BdfK0qnH.js";import{s as Tt}from"../chunks/DBXxAZ3D.js";import{p as Z}from"../chunks/DQFlnzBt.js";import{e as lt,i as nt}from"../chunks/DT_Kaee1.js";import{c as Yt,s as St,a as $e,d as xe}from"../chunks/BqyZnqh5.js";import{B as be}from"../chunks/D6I1ivHq.js";import{I as Lt}from"../chunks/DrUA5UyL.js";import{t as ke}from"../chunks/Ds6tgvmq.js";import{E as It}from"../chunks/BH5Z54-t.js";import{T as bt,a as kt,b as mt}from"../chunks/DoW15b8G.js";import{f as Ct,t as zt,r as ye}from"../chunks/iju4fhDV.js";import"../chunks/BipkNA2r.js";import"../chunks/BGZA9hX-.js";import"../chunks/Dn3m877e.js";import"../chunks/DHiO13w7.js";import{S as Pe}from"../chunks/DLRGkYcE.js";const Mt=we("taskQueueView","workers",!0);var Te=w("<span><!> <!> <!></span>"),Ie=w('<span class="flex items-center gap-1 rounded-sm border border-subtle px-1 text-sm text-primary"><!> </span>'),Re=w('<p class="flex select-all gap-2 font-mono"><!></p>');function At(z,g){dt(g,!1);let U=Z(g,"defaultVersion",8,!1),j=Z(g,"active",8,!1),A=Z(g,"buildId",8);ct();var p=Re(),I=r(p);{var P=b=>{var $=Te(),k=r($);Lt(k,{name:"merge"});var q=d(k),n=d(q);Tt(n,g,"overall-default-worker",{},null);var C=d(n,2);Tt(C,g,"default-worker",{},null),e($),V(F=>{St($,1,F),m(q,`${A()??""} `)},[()=>Yt(ke("flex items-center gap-1 rounded-sm border border-subtle px-1 text-sm text-primary",j()&&"border-green-200 bg-green-200 text-black"))],i),a(b,$)},B=(b,$)=>{{var k=q=>{var n=Ie(),C=r(n);Lt(C,{name:"merge"});var F=d(C,1,!0);e(n),V(()=>m(F,A())),a(q,n)};ot(b,q=>{A()&&q(k)},$)}};ot(I,b=>{U()&&A()?b(P):b(B,!1)})}e(p),a(z,p),ut()}var Qe=w('<td class="text-left" data-testid="version-default"><!></td> <td class="text-left" data-testid="version-compatible-builds"><div class="flex flex-wrap gap-2 font-mono"></div></td>',1),Ve=w('<tr class="w-full"><td colspan="2"><!></td></tr>'),qe=w('<th class="w-3/12"> </th> <th class="w-9/12"> </th>',1),Ae=w('<td class="text-left" data-testid="worker-identity"><p class="select-all"><!></p></td> <td class="text-left" data-testid="worker-last-access-time"><p><span> </span></p></td>',1),Be=w('<td class="text-left" data-testid="worker-identity"><p class="select-all"> </p></td> <!> <td class="text-left" data-testid="worker-last-access-time"><p class="select-all"> </p></td> <td data-testid="workflow-poller"><!></td> <td data-testid="activity-poller"><!></td>',1),Se=w('<tr class="w-full"><td><!></td></tr>'),Ce=w('<caption class="sr-only" slot="caption"> </caption>'),Fe=w('<th class="w-3/12"> </th> <th class="w-2/12"> </th>',1),We=w('<th> </th> <!> <th class="w-2/12"> </th> <th class="w-2/12"><p class="text-center"> </p></th> <th class="w-2/12 text-center"><p class="text-center"> </p></th>',1),De=w('<h2 data-testid="version-sets"> </h2> <!> <h2 class="flex items-center gap-2" data-testid="workers"> <!></h2> <!>',1);function Oe(z,g){dt(g,!1);const[U,j]=yt(),A=()=>it(zt,"$timeFormat",U),p=()=>it(ye,"$relativeTime",U),I=M(),P=M();let B=Z(g,"taskQueue",8),b=Z(g,"workers",8),$=Z(g,"reachability",8,void 0),k=Z(g,"compatibility",8,void 0);J(()=>xt(k()),()=>{L(I,ie(k()))}),J(()=>xt(k()),()=>{L(P,de(k()))}),Rt(),ct();var q=De(),n=x(q),C=r(n,!0);e(n);var F=d(n,2);bt(F,{class:"mb-6 w-full min-w-[600px] table-fixed",children:(y,tt)=>{var l=X(),u=x(l);lt(u,1,()=>t(I),nt,(s,o,c)=>{mt(s,{"data-testid":"version-row",children:(v,f)=>{var _=Qe(),h=x(_),R=r(h);const W=i(()=>ce(t(o).buildIds));At(R,{defaultVersion:!0,active:c===0,get buildId(){return t(W)},$$slots:{"overall-default-worker":(E,G)=>{var Q=X(),H=x(Q);{var S=Y=>{var et=_t();V(rt=>m(et,rt),[()=>T("workers.overall")],i),a(Y,et)};ot(H,Y=>{c===0&&Y(S)})}a(E,Q)},"default-worker":(E,G)=>{var Q=_t();V(H=>m(Q,H),[()=>T("workers.default")],i),a(E,Q)}}}),e(h);var D=d(h,2),O=r(D);lt(O,5,()=>ue(t(o).buildIds),nt,(E,G)=>{At(E,{active:!1,get buildId(){return t(G)},$$slots:{"default-worker":(Q,H)=>{var S=_t();V(Y=>m(S,Y),[()=>T("workers.default")],i),a(Q,S)}}})}),e(O),e(D),a(v,_)},$$slots:{default:!0}})},s=>{var o=Ve(),c=r(o),v=r(c);const f=i(()=>T("workers.no-version-sets-found"));It(v,{get title(){return t(f)}}),e(c),e(o),a(s,o)}),a(y,l)},$$slots:{default:!0,headers:(y,tt)=>{kt(y,{slot:"headers",children:(l,u)=>{var s=qe(),o=x(s),c=r(o,!0);e(o);var v=d(o,2),f=r(v,!0);e(v),V((_,h)=>{m(c,_),m(f,h)},[()=>T("workers.default"),()=>T("workers.compatible-build-ids")],i),a(l,s)},$$slots:{default:!0}})}}});var K=d(F,2),N=r(K),at=d(N);be(at,{type:"count",children:(y,tt)=>{Pt();var l=_t();V(()=>{var u,s;return m(l,((s=(u=b())==null?void 0:u.pollers)==null?void 0:s.length)||0)}),a(y,l)},$$slots:{default:!0}}),e(K);var st=d(K,2);bt(st,{class:"mb-6 w-full min-w-[600px] table-fixed",children:(y,tt)=>{var l=X(),u=x(l);lt(u,1,()=>{var s;return(s=b())==null?void 0:s.pollers},s=>s.identity,(s,o)=>{const c=i(()=>ve(t(o))),v=i(()=>fe($(),B(),t(c)));mt(s,{"data-testid":"worker-row",children:(f,_)=>{var h=Be(),R=x(h),W=r(R),D=r(W,!0);e(W),e(R);var O=d(R,2);{var E=gt=>{var ht=Ae(),ft=x(ht),Wt=r(ft),Gt=r(Wt);const Jt=i(()=>t(c)===t(P)),Xt=i(()=>t(c)===t(P));At(Gt,{get defaultVersion(){return t(Jt)},get active(){return t(Xt)},get buildId(){return t(c)},$$slots:{"overall-default-worker":(wt,te)=>{var $t=X(),Vt=x($t);{var ee=qt=>{var jt=_t();V(re=>m(jt,re),[()=>T("workers.overall")],i),a(qt,jt)};ot(Vt,qt=>{t(c)===t(P)&&qt(ee)})}a(wt,$t)},"default-worker":(wt,te)=>{var $t=_t();V(Vt=>m($t,Vt),[()=>T("workers.default")],i),a(wt,$t)}}}),e(Wt),e(ft);var Dt=d(ft,2),Ot=r(Dt),Qt=r(Ot);let Et;var Zt=r(Qt,!0);e(Qt),e(Ot),e(Dt),V(wt=>{Et=St(Qt,1,"svelte-kdqm2r",null,Et,wt),m(Zt,t(v))},[()=>({reachability:!!t(v)})],i),a(gt,ht)};ot(O,gt=>{var ht,ft;(ft=(ht=$())==null?void 0:ht.buildIdReachability)!=null&&ft.length&&gt(E)})}var G=d(O,2),Q=r(G),H=r(Q,!0);e(Q),e(G);var S=d(G,2),Y=r(S);const et=i(()=>t(o).taskQueueTypes.includes("WORKFLOW"));Nt(Y,{get includesTaskQueueType(){return t(et)}}),e(S);var rt=d(S,2),pt=r(rt);const vt=i(()=>t(o).taskQueueTypes.includes("ACTIVITY"));Nt(pt,{get includesTaskQueueType(){return t(vt)}}),e(rt),V(gt=>{m(D,t(o).identity),m(H,gt)},[()=>Ct(t(o).lastAccessTime,A(),{relative:p()})],i),a(f,h)},$$slots:{default:!0}})},s=>{var o=Se(),c=r(o),v=r(c);const f=i(()=>T("workflows.workers-empty-state"));It(v,{get title(){return t(f)}}),e(c),e(o),V(()=>{var _,h;return $e(c,"colspan",(h=(_=$())==null?void 0:_.buildIdReachability)!=null&&h.length?6:4)}),a(s,o)}),a(y,l)},$$slots:{default:!0,caption:(y,tt)=>{var l=Ce(),u=r(l,!0);e(l),V(s=>m(u,s),[()=>T("workflows.workers-tab")],i),a(y,l)},headers:(y,tt)=>{kt(y,{slot:"headers",children:(l,u)=>{var s=We(),o=x(s),c=r(o,!0);e(o);var v=d(o,2);{var f=Q=>{var H=Fe(),S=x(H),Y=r(S,!0);e(S);var et=d(S,2),rt=r(et,!0);e(et),V((pt,vt)=>{m(Y,pt),m(rt,vt)},[()=>T("workers.version"),()=>T("workers.retirability")],i),a(Q,H)};ot(v,Q=>{var H,S;(S=(H=$())==null?void 0:H.buildIdReachability)!=null&&S.length&&Q(f)})}var _=d(v,2),h=r(_,!0);e(_);var R=d(_,2),W=r(R),D=r(W,!0);e(W),e(R);var O=d(R,2),E=r(O),G=r(E,!0);e(E),e(O),V((Q,H,S,Y)=>{var et,rt;St(o,1,Yt((rt=(et=$())==null?void 0:et.buildIdReachability)!=null&&rt.length?"w-3/12":"w-6/12")),m(c,Q),m(h,H),m(D,S),m(G,Y)},[()=>T("common.id"),()=>T("workflows.last-accessed"),()=>T("workflows.workflow-task-handler"),()=>T("workflows.activity-handler")],i),a(l,s)},$$slots:{default:!0}})}}}),V((y,tt)=>{m(C,y),m(N,`${tt??""} `)},[()=>T("workers.version-sets"),()=>T("workers.workers")],i),a(z,q),ut(),j()}var Ee=w('<td class="text-left" data-testid="index"></td> <td class="break-all text-left" data-testid="target-build-id"> </td> <td class="text-right" data-testid="target-ramp"> </td> <td class="justfiy-between flex w-full items-center text-right" data-testid="target-create-time"><p> </p></td>',1),je=w('<tr class="w-full"><td colspan="4"><!></td></tr>'),Ke=w('<td></td> <td class="break-all text-left text-blue-700 underline"> </td> <td></td> <td></td>',1),Ne=w("<!> <!>",1),He=w('<th class="w-20">Index</th> <th class="grow">Target Build ID</th> <th class="w-20">Ramp</th> <th class="text-right">Create Time</th>',1),Le=w('<td class="text-left" data-testid="target-source"> </td> <td class="text-left" data-testid="target-source"> </td> <td class="text-left" data-testid="target-source"> </td>',1),Me=w('<tr class="w-full"><td colspan="3"><!></td></tr>'),Ue=w('<th class="w-1/3">Source Build ID</th> <th class="w-1/3">Target Build ID</th> <th class="w-1/3">Create Time</th>',1),Ye=w('<h2 data-testid="worker-rules"> </h2> <!> <h2 data-testid="worker-rules"> </h2> <!>',1);function ze(z,g){dt(g,!1);const[U,j]=yt(),A=()=>it(zt,"$timeFormat",U),p=M(),I=M(),P=M(),B=M(),b=M(),$=M(),k=M();let q=Z(g,"rules",8),n=M(!1);const C=l=>{var u,s,o;return!((u=l.rule)===null||u===void 0)&&u.percentageRamp?!((o=(s=l.rule)===null||s===void 0?void 0:s.percentageRamp)===null||o===void 0)&&o.rampPercentage?l.rule.percentageRamp.rampPercentage:0:100};J(()=>(t(p),t(I),xt(q())),()=>{(l=>(L(p,Kt(l.assignmentRules,()=>[],!0)),L(I,Kt(l.compatibleRedirectRules,()=>[],!0))))(q())}),J(()=>t(p),()=>{L(P,t(p).find(l=>C(l)===100))}),J(()=>(t(p),t(P)),()=>{L(B,t(p).indexOf(t(P)))}),J(()=>(t(p),t(B)),()=>{L(b,t(p).filter((l,u)=>u<=t(B)))}),J(()=>(t(p),t(B)),()=>{L($,t(p).filter((l,u)=>u>t(B)))}),J(()=>(t(n),t(b),t($)),()=>{L(k,t(n)?[...t(b),...t($)]:t(b))}),Rt(),ct();var F=Ye(),K=x(F),N=r(K,!0);e(K);var at=d(K,2);bt(at,{class:"mb-6 w-full table-fixed",children:(l,u)=>{var s=Ne(),o=x(s);lt(o,1,()=>t(k),nt,(f,_,h)=>{mt(f,{"data-testid":"version-row",children:(R,W)=>{var D=Ee(),O=x(D);O.textContent=h;var E=d(O,2),G=r(E,!0);e(E);var Q=d(E,2),H=r(Q);e(Q);var S=d(Q,2),Y=r(S),et=r(Y,!0);e(Y),e(S),V((rt,pt)=>{var vt;m(G,(vt=t(_).rule)==null?void 0:vt.targetBuildId),m(H,`${rt??""}%`),m(et,pt)},[()=>C(t(_)).toFixed(0),()=>Ct(t(_).createTime,A())],i),a(R,D)},$$slots:{default:!0}})},f=>{var _=je(),h=r(_),R=r(h);const W=i(()=>T("workers.no-assignment-rules-found"));It(R,{get title(){return t(W)}}),e(h),e(_),a(f,_)});var c=d(o,2);{var v=f=>{mt(f,{"data-testid":"view-all",class:"surface-subtle cursor-pointer",$$events:{click:()=>L(n,!t(n))},children:(_,h)=>{var R=Ke(),W=d(x(R),2),D=r(W,!0);e(W),Pt(4),V(O=>m(D,O),[()=>T("workers.show-inactive-assignment-rules")],i),a(_,R)},$$slots:{default:!0}})};ot(c,f=>{var _;!t(n)&&((_=t($))!=null&&_.length)&&f(v)})}a(l,s)},$$slots:{default:!0,headers:(l,u)=>{kt(l,{slot:"headers",children:(s,o)=>{var c=He();Pt(6),a(s,c)},$$slots:{default:!0}})}}});var st=d(at,2),y=r(st,!0);e(st);var tt=d(st,2);bt(tt,{class:"mb-6 w-full table-fixed",children:(l,u)=>{var s=X(),o=x(s);lt(o,1,()=>t(I),nt,(c,v)=>{mt(c,{"data-testid":"version-row",children:(f,_)=>{var h=Le(),R=x(h),W=r(R,!0);e(R);var D=d(R,2),O=r(D,!0);e(D);var E=d(D,2),G=r(E,!0);e(E),V(Q=>{m(W,t(v).rule.sourceBuildId),m(O,t(v).rule.targetBuildId),m(G,Q)},[()=>Ct(t(v).createTime,A())],i),a(f,h)},$$slots:{default:!0}})},c=>{var v=Me(),f=r(v),_=r(f);const h=i(()=>T("workers.no-redirect-rules-found"));It(_,{get title(){return t(h)}}),e(f),e(v),a(c,v)}),a(l,s)},$$slots:{default:!0,headers:(l,u)=>{kt(l,{slot:"headers",children:(s,o)=>{var c=Ue();Pt(4),a(s,c)},$$slots:{default:!0}})}}}),V((l,u)=>{m(N,l),m(y,u)},[()=>T("workers.assignment-rules"),()=>T("workers.redirect-rules")],i),a(z,F),ut(),j()}var Ge=w('<td style="padding-right: 0.5rem;"><!></td>'),Je=w("<th></th>");function Ut(z,g){dt(g,!1);let U=Z(g,"rows",8,10),j=Z(g,"columns",8,4),A=Z(g,"columnWidths",24,()=>new Array(j()).fill(100/j()));ct(),bt(z,{class:"w-full table-fixed",variant:"fancy",children:(p,I)=>{var P=X(),B=x(P);lt(B,1,()=>Array.from(Array(U()).keys()),nt,(b,$)=>{mt(b,{children:(k,q)=>{var n=X(),C=x(n);lt(C,1,()=>Array.from(new Array(j())),nt,(F,K)=>{var N=Ge(),at=r(N);Pe(at,{class:"h-4 w-full"}),e(N),a(F,N)}),a(k,n)},$$slots:{default:!0}})}),a(p,P)},$$slots:{default:!0,headers:(p,I)=>{kt(p,{slot:"headers",class:"h-8",children:(P,B)=>{var b=X(),$=x(b);Tt($,g,"headers",{},k=>{var q=X(),n=x(q);lt(n,1,()=>Array.from(new Array(j())),nt,(C,F,K)=>{var N=Je();V(()=>xe(N,`width: ${A()[K]??""}%;`)),a(C,N)}),a(k,q)}),a(P,b)},$$slots:{default:!0}})}}}),ut()}var Xe=w("<!> <!>",1),Ze=w("<p>No versioning configured for task queue.</p>");function tr(z,g){dt(g,!1);const[U,j]=yt(),A=()=>it(Ft,"$page",U),p=M(),I=M(),P=M(),B=M();let b=Z(g,"taskQueue",8),$=Z(g,"workers",8);J(()=>(t(p),A()),()=>{(n=>L(p,n.namespace))(A().params)}),J(()=>xt($()),()=>{L(I,_e($().pollers))}),J(()=>xt($()),()=>{L(P,me($().pollers))}),J(()=>{},()=>{L(B,n=>(n==null?void 0:n.assignmentRules)||(n==null?void 0:n.compatibleRedirectRules))}),Rt(),ct();var k=X(),q=x(k);Bt(q,()=>pe({namespace:t(p),queue:b()}),n=>{Ut(n,{rows:3})},(n,C)=>{var F=i(()=>{var{rules:u,compatibility:s,versionSets:o}=t(C);return{rules:u,compatibility:s,versionSets:o}}),K=i(()=>t(F).rules),N=i(()=>t(F).compatibility),at=i(()=>t(F).versionSets),st=X(),y=x(st);{var tt=u=>{ze(u,{get rules(){return t(K)}})},l=(u,s)=>{{var o=v=>{var f=X(),_=x(f);Bt(_,()=>ge({namespace:t(p),buildIds:t(P),queue:b()}),h=>{Ut(h,{rows:3})},(h,R)=>{var W=Xe(),D=x(W);Tt(D,g,"default",{get compatibility(){return t(N)}},null);var O=d(D,2);Oe(O,{get taskQueue(){return b()},get workers(){return $()},get compatibility(){return t(N)},get reachability(){return t(R)}}),a(h,W)}),a(v,f)},c=v=>{var f=Ze();a(v,f)};ot(u,v=>{var f;t(I)&&((f=t(at))!=null&&f.length)?v(o):v(c,!1)},s)}};ot(y,u=>{t(B)(t(K))?u(tt):u(l,!1)})}a(n,st)}),a(z,k),ut(),j()}var er=w("<!> <!>",1),rr=w('<section class="flex flex-col gap-4"><h2 data-testid="task-queue-name"> </h2> <!> <!></section>');function ar(z,g){dt(g,!1);const[U,j]=yt(),A=()=>it(Ft,"$page",U),p=()=>it(Mt,"$taskQueueView",U),I=M(),P=M(),B=k=>{ae(Mt,k)};J(()=>(t(I),t(P),A()),()=>{(k=>(L(I,k.queue),L(P,k.namespace)))(A().params)}),Rt(),ct();var b=X(),$=x(b);Bt($,()=>he({queue:t(I),namespace:t(P)}),null,(k,q)=>{var n=rr(),C=r(n),F=r(C,!0);e(C);var K=d(C,2);le(K,{children:(y,tt)=>{ne(y,{class:"flex flex-wrap gap-6 p-4 pl-0",label:"task queue detail",children:(l,u)=>{var s=er(),o=x(s);const c=i(()=>T("workers.workers")),v=i(()=>p()==="workers");Ht(o,{get label(){return t(c)},id:"worker-tab",onClick:()=>B("workers"),get active(){return t(v)}});var f=d(o,2);const _=i(()=>T("workers.versioning")),h=i(()=>p()==="versioning");Ht(f,{get label(){return t(_)},id:"versioning-tab",onClick:()=>B("versioning"),get active(){return t(h)}}),a(l,s)},$$slots:{default:!0}})},$$slots:{default:!0}});var N=d(K,2);{var at=y=>{tr(y,{get taskQueue(){return t(I)},get workers(){return t(q)}})},st=y=>{oe(y,{get workers(){return t(q)}})};ot(N,y=>{p()==="versioning"?y(at):y(st,!1)})}e(n),V(()=>m(F,t(I))),a(k,n)}),a(z,b),ut(),j()}var sr=w("<!> <!>",1);function Fr(z,g){dt(g,!1);const[U,j]=yt(),A=()=>it(Ft,"$page",U),p=A().params.queue;ct();var I=sr(),P=x(I);se(P,{title:`Task Queue | ${p}`,get url(){return A().url.href}});var B=d(P,2);ar(B,{}),a(z,I),ut(),j()}export{Fr as component};
