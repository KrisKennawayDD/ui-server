import{r as Be}from"../chunks/index.DYMvb8Iz.js";import{e as Ie,b as Je,g as ye}from"../chunks/route-for.Yl4e4V_I.js";import{s as Oe,d,i as k,h as N,j as Y,k as J,l as Z,e as j,q as Me,n as M,f as V,c as me,v as ue,U as Ke,m as x,t as ee,O as se,a3 as ne,w as Ae,P as Ge,o as Se}from"../chunks/scheduler.gES7FyoG.js";import{S as qe,i as Fe,d as S,t as h,a as b,m as P,c as Q,b as E,h as ae,g as he,e as ke}from"../chunks/index.DpnGbpCk.js";import{p as Ne}from"../chunks/stores.DB9mJoBO.js";import{P as Xe}from"../chunks/page-title.ClCB4mI7.js";import{w as Ye}from"../chunks/entry.DfvJXqtD.js";import{c as Ze,e as xe,P as et,g as tt}from"../chunks/workflows.Cv72NPAk.js";import{A as rt}from"../chunks/add-search-attributes.BUh820cg.js";import{A as Ue}from"../chunks/alert.B7mQa_SE.js";import{B as ve}from"../chunks/button.BNOg_WM6.js";import{C as Le}from"../chunks/card.B8kKqjal.js";import{I as st}from"../chunks/icon.iMHg4y68.js";import{I as Te}from"../chunks/input.C4Z83wRD.js";import{L as Pe}from"../chunks/label.B6iMAtLr.js";import{L as Re}from"../chunks/link.DmRXkIEf.js";import{E as Qe}from"../chunks/editor.D4tf04y8.js";import{T as nt}from"../chunks/tooltip.BwIPcgk-.js";import{t as B}from"../chunks/translate.DzDeFYDI.js";import{g as at}from"../chunks/pollers-service.22J5kITj.js";import{c as ot}from"../chunks/search-attributes.xf2rZoeq.js";import{t as Ee}from"../chunks/toaster.AhhasAU8.js";import{p as We}from"../chunks/format-time.35r7NIm2.js";import{u as je}from"../chunks/update-query-parameters.BmAZAl1P.js";import{w as lt}from"../chunks/workflow-create-disabled.CAM9IlFw.js";import{v as ut}from"../chunks/v4.BOvFkHkt.js";const ft=async function({params:n,parent:t}){var o,a;const e=await t();if(((o=e==null?void 0:e.settings)==null?void 0:o.disableWriteActions)||((a=e==null?void 0:e.settings)==null?void 0:a.startWorkflowDisabled)){const{namespace:$}=n;Be(302,Ie({namespace:$}))}},Xt=Object.freeze(Object.defineProperty({__proto__:null,load:ft},Symbol.toStringTag,{value:"Module"}));function it(n){let t=B("workflows.back-to-workflows")+"",e;return{c(){e=ee(t)},l(r){e=x(r,t)},m(r,o){k(r,e,o)},p:ue,d(r){r&&d(e)}}}function pt(n){let t;return{c(){t=ee("Random UUID")},l(e){t=x(e,"Random UUID")},m(e,r){k(e,t,r)},d(e){e&&d(t)}}}function Ve(n){let t,e;return t=new Ue({props:{intent:n[9]>0?"success":"warning",title:n[9]?"Task Queue is Active":"Task Queue is Inactive",$$slots:{default:[ct]},$$scope:{ctx:n}}}),{c(){E(t.$$.fragment)},l(r){Q(t.$$.fragment,r)},m(r,o){P(t,r,o),e=!0},p(r,o){const a={};o[0]&512&&(a.intent=r[9]>0?"success":"warning"),o[0]&512&&(a.title=r[9]?"Task Queue is Active":"Task Queue is Inactive"),o[0]&8706|o[1]&1024&&(a.$$scope={dirty:o,ctx:r}),t.$set(a)},i(r){e||(b(t.$$.fragment,r),e=!0)},o(r){h(t.$$.fragment,r),e=!1},d(r){S(t,r)}}}function mt(n){let t;return{c(){t=ee("View Task Queue")},l(e){t=x(e,"View Task Queue")},m(e,r){k(e,t,r)},d(e){e&&d(t)}}}function ct(n){let t,e,r,o,a=We("Worker",n[9])+"",$,c,l,m;return l=new Re({props:{href:ye({namespace:n[13],queue:n[1]}),newTab:!0,$$slots:{default:[mt]},$$scope:{ctx:n}}}),{c(){t=M("div"),e=M("p"),r=ee(n[9]),o=V(),$=ee(a),c=V(),E(l.$$.fragment),this.h()},l(f){t=J(f,"DIV",{class:!0});var g=Z(t);e=J(g,"P",{});var _=Z(e);r=x(_,n[9]),o=j(_),$=x(_,a),_.forEach(d),c=j(g),Q(l.$$.fragment,g),g.forEach(d),this.h()},h(){Y(t,"class","flex w-full items-center justify-between")},m(f,g){k(f,t,g),N(t,e),N(e,r),N(e,o),N(e,$),N(t,c),P(l,t,null),m=!0},p(f,g){(!m||g[0]&512)&&Se(r,f[9]),(!m||g[0]&512)&&a!==(a=We("Worker",f[9])+"")&&Se($,a);const _={};g[0]&8194&&(_.href=ye({namespace:f[13],queue:f[1]})),g[1]&1024&&(_.$$scope={dirty:g,ctx:f}),l.$set(_)},i(f){m||(b(l.$$.fragment,f),m=!0)},o(f){h(l.$$.fragment,f),m=!1},d(f){f&&d(t),S(l)}}}function De(n){let t,e,r,o,a;t=new Le({props:{class:"flex flex-col gap-2",$$slots:{default:[gt]},$$scope:{ctx:n}}});function $(l){n[32](l)}let c={};return n[11]!==void 0&&(c.attributesToAdd=n[11]),r=new rt({props:c}),se.push(()=>ae(r,"attributesToAdd",$)),{c(){E(t.$$.fragment),e=V(),E(r.$$.fragment)},l(l){Q(t.$$.fragment,l),e=j(l),Q(r.$$.fragment,l)},m(l,m){P(t,l,m),k(l,e,m),P(r,l,m),a=!0},p(l,m){const f={};m[0]&48|m[1]&1024&&(f.$$scope={dirty:m,ctx:l}),t.$set(f);const g={};!o&&m[0]&2048&&(o=!0,g.attributesToAdd=l[11],ne(()=>o=!1)),r.$set(g)},i(l){a||(b(t.$$.fragment,l),b(r.$$.fragment,l),a=!0)},o(l){h(t.$$.fragment,l),h(r.$$.fragment,l),a=!1},d(l){l&&d(e),S(t,l),S(r,l)}}}function $t(n){let t,e;return t=new st({props:{name:"info"}}),{c(){E(t.$$.fragment)},l(r){Q(t.$$.fragment,r)},m(r,o){P(t,r,o),e=!0},p:ue,i(r){e||(b(t.$$.fragment,r),e=!0)},o(r){h(t.$$.fragment,r),e=!1},d(r){S(t,r)}}}function gt(n){let t,e,r=B("workflows.user-metadata")+"",o,a,$,c=B("workflows.markdown-supported")+"",l,m,f,g,_,O,W,v,D,R,q,F;return f=new nt({props:{topRight:!0,width:200,text:B("workflows.markdown-description"),$$slots:{default:[$t]},$$scope:{ctx:n}}}),_=new Pe({props:{label:B("workflows.summary"),for:"summary"}}),W=new Qe({props:{content:n[4],class:"min-h-48"}}),W.$on("change",n[30]),D=new Pe({props:{label:B("workflows.details"),for:"details"}}),q=new Qe({props:{content:n[5]}}),q.$on("change",n[31]),{c(){t=M("div"),e=M("h3"),o=ee(r),a=V(),$=M("p"),l=ee(c),m=V(),E(f.$$.fragment),g=V(),E(_.$$.fragment),O=V(),E(W.$$.fragment),v=V(),E(D.$$.fragment),R=V(),E(q.$$.fragment),this.h()},l(u){t=J(u,"DIV",{class:!0});var w=Z(t);e=J(w,"H3",{});var C=Z(e);o=x(C,r),C.forEach(d),a=j(w),$=J(w,"P",{class:!0});var U=Z($);l=x(U,c),m=j(U),Q(f.$$.fragment,U),U.forEach(d),w.forEach(d),g=j(u),Q(_.$$.fragment,u),O=j(u),Q(W.$$.fragment,u),v=j(u),Q(D.$$.fragment,u),R=j(u),Q(q.$$.fragment,u),this.h()},h(){Y($,"class","flex items-center gap-1 text-sm text-subtle"),Y(t,"class","flex flex-wrap justify-between")},m(u,w){k(u,t,w),N(t,e),N(e,o),N(t,a),N(t,$),N($,l),N($,m),P(f,$,null),k(u,g,w),P(_,u,w),k(u,O,w),P(W,u,w),k(u,v,w),P(D,u,w),k(u,R,w),P(q,u,w),F=!0},p(u,w){const C={};w[1]&1024&&(C.$$scope={dirty:w,ctx:u}),f.$set(C);const U={};w[0]&16&&(U.content=u[4]),W.$set(U);const L={};w[0]&32&&(L.content=u[5]),q.$set(L)},i(u){F||(b(f.$$.fragment,u),b(_.$$.fragment,u),b(W.$$.fragment,u),b(D.$$.fragment,u),b(q.$$.fragment,u),F=!0)},o(u){h(f.$$.fragment,u),h(_.$$.fragment,u),h(W.$$.fragment,u),h(D.$$.fragment,u),h(q.$$.fragment,u),F=!1},d(u){u&&(d(t),d(g),d(O),d(v),d(R)),S(f),S(_,u),S(W,u),S(D,u),S(q,u)}}}function dt(n){let t=B("common.more-options")+"",e;return{c(){e=ee(t)},l(r){e=x(r,t)},m(r,o){k(r,e,o)},p:ue,d(r){r&&d(e)}}}function _t(n){let t=B("workflows.start-workflow")+"",e;return{c(){e=ee(t)},l(r){e=x(r,t)},m(r,o){k(r,e,o)},p:ue,d(r){r&&d(e)}}}function Ce(n){let t,e;return t=new Ue({props:{intent:"error",title:n[8]}}),{c(){E(t.$$.fragment)},l(r){Q(t.$$.fragment,r)},m(r,o){P(t,r,o),e=!0},p(r,o){const a={};o[0]&256&&(a.title=r[8]),t.$set(a)},i(r){e||(b(t.$$.fragment,r),e=!0)},o(r){h(t.$$.fragment,r),e=!1},d(r){S(t,r)}}}function wt(n){let t,e,r,o,a,$,c,l,m,f,g,_,O,W,v,D,R,q,F,u,w,C,U,L,K,H,oe;function ce(s){n[21](s)}let fe={id:"workflowId",required:!0,label:"Workflow ID",class:"w-full grow"};n[0]!==void 0&&(fe.value=n[0]),e=new Te({props:fe}),se.push(()=>ae(e,"value",ce)),e.$on("blur",n[22]),a=new ve({props:{class:"mt-0 md:mt-6",variant:"secondary",leadingIcon:"retry",$$slots:{default:[pt]},$$scope:{ctx:n}}}),a.$on("click",n[16]);function $e(s){n[23](s)}let te={id:"taskQueue",required:!0,label:"Task Queue",class:"grow"};n[1]!==void 0&&(te.value=n[1]),l=new Te({props:te}),se.push(()=>ae(l,"value",$e)),l.$on("blur",n[24]);let T=n[9]!==void 0&&Ve(n);function ge(s){n[25](s)}let ie={id:"workflowType",required:!0,label:"Workflow Type"};n[2]!==void 0&&(ie.value=n[2]),_=new Te({props:ie}),se.push(()=>ae(_,"value",ge)),_.$on("blur",n[26]);function de(s){n[27](s)}function _e(s){n[28](s)}function we(s){n[29](s)}let le={};n[3]!==void 0&&(le.input=n[3]),n[6]!==void 0&&(le.encoding=n[6]),n[7]!==void 0&&(le.messageType=n[7]),v=new et({props:le}),se.push(()=>ae(v,"input",de)),se.push(()=>ae(v,"encoding",_e)),se.push(()=>ae(v,"messageType",we));let I=n[10]&&De(n);C=new ve({props:{variant:"ghost",class:"max-sm:w-full",trailingIcon:n[10]?"chevron-up":"chevron-down",$$slots:{default:[dt]},$$scope:{ctx:n}}}),C.$on("click",n[33]),L=new ve({props:{disabled:!n[12],"data-testid":"start-workflow-button",class:"max-sm:w-full",$$slots:{default:[_t]},$$scope:{ctx:n}}}),L.$on("click",n[15]);let y=n[8]&&Ce(n);return{c(){t=M("div"),E(e.$$.fragment),o=V(),E(a.$$.fragment),$=V(),c=M("div"),E(l.$$.fragment),f=V(),T&&T.c(),g=V(),E(_.$$.fragment),W=V(),E(v.$$.fragment),F=V(),I&&I.c(),u=V(),w=M("div"),E(C.$$.fragment),U=V(),E(L.$$.fragment),K=V(),y&&y.c(),H=Ae(),this.h()},l(s){t=J(s,"DIV",{class:!0});var p=Z(t);Q(e.$$.fragment,p),o=j(p),Q(a.$$.fragment,p),p.forEach(d),$=j(s),c=J(s,"DIV",{class:!0});var re=Z(c);Q(l.$$.fragment,re),re.forEach(d),f=j(s),T&&T.l(s),g=j(s),Q(_.$$.fragment,s),W=j(s),Q(v.$$.fragment,s),F=j(s),I&&I.l(s),u=j(s),w=J(s,"DIV",{class:!0});var G=Z(w);Q(C.$$.fragment,G),U=j(G),Q(L.$$.fragment,G),G.forEach(d),K=j(s),y&&y.l(s),H=Ae(),this.h()},h(){Y(t,"class","flex w-full flex-col justify-between gap-2 sm:items-center md:flex-row md:gap-4"),Y(c,"class","flex w-full items-center justify-between gap-4"),Y(w,"class","mt-4 flex w-full flex-row justify-between gap-4 max-sm:flex-col")},m(s,p){k(s,t,p),P(e,t,null),N(t,o),P(a,t,null),k(s,$,p),k(s,c,p),P(l,c,null),k(s,f,p),T&&T.m(s,p),k(s,g,p),P(_,s,p),k(s,W,p),P(v,s,p),k(s,F,p),I&&I.m(s,p),k(s,u,p),k(s,w,p),P(C,w,null),N(w,U),P(L,w,null),k(s,K,p),y&&y.m(s,p),k(s,H,p),oe=!0},p(s,p){const re={};!r&&p[0]&1&&(r=!0,re.value=s[0],ne(()=>r=!1)),e.$set(re);const G={};p[1]&1024&&(G.$$scope={dirty:p,ctx:s}),a.$set(G);const pe={};!m&&p[0]&2&&(m=!0,pe.value=s[1],ne(()=>m=!1)),l.$set(pe),s[9]!==void 0?T?(T.p(s,p),p[0]&512&&b(T,1)):(T=Ve(s),T.c(),b(T,1),T.m(g.parentNode,g)):T&&(he(),h(T,1,1,()=>{T=null}),ke());const i={};!O&&p[0]&4&&(O=!0,i.value=s[2],ne(()=>O=!1)),_.$set(i);const z={};!D&&p[0]&8&&(D=!0,z.input=s[3],ne(()=>D=!1)),!R&&p[0]&64&&(R=!0,z.encoding=s[6],ne(()=>R=!1)),!q&&p[0]&128&&(q=!0,z.messageType=s[7],ne(()=>q=!1)),v.$set(z),s[10]?I?(I.p(s,p),p[0]&1024&&b(I,1)):(I=De(s),I.c(),b(I,1),I.m(u.parentNode,u)):I&&(he(),h(I,1,1,()=>{I=null}),ke());const X={};p[0]&1024&&(X.trailingIcon=s[10]?"chevron-up":"chevron-down"),p[1]&1024&&(X.$$scope={dirty:p,ctx:s}),C.$set(X);const A={};p[0]&4096&&(A.disabled=!s[12]),p[1]&1024&&(A.$$scope={dirty:p,ctx:s}),L.$set(A),s[8]?y?(y.p(s,p),p[0]&256&&b(y,1)):(y=Ce(s),y.c(),b(y,1),y.m(H.parentNode,H)):y&&(he(),h(y,1,1,()=>{y=null}),ke())},i(s){oe||(b(e.$$.fragment,s),b(a.$$.fragment,s),b(l.$$.fragment,s),b(T),b(_.$$.fragment,s),b(v.$$.fragment,s),b(I),b(C.$$.fragment,s),b(L.$$.fragment,s),b(y),oe=!0)},o(s){h(e.$$.fragment,s),h(a.$$.fragment,s),h(l.$$.fragment,s),h(T),h(_.$$.fragment,s),h(v.$$.fragment,s),h(I),h(C.$$.fragment,s),h(L.$$.fragment,s),h(y),oe=!1},d(s){s&&(d(t),d($),d(c),d(f),d(g),d(W),d(F),d(u),d(w),d(K),d(H)),S(e),S(a),S(l),T&&T.d(s),S(_,s),S(v,s),I&&I.d(s),S(C),S(L),y&&y.d(s)}}}function bt(n){let t,e,r,o,a="Start a Workflow",$,c,l;return e=new Re({props:{href:`${Ie({namespace:n[13]})}?${n[14]}`,"data-testid":"back-to-workflows",icon:"chevron-left",$$slots:{default:[it]},$$scope:{ctx:n}}}),c=new Le({props:{class:"flex w-full flex-col gap-4 xl:w-3/4 2xl:w-1/2",$$slots:{default:[wt]},$$scope:{ctx:n}}}),{c(){t=M("div"),E(e.$$.fragment),r=V(),o=M("h1"),o.textContent=a,$=V(),E(c.$$.fragment),this.h()},l(m){t=J(m,"DIV",{class:!0});var f=Z(t);Q(e.$$.fragment,f),r=j(f),o=J(f,"H1",{class:!0,"data-testid":!0,"data-svelte-h":!0}),Me(o)!=="svelte-wf0qpn"&&(o.textContent=a),$=j(f),Q(c.$$.fragment,f),f.forEach(d),this.h()},h(){Y(o,"class","mb-4 overflow-hidden"),Y(o,"data-testid","start-workflow"),Y(t,"class","flex w-full flex-col gap-4 pb-20")},m(m,f){k(m,t,f),P(e,t,null),N(t,r),N(t,o),N(t,$),P(c,t,null),l=!0},p(m,f){const g={};f[0]&24576&&(g.href=`${Ie({namespace:m[13]})}?${m[14]}`),f[1]&1024&&(g.$$scope={dirty:f,ctx:m}),e.$set(g);const _={};f[0]&16383|f[1]&1024&&(_.$$scope={dirty:f,ctx:m}),c.$set(_)},i(m){l||(b(e.$$.fragment,m),b(c.$$.fragment,m),l=!0)},o(m){h(e.$$.fragment,m),h(c.$$.fragment,m),l=!1},d(m){m&&d(t),S(e),S(c)}}}function ht(n,t,e){let r,o,a,$,c,l,m,f=ue,g=()=>(f(),f=Ge(F,i=>e(37,m=i)),F),_;me(n,Ne,i=>e(20,c=i)),me(n,ot,i=>e(36,l=i)),me(n,Ze,i=>e(14,_=i)),n.$$.on_destroy.push(()=>f());let O="",W="",v="",D="",R="",q="",F=Ye("json/plain");g();let u="",w="",C="",U="",L,K=!1,H=[];Ke(()=>{e(0,O=c.url.searchParams.get("workflowId")||""),e(1,W=c.url.searchParams.get("taskQueue")||""),e(2,v=c.url.searchParams.get("workflowType")||""),w=c.url.searchParams.get("workflowId")||"",C=c.url.searchParams.get("workflowType")||"",(w||C)&&$e(w,C)});const oe=async()=>{try{e(8,U="");const{runId:i}=await tt({namespace:r,workflowId:O,taskQueue:W,workflowType:v,input:D,summary:R,details:q,encoding:m,messageType:u,searchAttributes:H});Ee.push({variant:"success",duration:5e3,message:B("workflows.start-workflow-success"),link:Je({namespace:r,workflow:O,run:i})})}catch(i){e(8,U=(i==null?void 0:i.message)||B("workflows.start-workflow-error")),Ee.push({variant:"error",message:B("workflows.start-workflow-error")})}},ce=()=>{e(0,O=ut()),je({parameter:"workflowId",value:O,url:c.url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},fe=async i=>{if(i){const{pollers:z}=await at({namespace:r,queue:i});e(9,L=z.length)}},$e=async(i,z)=>{var X;const A=await xe({namespace:r,workflowId:i,workflowType:z});if(e(3,D=A.input),F.set(A.encoding),e(7,u=A.messageType),e(4,R=A.summary),e(5,q=A.details),A!=null&&A.searchAttributes){const He=Object.keys(l);Object.entries(A.searchAttributes).forEach(([be,ze])=>{He.includes(be)&&e(11,H=[...H,{label:be,value:ze,type:l[be]}])})}(Object.keys((X=A==null?void 0:A.searchAttributes)!==null&&X!==void 0?X:{}).length||A!=null&&A.summary||A!=null&&A.details)&&e(10,K=!0)},te=(i,z)=>{const X=i.target.value;je({parameter:z,value:X,url:c.url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},T=i=>{try{return JSON.parse(i),!0}catch{return!1}};function ge(i){O=i,e(0,O)}const ie=i=>te(i,"workflowId");function de(i){W=i,e(1,W)}const _e=i=>te(i,"taskQueue");function we(i){v=i,e(2,v)}const le=i=>te(i,"workflowType");function I(i){D=i,e(3,D)}function y(i){F=i,g(e(6,F))}function s(i){u=i,e(7,u)}const p=i=>e(4,R=i.detail.value),re=i=>e(5,q=i.detail.value);function G(i){H=i,e(11,H)}const pe=()=>e(10,K=!K);return n.$$.update=()=>{n.$$.dirty[0]&1048576&&e(13,{namespace:r}=c.params,r),n.$$.dirty[0]&1048576&&e(18,o=c.url.searchParams.get("taskQueue")),n.$$.dirty[0]&8&&e(19,a=!D||T(D)),n.$$.dirty[0]&1572871&&e(12,$=!!O&&!!W&&!!v&&!!a&&!lt(c)),n.$$.dirty[0]&262144&&fe(o)},[O,W,v,D,R,q,F,u,U,L,K,H,$,r,_,oe,ce,te,o,a,c,ge,ie,de,_e,we,le,I,y,s,p,re,G,pe]}class kt extends qe{constructor(t){super(),Fe(this,t,ht,bt,Oe,{},null,[-1,-1])}}function vt(n){let t,e,r,o;return t=new Xe({props:{title:"Start Workflow",url:n[0].url.href}}),r=new kt({}),{c(){E(t.$$.fragment),e=V(),E(r.$$.fragment)},l(a){Q(t.$$.fragment,a),e=j(a),Q(r.$$.fragment,a)},m(a,$){P(t,a,$),k(a,e,$),P(r,a,$),o=!0},p(a,[$]){const c={};$&1&&(c.url=a[0].url.href),t.$set(c)},i(a){o||(b(t.$$.fragment,a),b(r.$$.fragment,a),o=!0)},o(a){h(t.$$.fragment,a),h(r.$$.fragment,a),o=!1},d(a){a&&d(e),S(t,a),S(r,a)}}}function Tt(n,t,e){let r;return me(n,Ne,o=>e(0,r=o)),[r]}class Yt extends qe{constructor(t){super(),Fe(this,t,Tt,vt,Oe,{})}}export{Yt as component,Xt as universal};
