import{r as ze}from"../chunks/index.g5YcAAdQ.js";import{e as Te,g as Ae,b as Be}from"../chunks/route-for.BFD8vf3c.js";import{s as Se,O as oe,h as J,b as y,j as M,k as Y,f as k,d as E,o as Je,m as X,i as H,n as w,Q as le,v as ie,c as _e,W as Me,t as re,l as ne,q as Pe,R as Ne}from"../chunks/scheduler.D6mQsyhd.js";import{S as qe,i as Fe,h as ue,c as Q,a as W,m as D,t as $,g as ge,b as g,e as we,d as V}from"../chunks/index.CDeUyeTp.js";import{p as Re}from"../chunks/stores.DwU6oz3m.js";import{P as Ke}from"../chunks/page-title.h9prjCqF.js";import{w as Ge}from"../chunks/entry.BQ8cGLPm.js";import{P as Xe}from"../chunks/payload-input-with-encoding.I5AkVl-x.js";import{A as Ye}from"../chunks/add-search-attributes.C9dA23K9.js";import{A as Le}from"../chunks/alert.VYr5tJfe.js";import{B as ve}from"../chunks/button.UGLzT_XP.js";import{C as Ze}from"../chunks/card.Dif23109.js";import{I as xe}from"../chunks/icon.BRzabkM-.js";import{I as Ie}from"../chunks/input.DnCcjNpF.js";import{L as ye}from"../chunks/label.BalHcG1M.js";import{L as Ue}from"../chunks/link.DXvgWhdX.js";import{E as Ee}from"../chunks/editor.DaTp8NXs.js";import{T as et}from"../chunks/tooltip.Pfwiu_V0.js";import{t as Z}from"../chunks/translate.BBe5dcco.js";import{g as tt}from"../chunks/pollers-service.CIKuzOh8.js";import{c as rt,e as nt,g as st}from"../chunks/workflows.CFhiMVXy.js";import{c as at}from"../chunks/search-attributes.DnnCrqh2.js";import{t as Qe,v as ot}from"../chunks/toaster.D9ISJuF-.js";import{p as We}from"../chunks/format-time.Dn4a2B__.js";import{u as De}from"../chunks/update-query-parameters.CLGLAmwe.js";import{w as lt}from"../chunks/workflow-create-disabled.Bcj22tbh.js";const ut=async function({params:n,parent:e}){if((await e()).settings.startWorkflowDisabled){const{namespace:r}=n;ze(302,Te({namespace:r}))}},Kt=Object.freeze(Object.defineProperty({__proto__:null,load:ut},Symbol.toStringTag,{value:"Module"}));function it(n){let e=Z("workflows.back-to-workflows")+"",t;return{c(){t=re(e)},l(r){t=ne(r,e)},m(r,i){H(r,t,i)},p:ie,d(r){r&&k(t)}}}function ft(n){let e;return{c(){e=re("Random UUID")},l(t){e=ne(t,"Random UUID")},m(t,r){H(t,e,r)},d(t){t&&k(e)}}}function Ve(n){let e,t;return e=new Le({props:{intent:n[9]>0?"success":"warning",title:n[9]?"Task Queue is Active":"Task Queue is Inactive",$$slots:{default:[mt]},$$scope:{ctx:n}}}),{c(){Q(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,i){D(e,r,i),t=!0},p(r,i){const s={};i[0]&512&&(s.intent=r[9]>0?"success":"warning"),i[0]&512&&(s.title=r[9]?"Task Queue is Active":"Task Queue is Inactive"),i[0]&8706|i[1]&512&&(s.$$scope={dirty:i,ctx:r}),e.$set(s)},i(r){t||($(e.$$.fragment,r),t=!0)},o(r){g(e.$$.fragment,r),t=!1},d(r){V(e,r)}}}function pt(n){let e;return{c(){e=re("View Task Queue")},l(t){e=ne(t,"View Task Queue")},m(t,r){H(t,e,r)},d(t){t&&k(e)}}}function mt(n){let e,t,r,i,s=We("Worker",n[9])+"",m,c,o,p;return o=new Ue({props:{href:Ae({namespace:n[13],queue:n[1]}),newTab:!0,$$slots:{default:[pt]},$$scope:{ctx:n}}}),{c(){e=J("div"),t=J("p"),r=re(n[9]),i=y(),m=re(s),c=y(),Q(o.$$.fragment),this.h()},l(f){e=M(f,"DIV",{class:!0});var _=Y(e);t=M(_,"P",{});var T=Y(t);r=ne(T,n[9]),i=E(T),m=ne(T,s),T.forEach(k),c=E(_),W(o.$$.fragment,_),_.forEach(k),this.h()},h(){X(e,"class","flex w-full items-center justify-between")},m(f,_){H(f,e,_),w(e,t),w(t,r),w(t,i),w(t,m),w(e,c),D(o,e,null),p=!0},p(f,_){(!p||_[0]&512)&&Pe(r,f[9]),(!p||_[0]&512)&&s!==(s=We("Worker",f[9])+"")&&Pe(m,s);const T={};_[0]&8194&&(T.href=Ae({namespace:f[13],queue:f[1]})),_[1]&512&&(T.$$scope={dirty:_,ctx:f}),o.$set(T)},i(f){p||($(o.$$.fragment,f),p=!0)},o(f){g(o.$$.fragment,f),p=!1},d(f){f&&k(e),V(o)}}}function je(n){let e,t,r,i;function s(o){n[27](o)}function m(o){n[28](o)}let c={};return n[3]!==void 0&&(c.input=n[3]),n[6]!==void 0&&(c.encoding=n[6]),e=new Xe({props:c}),oe.push(()=>ue(e,"input",s)),oe.push(()=>ue(e,"encoding",m)),{c(){Q(e.$$.fragment)},l(o){W(e.$$.fragment,o)},m(o,p){D(e,o,p),i=!0},p(o,p){const f={};!t&&p[0]&8&&(t=!0,f.input=o[3],le(()=>t=!1)),!r&&p[0]&64&&(r=!0,f.encoding=o[6],le(()=>r=!1)),e.$set(f)},i(o){i||($(e.$$.fragment,o),i=!0)},o(o){g(e.$$.fragment,o),i=!1},d(o){V(e,o)}}}function Ce(n){let e,t,r,i,s;e=new Ze({props:{class:"flex flex-col gap-2",$$slots:{default:[$t]},$$scope:{ctx:n}}});function m(o){n[31](o)}let c={};return n[11]!==void 0&&(c.attributesToAdd=n[11]),r=new Ye({props:c}),oe.push(()=>ue(r,"attributesToAdd",m)),{c(){Q(e.$$.fragment),t=y(),Q(r.$$.fragment)},l(o){W(e.$$.fragment,o),t=E(o),W(r.$$.fragment,o)},m(o,p){D(e,o,p),H(o,t,p),D(r,o,p),s=!0},p(o,p){const f={};p[0]&48|p[1]&512&&(f.$$scope={dirty:p,ctx:o}),e.$set(f);const _={};!i&&p[0]&2048&&(i=!0,_.attributesToAdd=o[11],le(()=>i=!1)),r.$set(_)},i(o){s||($(e.$$.fragment,o),$(r.$$.fragment,o),s=!0)},o(o){g(e.$$.fragment,o),g(r.$$.fragment,o),s=!1},d(o){o&&k(t),V(e,o),V(r,o)}}}function ct(n){let e,t;return e=new xe({props:{name:"info"}}),{c(){Q(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,i){D(e,r,i),t=!0},p:ie,i(r){t||($(e.$$.fragment,r),t=!0)},o(r){g(e.$$.fragment,r),t=!1},d(r){V(e,r)}}}function $t(n){let e,t,r=Z("workflows.user-metadata")+"",i,s,m,c=Z("workflows.markdown-supported")+"",o,p,f,_,T,v,j,C,b,z,O,q;return f=new et({props:{topRight:!0,width:200,text:Z("workflows.markdown-description"),$$slots:{default:[ct]},$$scope:{ctx:n}}}),T=new ye({props:{label:Z("workflows.summary"),for:"summary"}}),j=new Ee({props:{content:n[4],class:"min-h-48"}}),j.$on("change",n[29]),b=new ye({props:{label:Z("workflows.details"),for:"details"}}),O=new Ee({props:{content:n[5]}}),O.$on("change",n[30]),{c(){e=J("div"),t=J("h3"),i=re(r),s=y(),m=J("p"),o=re(c),p=y(),Q(f.$$.fragment),_=y(),Q(T.$$.fragment),v=y(),Q(j.$$.fragment),C=y(),Q(b.$$.fragment),z=y(),Q(O.$$.fragment),this.h()},l(l){e=M(l,"DIV",{class:!0});var h=Y(e);t=M(h,"H3",{});var B=Y(t);i=ne(B,r),B.forEach(k),s=E(h),m=M(h,"P",{class:!0});var R=Y(m);o=ne(R,c),p=E(R),W(f.$$.fragment,R),R.forEach(k),h.forEach(k),_=E(l),W(T.$$.fragment,l),v=E(l),W(j.$$.fragment,l),C=E(l),W(b.$$.fragment,l),z=E(l),W(O.$$.fragment,l),this.h()},h(){X(m,"class","flex items-center gap-1 text-sm text-subtle"),X(e,"class","flex justify-between")},m(l,h){H(l,e,h),w(e,t),w(t,i),w(e,s),w(e,m),w(m,o),w(m,p),D(f,m,null),H(l,_,h),D(T,l,h),H(l,v,h),D(j,l,h),H(l,C,h),D(b,l,h),H(l,z,h),D(O,l,h),q=!0},p(l,h){const B={};h[1]&512&&(B.$$scope={dirty:h,ctx:l}),f.$set(B);const R={};h[0]&16&&(R.content=l[4]),j.$set(R);const x={};h[0]&32&&(x.content=l[5]),O.$set(x)},i(l){q||($(f.$$.fragment,l),$(T.$$.fragment,l),$(j.$$.fragment,l),$(b.$$.fragment,l),$(O.$$.fragment,l),q=!0)},o(l){g(f.$$.fragment,l),g(T.$$.fragment,l),g(j.$$.fragment,l),g(b.$$.fragment,l),g(O.$$.fragment,l),q=!1},d(l){l&&(k(e),k(_),k(v),k(C),k(z)),V(f),V(T,l),V(j,l),V(b,l),V(O,l)}}}function dt(n){let e=Z("common.more-options")+"",t;return{c(){t=re(e)},l(r){t=ne(r,e)},m(r,i){H(r,t,i)},p:ie,d(r){r&&k(t)}}}function gt(n){let e=Z("workflows.start-workflow")+"",t;return{c(){t=re(e)},l(r){t=ne(r,e)},m(r,i){H(r,t,i)},p:ie,d(r){r&&k(t)}}}function Oe(n){let e,t;return e=new Le({props:{intent:"error",title:n[8]}}),{c(){Q(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,i){D(e,r,i),t=!0},p(r,i){const s={};i[0]&256&&(s.title=r[8]),e.$set(s)},i(r){t||($(e.$$.fragment,r),t=!0)},o(r){g(e.$$.fragment,r),t=!1},d(r){V(e,r)}}}function wt(n){let e,t,r,i,s,m,c="Start a Workflow",o,p,f,_,T,v,j,C,b,z,O,q,l,h,B,R=n[7],x,ee,F,N,fe,K,pe,te;r=new Ue({props:{href:`${Te({namespace:n[13]})}?${n[14]}`,"data-testid":"back-to-workflows",icon:"chevron-left",$$slots:{default:[it]},$$scope:{ctx:n}}});function he(u){n[21](u)}let ce={id:"workflowId",required:!0,label:"Workflow ID",class:"w-full grow"};n[0]!==void 0&&(ce.value=n[0]),f=new Ie({props:ce}),oe.push(()=>ue(f,"value",he)),f.$on("blur",n[22]),v=new ve({props:{class:"mt-0 md:mt-6",variant:"secondary",leadingIcon:"retry",$$slots:{default:[ft]},$$scope:{ctx:n}}}),v.$on("click",n[16]);function be(u){n[23](u)}let $e={id:"taskQueue",required:!0,label:"Task Queue",class:"grow"};n[1]!==void 0&&($e.value=n[1]),b=new Ie({props:$e}),oe.push(()=>ue(b,"value",be)),b.$on("blur",n[24]);let S=n[9]!==void 0&&Ve(n);function ke(u){n[25](u)}let de={id:"workflowType",required:!0,label:"Workflow Type"};n[2]!==void 0&&(de.value=n[2]),l=new Ie({props:de}),oe.push(()=>ue(l,"value",ke)),l.$on("blur",n[26]);let L=je(n),A=n[10]&&Ce(n);N=new ve({props:{variant:"ghost",class:"max-sm:w-full",trailingIcon:n[10]?"chevron-up":"chevron-down",$$slots:{default:[dt]},$$scope:{ctx:n}}}),N.$on("click",n[32]),K=new ve({props:{disabled:!n[12],"data-testid":"start-workflow-button",class:"max-sm:w-full",$$slots:{default:[gt]},$$scope:{ctx:n}}}),K.$on("click",n[15]);let P=n[8]&&Oe(n);return{c(){e=J("div"),t=J("div"),Q(r.$$.fragment),i=y(),s=J("div"),m=J("h1"),m.textContent=c,o=y(),p=J("div"),Q(f.$$.fragment),T=y(),Q(v.$$.fragment),j=y(),C=J("div"),Q(b.$$.fragment),O=y(),S&&S.c(),q=y(),Q(l.$$.fragment),B=y(),L.c(),x=y(),A&&A.c(),ee=y(),F=J("div"),Q(N.$$.fragment),fe=y(),Q(K.$$.fragment),pe=y(),P&&P.c(),this.h()},l(u){e=M(u,"DIV",{class:!0});var d=Y(e);t=M(d,"DIV",{class:!0});var se=Y(t);W(r.$$.fragment,se),se.forEach(k),i=E(d),s=M(d,"DIV",{class:!0});var a=Y(s);m=M(a,"H1",{class:!0,"data-testid":!0,"data-svelte-h":!0}),Je(m)!=="svelte-8dv4qj"&&(m.textContent=c),o=E(a),p=M(a,"DIV",{class:!0});var U=Y(p);W(f.$$.fragment,U),T=E(U),W(v.$$.fragment,U),U.forEach(k),j=E(a),C=M(a,"DIV",{class:!0});var G=Y(C);W(b.$$.fragment,G),G.forEach(k),O=E(a),S&&S.l(a),q=E(a),W(l.$$.fragment,a),B=E(a),L.l(a),x=E(a),A&&A.l(a),ee=E(a),F=M(a,"DIV",{class:!0});var I=Y(F);W(N.$$.fragment,I),fe=E(I),W(K.$$.fragment,I),I.forEach(k),pe=E(a),P&&P.l(a),a.forEach(k),d.forEach(k),this.h()},h(){X(t,"class","mb-6 flex w-full items-start"),X(m,"class","mb-4 overflow-hidden"),X(m,"data-testid","start-workflow"),X(p,"class","flex w-full flex-col items-center justify-between gap-2 md:flex-row md:gap-4"),X(C,"class","flex w-full items-center justify-between gap-4"),X(F,"class","mt-4 flex w-full flex-row justify-between gap-4 max-sm:flex-col"),X(s,"class","flex w-full flex-col gap-4 lg:w-2/3 2xl:w-1/2"),X(e,"class","flex w-full flex-col items-center pb-10")},m(u,d){H(u,e,d),w(e,t),D(r,t,null),w(e,i),w(e,s),w(s,m),w(s,o),w(s,p),D(f,p,null),w(p,T),D(v,p,null),w(s,j),w(s,C),D(b,C,null),w(s,O),S&&S.m(s,null),w(s,q),D(l,s,null),w(s,B),L.m(s,null),w(s,x),A&&A.m(s,null),w(s,ee),w(s,F),D(N,F,null),w(F,fe),D(K,F,null),w(s,pe),P&&P.m(s,null),te=!0},p(u,d){const se={};d[0]&24576&&(se.href=`${Te({namespace:u[13]})}?${u[14]}`),d[1]&512&&(se.$$scope={dirty:d,ctx:u}),r.$set(se);const a={};!_&&d[0]&1&&(_=!0,a.value=u[0],le(()=>_=!1)),f.$set(a);const U={};d[1]&512&&(U.$$scope={dirty:d,ctx:u}),v.$set(U);const G={};!z&&d[0]&2&&(z=!0,G.value=u[1],le(()=>z=!1)),b.$set(G),u[9]!==void 0?S?(S.p(u,d),d[0]&512&&$(S,1)):(S=Ve(u),S.c(),$(S,1),S.m(s,q)):S&&(ge(),g(S,1,1,()=>{S=null}),we());const I={};!h&&d[0]&4&&(h=!0,I.value=u[2],le(()=>h=!1)),l.$set(I),d[0]&128&&Se(R,R=u[7])?(ge(),g(L,1,1,ie),we(),L=je(u),L.c(),$(L,1),L.m(s,x)):L.p(u,d),u[10]?A?(A.p(u,d),d[0]&1024&&$(A,1)):(A=Ce(u),A.c(),$(A,1),A.m(s,ee)):A&&(ge(),g(A,1,1,()=>{A=null}),we());const me={};d[0]&1024&&(me.trailingIcon=u[10]?"chevron-up":"chevron-down"),d[1]&512&&(me.$$scope={dirty:d,ctx:u}),N.$set(me);const ae={};d[0]&4096&&(ae.disabled=!u[12]),d[1]&512&&(ae.$$scope={dirty:d,ctx:u}),K.$set(ae),u[8]?P?(P.p(u,d),d[0]&256&&$(P,1)):(P=Oe(u),P.c(),$(P,1),P.m(s,null)):P&&(ge(),g(P,1,1,()=>{P=null}),we())},i(u){te||($(r.$$.fragment,u),$(f.$$.fragment,u),$(v.$$.fragment,u),$(b.$$.fragment,u),$(S),$(l.$$.fragment,u),$(L),$(A),$(N.$$.fragment,u),$(K.$$.fragment,u),$(P),te=!0)},o(u){g(r.$$.fragment,u),g(f.$$.fragment,u),g(v.$$.fragment,u),g(b.$$.fragment,u),g(S),g(l.$$.fragment,u),g(L),g(A),g(N.$$.fragment,u),g(K.$$.fragment,u),g(P),te=!1},d(u){u&&k(e),V(r),V(f),V(v),V(b),S&&S.d(),V(l),L.d(u),A&&A.d(),V(N),V(K),P&&P.d()}}}function _t(n,e,t){let r,i,s,m,c,o,p,f=ie,_=()=>(f(),f=Ne(q,a=>t(36,p=a)),q),T;_e(n,Re,a=>t(20,c=a)),_e(n,at,a=>t(35,o=a)),_e(n,rt,a=>t(14,T=a)),n.$$.on_destroy.push(()=>f());let v="",j="",C="",b="",z="",O="",q=Ge("json/plain");_();let l=0,h="",B="",R="",x,ee=!1,F=[];Me(()=>{t(0,v=c.url.searchParams.get("workflowId")||""),t(1,j=c.url.searchParams.get("taskQueue")||""),t(2,C=c.url.searchParams.get("workflowType")||""),h=c.url.searchParams.get("workflowId")||"",B=c.url.searchParams.get("workflowType")||"",(h||B)&&pe(h,B)});const N=async()=>{try{t(8,R="");const{runId:a}=await st({namespace:r,workflowId:v,taskQueue:j,workflowType:C,input:b,summary:z,details:O,encoding:p,searchAttributes:F});Qe.push({variant:"success",duration:5e3,message:Z("workflows.start-workflow-success"),link:Be({namespace:r,workflow:v,run:a})})}catch(a){t(8,R=(a==null?void 0:a.message)||Z("workflows.start-workflow-error")),Qe.push({variant:"error",message:Z("workflows.start-workflow-error")})}},fe=()=>{t(0,v=ot()),De({parameter:"workflowId",value:v,url:c.url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},K=async a=>{if(a){const{pollers:U}=await tt({namespace:r,queue:a});t(9,x=U.length)}},pe=async(a,U)=>{var G;const I=await nt({namespace:r,workflowId:a,workflowType:U});if(t(3,b=I.input),t(7,l=Date.now()),t(4,z=I.summary),t(5,O=I.details),I!=null&&I.searchAttributes){const me=Object.keys(o);Object.entries(I.searchAttributes).forEach(([ae,He])=>{me.includes(ae)&&t(11,F=[...F,{label:ae,value:He,type:o[ae]}])})}(Object.keys((G=I==null?void 0:I.searchAttributes)!==null&&G!==void 0?G:{}).length||I!=null&&I.summary||I!=null&&I.details)&&t(10,ee=!0)},te=(a,U)=>{const G=a.target.value;De({parameter:U,value:G,url:c.url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},he=a=>{try{return JSON.parse(a),!0}catch{return!1}};function ce(a){v=a,t(0,v)}const be=a=>te(a,"workflowId");function $e(a){j=a,t(1,j)}const S=a=>te(a,"taskQueue");function ke(a){C=a,t(2,C)}const de=a=>te(a,"workflowType");function L(a){b=a,t(3,b)}function A(a){q=a,_(t(6,q))}const P=a=>t(4,z=a.detail.value),u=a=>t(5,O=a.detail.value);function d(a){F=a,t(11,F)}const se=()=>t(10,ee=!ee);return n.$$.update=()=>{n.$$.dirty[0]&1048576&&t(13,{namespace:r}=c.params,r),n.$$.dirty[0]&1048576&&t(18,i=c.url.searchParams.get("taskQueue")),n.$$.dirty[0]&8&&t(19,s=!b||he(b)),n.$$.dirty[0]&1572871&&t(12,m=!!v&&!!j&&!!C&&!!s&&!lt(c)),n.$$.dirty[0]&262144&&K(i)},[v,j,C,b,z,O,q,l,R,x,ee,F,m,r,T,N,fe,te,i,s,c,ce,be,$e,S,ke,de,L,A,P,u,d,se]}class ht extends qe{constructor(e){super(),Fe(this,e,_t,wt,Se,{},null,[-1,-1])}}function bt(n){let e,t,r,i;return e=new Ke({props:{title:"Start Workflow",url:n[0].url.href}}),r=new ht({}),{c(){Q(e.$$.fragment),t=y(),Q(r.$$.fragment)},l(s){W(e.$$.fragment,s),t=E(s),W(r.$$.fragment,s)},m(s,m){D(e,s,m),H(s,t,m),D(r,s,m),i=!0},p(s,[m]){const c={};m&1&&(c.url=s[0].url.href),e.$set(c)},i(s){i||($(e.$$.fragment,s),$(r.$$.fragment,s),i=!0)},o(s){g(e.$$.fragment,s),g(r.$$.fragment,s),i=!1},d(s){s&&k(t),V(e,s),V(r,s)}}}function kt(n,e,t){let r;return _e(n,Re,i=>t(0,r=i)),[r]}class Gt extends qe{constructor(e){super(),Fe(this,e,kt,bt,Se,{})}}export{Gt as component,Kt as universal};
