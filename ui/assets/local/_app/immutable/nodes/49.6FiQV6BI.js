import{r as Me}from"../chunks/index.g5YcAAdQ.js";import{e as he,b as Ke,g as Te}from"../chunks/route-for.BxQOsldy.js";import{s as ve,h as B,b as j,j as J,k as K,d as D,o as Ge,f as _,m as G,i as h,n as R,c as ge,V as Xe,t as X,l as Y,v as ae,O as te,w as Ie,a4 as ne,P as Ye,q as ye}from"../chunks/scheduler.CnYDgCRb.js";import{S as Ce,i as Oe,c as S,a as P,m as Q,t as w,b as k,d as E,h as re,g as $e,e as de}from"../chunks/index.DW7Zsqzm.js";import{p as qe}from"../chunks/stores.DgaAEv8O.js";import{P as Ze}from"../chunks/page-title.DEkRIe-Y.js";import{w as xe}from"../chunks/entry.GR95QYfd.js";import{c as et,e as tt,g as nt,P as rt}from"../chunks/workflows.CtzXfbga.js";import{A as st}from"../chunks/add-search-attributes.Bc0IxbGD.js";import{A as Fe}from"../chunks/alert.BmiNYDVZ.js";import{B as be}from"../chunks/button.CvC5QCzE.js";import{C as Ne}from"../chunks/card.DK3n6meh.js";import{I as at}from"../chunks/icon.BLtYHMSM.js";import{I as ke}from"../chunks/input.6Fjv8Ucz.js";import{L as Ae}from"../chunks/label.DRY4v8k1.js";import{L as Re}from"../chunks/link.CagbL06t.js";import{E as Se}from"../chunks/editor.DBQljA2h.js";import{T as lt}from"../chunks/tooltip.BL0FZrnU.js";import{t as z}from"../chunks/translate.BBe5dcco.js";import{g as ot}from"../chunks/pollers-service.Cw9jCuD3.js";import{c as ut}from"../chunks/search-attributes.Bw_c2a1Z.js";import{t as Pe}from"../chunks/toaster.BXTZD9l8.js";import{p as Qe}from"../chunks/format-time.DHKJZWez.js";import{u as Ee}from"../chunks/update-query-parameters.BSE21-d6.js";import{w as ft}from"../chunks/workflow-create-disabled.CWolSW_J.js";import{v as it}from"../chunks/v4.BOvFkHkt.js";const pt=async function({params:r,parent:t}){var o,l;const e=await t();if(((o=e==null?void 0:e.settings)==null?void 0:o.disableWriteActions)||((l=e==null?void 0:e.settings)==null?void 0:l.startWorkflowDisabled)){const{namespace:g}=r;Me(302,he({namespace:g}))}},Zt=Object.freeze(Object.defineProperty({__proto__:null,load:pt},Symbol.toStringTag,{value:"Module"}));function mt(r){let t=z("workflows.back-to-workflows")+"",e;return{c(){e=X(t)},l(n){e=Y(n,t)},m(n,o){h(n,e,o)},p:ae,d(n){n&&_(e)}}}function ct(r){let t;return{c(){t=X("Random UUID")},l(e){t=Y(e,"Random UUID")},m(e,n){h(e,t,n)},d(e){e&&_(t)}}}function We(r){let t,e;return t=new Fe({props:{intent:r[10]>0?"success":"warning",title:r[10]?"Task Queue is Active":"Task Queue is Inactive",$$slots:{default:[dt]},$$scope:{ctx:r}}}),{c(){S(t.$$.fragment)},l(n){P(t.$$.fragment,n)},m(n,o){Q(t,n,o),e=!0},p(n,o){const l={};o[0]&1024&&(l.intent=n[10]>0?"success":"warning"),o[0]&1024&&(l.title=n[10]?"Task Queue is Active":"Task Queue is Inactive"),o[0]&17410|o[1]&2048&&(l.$$scope={dirty:o,ctx:n}),t.$set(l)},i(n){e||(w(t.$$.fragment,n),e=!0)},o(n){k(t.$$.fragment,n),e=!1},d(n){E(t,n)}}}function $t(r){let t;return{c(){t=X("View Task Queue")},l(e){t=Y(e,"View Task Queue")},m(e,n){h(e,t,n)},d(e){e&&_(t)}}}function dt(r){let t,e,n,o,l=Qe("Worker",r[10])+"",g,m,u,i;return u=new Re({props:{href:Te({namespace:r[14],queue:r[1]}),newTab:!0,$$slots:{default:[$t]},$$scope:{ctx:r}}}),{c(){t=B("div"),e=B("p"),n=X(r[10]),o=j(),g=X(l),m=j(),S(u.$$.fragment),this.h()},l(a){t=J(a,"DIV",{class:!0});var $=K(t);e=J($,"P",{});var d=K(e);n=Y(d,r[10]),o=D(d),g=Y(d,l),d.forEach(_),m=D($),P(u.$$.fragment,$),$.forEach(_),this.h()},h(){G(t,"class","flex w-full items-center justify-between")},m(a,$){h(a,t,$),R(t,e),R(e,n),R(e,o),R(e,g),R(t,m),Q(u,t,null),i=!0},p(a,$){(!i||$[0]&1024)&&ye(n,a[10]),(!i||$[0]&1024)&&l!==(l=Qe("Worker",a[10])+"")&&ye(g,l);const d={};$[0]&16386&&(d.href=Te({namespace:a[14],queue:a[1]})),$[1]&2048&&(d.$$scope={dirty:$,ctx:a}),u.$set(d)},i(a){i||(w(u.$$.fragment,a),i=!0)},o(a){k(u.$$.fragment,a),i=!1},d(a){a&&_(t),E(u)}}}function Ve(r){let t,e,n,o,l;function g(a){r[28](a)}function m(a){r[29](a)}function u(a){r[30](a)}let i={};return r[3]!==void 0&&(i.input=r[3]),r[6]!==void 0&&(i.encoding=r[6]),r[7]!==void 0&&(i.messageType=r[7]),t=new rt({props:i}),te.push(()=>re(t,"input",g)),te.push(()=>re(t,"encoding",m)),te.push(()=>re(t,"messageType",u)),{c(){S(t.$$.fragment)},l(a){P(t.$$.fragment,a)},m(a,$){Q(t,a,$),l=!0},p(a,$){const d={};!e&&$[0]&8&&(e=!0,d.input=a[3],ne(()=>e=!1)),!n&&$[0]&64&&(n=!0,d.encoding=a[6],ne(()=>n=!1)),!o&&$[0]&128&&(o=!0,d.messageType=a[7],ne(()=>o=!1)),t.$set(d)},i(a){l||(w(t.$$.fragment,a),l=!0)},o(a){k(t.$$.fragment,a),l=!1},d(a){E(t,a)}}}function je(r){let t,e,n,o,l;t=new Ne({props:{class:"flex flex-col gap-2",$$slots:{default:[_t]},$$scope:{ctx:r}}});function g(u){r[33](u)}let m={};return r[12]!==void 0&&(m.attributesToAdd=r[12]),n=new st({props:m}),te.push(()=>re(n,"attributesToAdd",g)),{c(){S(t.$$.fragment),e=j(),S(n.$$.fragment)},l(u){P(t.$$.fragment,u),e=D(u),P(n.$$.fragment,u)},m(u,i){Q(t,u,i),h(u,e,i),Q(n,u,i),l=!0},p(u,i){const a={};i[0]&48|i[1]&2048&&(a.$$scope={dirty:i,ctx:u}),t.$set(a);const $={};!o&&i[0]&4096&&(o=!0,$.attributesToAdd=u[12],ne(()=>o=!1)),n.$set($)},i(u){l||(w(t.$$.fragment,u),w(n.$$.fragment,u),l=!0)},o(u){k(t.$$.fragment,u),k(n.$$.fragment,u),l=!1},d(u){u&&_(e),E(t,u),E(n,u)}}}function gt(r){let t,e;return t=new at({props:{name:"info"}}),{c(){S(t.$$.fragment)},l(n){P(t.$$.fragment,n)},m(n,o){Q(t,n,o),e=!0},p:ae,i(n){e||(w(t.$$.fragment,n),e=!0)},o(n){k(t.$$.fragment,n),e=!1},d(n){E(t,n)}}}function _t(r){let t,e,n=z("workflows.user-metadata")+"",o,l,g,m=z("workflows.markdown-supported")+"",u,i,a,$,d,C,W,L,T,N,v,V;return a=new lt({props:{topRight:!0,width:200,text:z("workflows.markdown-description"),$$slots:{default:[gt]},$$scope:{ctx:r}}}),d=new Ae({props:{label:z("workflows.summary"),for:"summary"}}),W=new Se({props:{content:r[4],class:"min-h-48"}}),W.$on("change",r[31]),T=new Ae({props:{label:z("workflows.details"),for:"details"}}),v=new Se({props:{content:r[5]}}),v.$on("change",r[32]),{c(){t=B("div"),e=B("h3"),o=X(n),l=j(),g=B("p"),u=X(m),i=j(),S(a.$$.fragment),$=j(),S(d.$$.fragment),C=j(),S(W.$$.fragment),L=j(),S(T.$$.fragment),N=j(),S(v.$$.fragment),this.h()},l(f){t=J(f,"DIV",{class:!0});var b=K(t);e=J(b,"H3",{});var U=K(e);o=Y(U,n),U.forEach(_),l=D(b),g=J(b,"P",{class:!0});var O=K(g);u=Y(O,m),i=D(O),P(a.$$.fragment,O),O.forEach(_),b.forEach(_),$=D(f),P(d.$$.fragment,f),C=D(f),P(W.$$.fragment,f),L=D(f),P(T.$$.fragment,f),N=D(f),P(v.$$.fragment,f),this.h()},h(){G(g,"class","flex items-center gap-1 text-sm text-subtle"),G(t,"class","flex flex-wrap justify-between")},m(f,b){h(f,t,b),R(t,e),R(e,o),R(t,l),R(t,g),R(g,u),R(g,i),Q(a,g,null),h(f,$,b),Q(d,f,b),h(f,C,b),Q(W,f,b),h(f,L,b),Q(T,f,b),h(f,N,b),Q(v,f,b),V=!0},p(f,b){const U={};b[1]&2048&&(U.$$scope={dirty:b,ctx:f}),a.$set(U);const O={};b[0]&16&&(O.content=f[4]),W.$set(O);const H={};b[0]&32&&(H.content=f[5]),v.$set(H)},i(f){V||(w(a.$$.fragment,f),w(d.$$.fragment,f),w(W.$$.fragment,f),w(T.$$.fragment,f),w(v.$$.fragment,f),V=!0)},o(f){k(a.$$.fragment,f),k(d.$$.fragment,f),k(W.$$.fragment,f),k(T.$$.fragment,f),k(v.$$.fragment,f),V=!1},d(f){f&&(_(t),_($),_(C),_(L),_(N)),E(a),E(d,f),E(W,f),E(T,f),E(v,f)}}}function wt(r){let t=z("common.more-options")+"",e;return{c(){e=X(t)},l(n){e=Y(n,t)},m(n,o){h(n,e,o)},p:ae,d(n){n&&_(e)}}}function bt(r){let t=z("workflows.start-workflow")+"",e;return{c(){e=X(t)},l(n){e=Y(n,t)},m(n,o){h(n,e,o)},p:ae,d(n){n&&_(e)}}}function De(r){let t,e;return t=new Fe({props:{intent:"error",title:r[9]}}),{c(){S(t.$$.fragment)},l(n){P(t.$$.fragment,n)},m(n,o){Q(t,n,o),e=!0},p(n,o){const l={};o[0]&512&&(l.title=n[9]),t.$set(l)},i(n){e||(w(t.$$.fragment,n),e=!0)},o(n){k(t.$$.fragment,n),e=!1},d(n){E(t,n)}}}function kt(r){let t,e,n,o,l,g,m,u,i,a,$,d,C,W,L=r[8],T,N,v,V,f,b,U,O,H;function fe(s){r[22](s)}let x={id:"workflowId",required:!0,label:"Workflow ID",class:"w-full grow"};r[0]!==void 0&&(x.value=r[0]),e=new ke({props:x}),te.push(()=>re(e,"value",fe)),e.$on("blur",r[23]),l=new be({props:{class:"mt-0 md:mt-6",variant:"secondary",leadingIcon:"retry",$$slots:{default:[ct]},$$scope:{ctx:r}}}),l.$on("click",r[17]);function Z(s){r[24](s)}let ie={id:"taskQueue",required:!0,label:"Task Queue",class:"grow"};r[1]!==void 0&&(ie.value=r[1]),u=new ke({props:ie}),te.push(()=>re(u,"value",Z)),u.$on("blur",r[25]);let I=r[10]!==void 0&&We(r);function _e(s){r[26](s)}let pe={id:"workflowType",required:!0,label:"Workflow Type"};r[2]!==void 0&&(pe.value=r[2]),d=new ke({props:pe}),te.push(()=>re(d,"value",_e)),d.$on("blur",r[27]);let F=Ve(r),y=r[11]&&je(r);V=new be({props:{variant:"ghost",class:"max-sm:w-full",trailingIcon:r[11]?"chevron-up":"chevron-down",$$slots:{default:[wt]},$$scope:{ctx:r}}}),V.$on("click",r[34]),b=new be({props:{disabled:!r[13],"data-testid":"start-workflow-button",class:"max-sm:w-full",$$slots:{default:[bt]},$$scope:{ctx:r}}}),b.$on("click",r[16]);let A=r[9]&&De(r);return{c(){t=B("div"),S(e.$$.fragment),o=j(),S(l.$$.fragment),g=j(),m=B("div"),S(u.$$.fragment),a=j(),I&&I.c(),$=j(),S(d.$$.fragment),W=j(),F.c(),T=j(),y&&y.c(),N=j(),v=B("div"),S(V.$$.fragment),f=j(),S(b.$$.fragment),U=j(),A&&A.c(),O=Ie(),this.h()},l(s){t=J(s,"DIV",{class:!0});var c=K(t);P(e.$$.fragment,c),o=D(c),P(l.$$.fragment,c),c.forEach(_),g=D(s),m=J(s,"DIV",{class:!0});var ee=K(m);P(u.$$.fragment,ee),ee.forEach(_),a=D(s),I&&I.l(s),$=D(s),P(d.$$.fragment,s),W=D(s),F.l(s),T=D(s),y&&y.l(s),N=D(s),v=J(s,"DIV",{class:!0});var M=K(v);P(V.$$.fragment,M),f=D(M),P(b.$$.fragment,M),M.forEach(_),U=D(s),A&&A.l(s),O=Ie(),this.h()},h(){G(t,"class","flex w-full flex-col justify-between gap-2 sm:items-center md:flex-row md:gap-4"),G(m,"class","flex w-full items-center justify-between gap-4"),G(v,"class","mt-4 flex w-full flex-row justify-between gap-4 max-sm:flex-col")},m(s,c){h(s,t,c),Q(e,t,null),R(t,o),Q(l,t,null),h(s,g,c),h(s,m,c),Q(u,m,null),h(s,a,c),I&&I.m(s,c),h(s,$,c),Q(d,s,c),h(s,W,c),F.m(s,c),h(s,T,c),y&&y.m(s,c),h(s,N,c),h(s,v,c),Q(V,v,null),R(v,f),Q(b,v,null),h(s,U,c),A&&A.m(s,c),h(s,O,c),H=!0},p(s,c){const ee={};!n&&c[0]&1&&(n=!0,ee.value=s[0],ne(()=>n=!1)),e.$set(ee);const M={};c[1]&2048&&(M.$$scope={dirty:c,ctx:s}),l.$set(M);const me={};!i&&c[0]&2&&(i=!0,me.value=s[1],ne(()=>i=!1)),u.$set(me),s[10]!==void 0?I?(I.p(s,c),c[0]&1024&&w(I,1)):(I=We(s),I.c(),w(I,1),I.m($.parentNode,$)):I&&($e(),k(I,1,1,()=>{I=null}),de());const ce={};!C&&c[0]&4&&(C=!0,ce.value=s[2],ne(()=>C=!1)),d.$set(ce),c[0]&256&&ve(L,L=s[8])?($e(),k(F,1,1,ae),de(),F=Ve(s),F.c(),w(F,1),F.m(T.parentNode,T)):F.p(s,c),s[11]?y?(y.p(s,c),c[0]&2048&&w(y,1)):(y=je(s),y.c(),w(y,1),y.m(N.parentNode,N)):y&&($e(),k(y,1,1,()=>{y=null}),de());const le={};c[0]&2048&&(le.trailingIcon=s[11]?"chevron-up":"chevron-down"),c[1]&2048&&(le.$$scope={dirty:c,ctx:s}),V.$set(le);const oe={};c[0]&8192&&(oe.disabled=!s[13]),c[1]&2048&&(oe.$$scope={dirty:c,ctx:s}),b.$set(oe),s[9]?A?(A.p(s,c),c[0]&512&&w(A,1)):(A=De(s),A.c(),w(A,1),A.m(O.parentNode,O)):A&&($e(),k(A,1,1,()=>{A=null}),de())},i(s){H||(w(e.$$.fragment,s),w(l.$$.fragment,s),w(u.$$.fragment,s),w(I),w(d.$$.fragment,s),w(F),w(y),w(V.$$.fragment,s),w(b.$$.fragment,s),w(A),H=!0)},o(s){k(e.$$.fragment,s),k(l.$$.fragment,s),k(u.$$.fragment,s),k(I),k(d.$$.fragment,s),k(F),k(y),k(V.$$.fragment,s),k(b.$$.fragment,s),k(A),H=!1},d(s){s&&(_(t),_(g),_(m),_(a),_($),_(W),_(T),_(N),_(v),_(U),_(O)),E(e),E(l),E(u),I&&I.d(s),E(d,s),F.d(s),y&&y.d(s),E(V),E(b),A&&A.d(s)}}}function ht(r){let t,e,n,o,l="Start a Workflow",g,m,u;return e=new Re({props:{href:`${he({namespace:r[14]})}?${r[15]}`,"data-testid":"back-to-workflows",icon:"chevron-left",$$slots:{default:[mt]},$$scope:{ctx:r}}}),m=new Ne({props:{class:"flex w-full flex-col gap-4 xl:w-3/4 2xl:w-1/2",$$slots:{default:[kt]},$$scope:{ctx:r}}}),{c(){t=B("div"),S(e.$$.fragment),n=j(),o=B("h1"),o.textContent=l,g=j(),S(m.$$.fragment),this.h()},l(i){t=J(i,"DIV",{class:!0});var a=K(t);P(e.$$.fragment,a),n=D(a),o=J(a,"H1",{class:!0,"data-testid":!0,"data-svelte-h":!0}),Ge(o)!=="svelte-wf0qpn"&&(o.textContent=l),g=D(a),P(m.$$.fragment,a),a.forEach(_),this.h()},h(){G(o,"class","mb-4 overflow-hidden"),G(o,"data-testid","start-workflow"),G(t,"class","flex w-full flex-col gap-4 pb-20")},m(i,a){h(i,t,a),Q(e,t,null),R(t,n),R(t,o),R(t,g),Q(m,t,null),u=!0},p(i,a){const $={};a[0]&49152&&($.href=`${he({namespace:i[14]})}?${i[15]}`),a[1]&2048&&($.$$scope={dirty:a,ctx:i}),e.$set($);const d={};a[0]&32767|a[1]&2048&&(d.$$scope={dirty:a,ctx:i}),m.$set(d)},i(i){u||(w(e.$$.fragment,i),w(m.$$.fragment,i),u=!0)},o(i){k(e.$$.fragment,i),k(m.$$.fragment,i),u=!1},d(i){i&&_(t),E(e),E(m)}}}function vt(r,t,e){let n,o,l,g,m,u,i,a=ae,$=()=>(a(),a=Ye(V,p=>e(38,i=p)),V),d;ge(r,qe,p=>e(21,m=p)),ge(r,ut,p=>e(37,u=p)),ge(r,et,p=>e(15,d=p)),r.$$.on_destroy.push(()=>a());let C="",W="",L="",T="",N="",v="",V=xe("json/plain");$();let f="",b=0,U="",O="",H="",fe,x=!1,Z=[];Xe(()=>{e(0,C=m.url.searchParams.get("workflowId")||""),e(1,W=m.url.searchParams.get("taskQueue")||""),e(2,L=m.url.searchParams.get("workflowType")||""),U=m.url.searchParams.get("workflowId")||"",O=m.url.searchParams.get("workflowType")||"",(U||O)&&pe(U,O)});const ie=async()=>{try{e(9,H="");const{runId:p}=await nt({namespace:n,workflowId:C,taskQueue:W,workflowType:L,input:T,summary:N,details:v,encoding:i,messageType:f,searchAttributes:Z});Pe.push({variant:"success",duration:5e3,message:z("workflows.start-workflow-success"),link:Ke({namespace:n,workflow:C,run:p})})}catch(p){e(9,H=(p==null?void 0:p.message)||z("workflows.start-workflow-error")),Pe.push({variant:"error",message:z("workflows.start-workflow-error")})}},I=()=>{e(0,C=it()),Ee({parameter:"workflowId",value:C,url:m.url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},_e=async p=>{if(p){const{pollers:se}=await ot({namespace:n,queue:p});e(10,fe=se.length)}},pe=async(p,se)=>{var ue;const q=await tt({namespace:n,workflowId:p,workflowType:se});if(e(3,T=q.input),V.set(q.encoding),e(7,f=q.messageType),e(8,b=Date.now()),e(4,N=q.summary),e(5,v=q.details),q!=null&&q.searchAttributes){const Be=Object.keys(u);Object.entries(q.searchAttributes).forEach(([we,Je])=>{Be.includes(we)&&e(12,Z=[...Z,{label:we,value:Je,type:u[we]}])})}(Object.keys((ue=q==null?void 0:q.searchAttributes)!==null&&ue!==void 0?ue:{}).length||q!=null&&q.summary||q!=null&&q.details)&&e(11,x=!0)},F=(p,se)=>{const ue=p.target.value;Ee({parameter:se,value:ue,url:m.url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},y=p=>{try{return JSON.parse(p),!0}catch{return!1}};function A(p){C=p,e(0,C)}const s=p=>F(p,"workflowId");function c(p){W=p,e(1,W)}const ee=p=>F(p,"taskQueue");function M(p){L=p,e(2,L)}const me=p=>F(p,"workflowType");function ce(p){T=p,e(3,T)}function le(p){V=p,$(e(6,V))}function oe(p){f=p,e(7,f)}const Le=p=>e(4,N=p.detail.value),Ue=p=>e(5,v=p.detail.value);function He(p){Z=p,e(12,Z)}const ze=()=>e(11,x=!x);return r.$$.update=()=>{r.$$.dirty[0]&2097152&&e(14,{namespace:n}=m.params,n),r.$$.dirty[0]&2097152&&e(19,o=m.url.searchParams.get("taskQueue")),r.$$.dirty[0]&8&&e(20,l=!T||y(T)),r.$$.dirty[0]&3145735&&e(13,g=!!C&&!!W&&!!L&&!!l&&!ft(m)),r.$$.dirty[0]&524288&&_e(o)},[C,W,L,T,N,v,V,f,b,H,fe,x,Z,g,n,d,ie,I,F,o,l,m,A,s,c,ee,M,me,ce,le,oe,Le,Ue,He,ze]}class Tt extends Ce{constructor(t){super(),Oe(this,t,vt,ht,ve,{},null,[-1,-1])}}function It(r){let t,e,n,o;return t=new Ze({props:{title:"Start Workflow",url:r[0].url.href}}),n=new Tt({}),{c(){S(t.$$.fragment),e=j(),S(n.$$.fragment)},l(l){P(t.$$.fragment,l),e=D(l),P(n.$$.fragment,l)},m(l,g){Q(t,l,g),h(l,e,g),Q(n,l,g),o=!0},p(l,[g]){const m={};g&1&&(m.url=l[0].url.href),t.$set(m)},i(l){o||(w(t.$$.fragment,l),w(n.$$.fragment,l),o=!0)},o(l){k(t.$$.fragment,l),k(n.$$.fragment,l),o=!1},d(l){l&&_(e),E(t,l),E(n,l)}}}function yt(r,t,e){let n;return ge(r,qe,o=>e(0,n=o)),[n]}class xt extends Ce{constructor(t){super(),Oe(this,t,yt,It,ve,{})}}export{xt as component,Zt as universal};
