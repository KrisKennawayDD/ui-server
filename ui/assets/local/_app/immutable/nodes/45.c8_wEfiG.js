import{r as Ue}from"../chunks/index.g5YcAAdQ.js";import{e as Te,g as Ae,b as Ne}from"../chunks/route-for.uDSvrXFl.js";import{s as Se,N as ne,h as z,b as y,j as B,k as L,f as I,d as Q,o as ze,m as N,i as M,n as $,O as ae,v as fe,c as _e,V as Be,t as Y,l as Z,q as Pe,P as He}from"../chunks/scheduler.C46pS-76.js";import{S as Oe,i as qe,f as se,c as V,a as W,m as D,t as m,g as de,b as h,e as ge,d as E}from"../chunks/index.Bc0Rl-S2.js";import{p as Ce}from"../chunks/stores.B9baqaLW.js";import{P as Je}from"../chunks/page-title.BWHZi6z6.js";import{w as Le}from"../chunks/entry.CTitIrOR.js";import{P as Me}from"../chunks/payload-input-with-encoding.f9PmepJd.js";import{A as Ke}from"../chunks/add-search-attributes.1TErbQV4.js";import{A as Fe}from"../chunks/alert.BOY8lKtw.js";import{B as ve}from"../chunks/button.C4p_yu7W.js";import{I as Ie}from"../chunks/input.Dbx2iVP0.js";import{L as Re}from"../chunks/link.B9b41kdJ.js";import{t as oe}from"../chunks/translate.BBe5dcco.js";import{g as Ge}from"../chunks/pollers-service.Bc_Cjjo0.js";import{c as Xe,e as Ye,g as Ze}from"../chunks/workflows.CzfBlm1i.js";import{c as xe}from"../chunks/search-attributes.vgCDTRcV.js";import{t as ye,v as et}from"../chunks/toaster.t5-1zJgZ.js";import{p as Qe}from"../chunks/format-time.6TuExJAg.js";import{u as Ve}from"../chunks/update-query-parameters.S1ucSGyd.js";import{w as tt}from"../chunks/workflow-create-disabled.DIgdjY0t.js";const rt=async function({params:n,parent:e}){if((await e()).settings.startWorkflowDisabled){const{namespace:r}=n;Ue(302,Te({namespace:r}))}},Ot=Object.freeze(Object.defineProperty({__proto__:null,load:rt},Symbol.toStringTag,{value:"Module"}));function nt(n){let e=oe("workflows.back-to-workflows")+"",t;return{c(){t=Y(e)},l(r){t=Z(r,e)},m(r,l){M(r,t,l)},p:fe,d(r){r&&I(t)}}}function at(n){let e;return{c(){e=Y("Random UUID")},l(t){e=Z(t,"Random UUID")},m(t,r){M(t,e,r)},d(t){t&&I(e)}}}function We(n){let e,t;return e=new Fe({props:{intent:n[7]>0?"success":"warning",title:n[7]?"Task Queue is Active":"Task Queue is Inactive",$$slots:{default:[ot]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,l){D(e,r,l),t=!0},p(r,l){const a={};l[0]&128&&(a.intent=r[7]>0?"success":"warning"),l[0]&128&&(a.title=r[7]?"Task Queue is Active":"Task Queue is Inactive"),l[0]&2178|l[1]&32&&(a.$$scope={dirty:l,ctx:r}),e.$set(a)},i(r){t||(m(e.$$.fragment,r),t=!0)},o(r){h(e.$$.fragment,r),t=!1},d(r){E(e,r)}}}function st(n){let e;return{c(){e=Y("View Task Queue")},l(t){e=Z(t,"View Task Queue")},m(t,r){M(t,e,r)},d(t){t&&I(e)}}}function ot(n){let e,t,r,l,a=Qe("Worker",n[7])+"",u,p,f,g;return f=new Re({props:{href:Ae({namespace:n[11],queue:n[1]}),newTab:!0,$$slots:{default:[st]},$$scope:{ctx:n}}}),{c(){e=z("div"),t=z("p"),r=Y(n[7]),l=y(),u=Y(a),p=y(),V(f.$$.fragment),this.h()},l(c){e=B(c,"DIV",{class:!0});var k=L(e);t=B(k,"P",{});var T=L(t);r=Z(T,n[7]),l=Q(T),u=Z(T,a),T.forEach(I),p=Q(k),W(f.$$.fragment,k),k.forEach(I),this.h()},h(){N(e,"class","flex w-full items-center justify-between")},m(c,k){M(c,e,k),$(e,t),$(t,r),$(t,l),$(t,u),$(e,p),D(f,e,null),g=!0},p(c,k){(!g||k[0]&128)&&Pe(r,c[7]),(!g||k[0]&128)&&a!==(a=Qe("Worker",c[7])+"")&&Pe(u,a);const T={};k[0]&2050&&(T.href=Ae({namespace:c[11],queue:c[1]})),k[1]&32&&(T.$$scope={dirty:k,ctx:c}),f.$set(T)},i(c){g||(m(f.$$.fragment,c),g=!0)},o(c){h(f.$$.fragment,c),g=!1},d(c){c&&I(e),E(f)}}}function De(n){let e,t,r,l;function a(f){n[25](f)}function u(f){n[26](f)}let p={};return n[3]!==void 0&&(p.input=n[3]),n[4]!==void 0&&(p.encoding=n[4]),e=new Me({props:p}),ne.push(()=>se(e,"input",a)),ne.push(()=>se(e,"encoding",u)),{c(){V(e.$$.fragment)},l(f){W(e.$$.fragment,f)},m(f,g){D(e,f,g),l=!0},p(f,g){const c={};!t&&g[0]&8&&(t=!0,c.input=f[3],ae(()=>t=!1)),!r&&g[0]&16&&(r=!0,c.encoding=f[4],ae(()=>r=!1)),e.$set(c)},i(f){l||(m(e.$$.fragment,f),l=!0)},o(f){h(e.$$.fragment,f),l=!1},d(f){E(e,f)}}}function Ee(n){let e,t,r;function l(u){n[27](u)}let a={};return n[9]!==void 0&&(a.attributesToAdd=n[9]),e=new Ke({props:a}),ne.push(()=>se(e,"attributesToAdd",l)),{c(){V(e.$$.fragment)},l(u){W(e.$$.fragment,u)},m(u,p){D(e,u,p),r=!0},p(u,p){const f={};!t&&p[0]&512&&(t=!0,f.attributesToAdd=u[9],ae(()=>t=!1)),e.$set(f)},i(u){r||(m(e.$$.fragment,u),r=!0)},o(u){h(e.$$.fragment,u),r=!1},d(u){E(e,u)}}}function lt(n){let e=oe("common.more-options")+"",t;return{c(){t=Y(e)},l(r){t=Z(r,e)},m(r,l){M(r,t,l)},p:fe,d(r){r&&I(t)}}}function ut(n){let e=oe("workflows.start-workflow")+"",t;return{c(){t=Y(e)},l(r){t=Z(r,e)},m(r,l){M(r,t,l)},p:fe,d(r){r&&I(t)}}}function je(n){let e,t;return e=new Fe({props:{intent:"error",title:n[6]}}),{c(){V(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,l){D(e,r,l),t=!0},p(r,l){const a={};l[0]&64&&(a.title=r[6]),e.$set(a)},i(r){t||(m(e.$$.fragment,r),t=!0)},o(r){h(e.$$.fragment,r),t=!1},d(r){E(e,r)}}}function it(n){let e,t,r,l,a,u,p="Start a Workflow",f,g,c,k,T,b,C,j,v,R,x,H,S,K,ee,G=n[5],O,te,F,q,le,A,ue,re;r=new Re({props:{href:`${Te({namespace:n[11]})}?${n[12]}`,"data-testid":"back-to-workflows",icon:"chevron-left",$$slots:{default:[nt]},$$scope:{ctx:n}}});function we(o){n[19](o)}let ce={id:"workflowId",required:!0,label:"Workflow ID",class:"w-full grow"};n[0]!==void 0&&(ce.value=n[0]),c=new Ie({props:ce}),ne.push(()=>se(c,"value",we)),c.$on("blur",n[20]),b=new ve({props:{class:"mt-0 md:mt-6",variant:"secondary",leadingIcon:"retry",$$slots:{default:[at]},$$scope:{ctx:n}}}),b.$on("click",n[14]);function $e(o){n[21](o)}let pe={id:"taskQueue",required:!0,label:"Task Queue",class:"grow"};n[1]!==void 0&&(pe.value=n[1]),v=new Ie({props:pe}),ne.push(()=>se(v,"value",$e)),v.$on("blur",n[22]);let _=n[7]!==void 0&&We(n);function he(o){n[23](o)}let me={id:"workflowType",required:!0,label:"Workflow Type"};n[2]!==void 0&&(me.value=n[2]),S=new Ie({props:me}),ne.push(()=>se(S,"value",he)),S.$on("blur",n[24]);let P=De(n),w=n[8]&&Ee(n);q=new ve({props:{variant:"ghost",trailingIcon:n[8]?"chevron-up":"chevron-down",$$slots:{default:[lt]},$$scope:{ctx:n}}}),q.$on("click",n[28]),A=new ve({props:{disabled:!n[10],"data-testid":"start-workflow-button",$$slots:{default:[ut]},$$scope:{ctx:n}}}),A.$on("click",n[13]);let s=n[6]&&je(n);return{c(){e=z("div"),t=z("div"),V(r.$$.fragment),l=y(),a=z("div"),u=z("h1"),u.textContent=p,f=y(),g=z("div"),V(c.$$.fragment),T=y(),V(b.$$.fragment),C=y(),j=z("div"),V(v.$$.fragment),x=y(),_&&_.c(),H=y(),V(S.$$.fragment),ee=y(),P.c(),O=y(),w&&w.c(),te=y(),F=z("div"),V(q.$$.fragment),le=y(),V(A.$$.fragment),ue=y(),s&&s.c(),this.h()},l(o){e=B(o,"DIV",{class:!0});var i=L(e);t=B(i,"DIV",{class:!0});var J=L(t);W(r.$$.fragment,J),J.forEach(I),l=Q(i),a=B(i,"DIV",{class:!0});var d=L(a);u=B(d,"H1",{class:!0,"data-testid":!0,"data-svelte-h":!0}),ze(u)!=="svelte-8dv4qj"&&(u.textContent=p),f=Q(d),g=B(d,"DIV",{class:!0});var U=L(g);W(c.$$.fragment,U),T=Q(U),W(b.$$.fragment,U),U.forEach(I),C=Q(d),j=B(d,"DIV",{class:!0});var ie=L(j);W(v.$$.fragment,ie),ie.forEach(I),x=Q(d),_&&_.l(d),H=Q(d),W(S.$$.fragment,d),ee=Q(d),P.l(d),O=Q(d),w&&w.l(d),te=Q(d),F=B(d,"DIV",{class:!0});var X=L(F);W(q.$$.fragment,X),le=Q(X),W(A.$$.fragment,X),X.forEach(I),ue=Q(d),s&&s.l(d),d.forEach(I),i.forEach(I),this.h()},h(){N(t,"class","mb-6 flex w-full items-start"),N(u,"class","mb-4 overflow-hidden"),N(u,"data-testid","start-workflow"),N(g,"class","flex w-full flex-col items-center justify-between gap-2 md:flex-row md:gap-4"),N(j,"class","flex w-full items-center justify-between gap-4"),N(F,"class","mt-4 flex w-full justify-between"),N(a,"class","flex w-full flex-col gap-4 lg:w-2/3 2xl:w-1/2"),N(e,"class","flex w-full flex-col items-center pb-24")},m(o,i){M(o,e,i),$(e,t),D(r,t,null),$(e,l),$(e,a),$(a,u),$(a,f),$(a,g),D(c,g,null),$(g,T),D(b,g,null),$(a,C),$(a,j),D(v,j,null),$(a,x),_&&_.m(a,null),$(a,H),D(S,a,null),$(a,ee),P.m(a,null),$(a,O),w&&w.m(a,null),$(a,te),$(a,F),D(q,F,null),$(F,le),D(A,F,null),$(a,ue),s&&s.m(a,null),re=!0},p(o,i){const J={};i[0]&6144&&(J.href=`${Te({namespace:o[11]})}?${o[12]}`),i[1]&32&&(J.$$scope={dirty:i,ctx:o}),r.$set(J);const d={};!k&&i[0]&1&&(k=!0,d.value=o[0],ae(()=>k=!1)),c.$set(d);const U={};i[1]&32&&(U.$$scope={dirty:i,ctx:o}),b.$set(U);const ie={};!R&&i[0]&2&&(R=!0,ie.value=o[1],ae(()=>R=!1)),v.$set(ie),o[7]!==void 0?_?(_.p(o,i),i[0]&128&&m(_,1)):(_=We(o),_.c(),m(_,1),_.m(a,H)):_&&(de(),h(_,1,1,()=>{_=null}),ge());const X={};!K&&i[0]&4&&(K=!0,X.value=o[2],ae(()=>K=!1)),S.$set(X),i[0]&32&&Se(G,G=o[5])?(de(),h(P,1,1,fe),ge(),P=De(o),P.c(),m(P,1),P.m(a,O)):P.p(o,i),o[8]?w?(w.p(o,i),i[0]&256&&m(w,1)):(w=Ee(o),w.c(),m(w,1),w.m(a,te)):w&&(de(),h(w,1,1,()=>{w=null}),ge());const ke={};i[0]&256&&(ke.trailingIcon=o[8]?"chevron-up":"chevron-down"),i[1]&32&&(ke.$$scope={dirty:i,ctx:o}),q.$set(ke);const be={};i[0]&1024&&(be.disabled=!o[10]),i[1]&32&&(be.$$scope={dirty:i,ctx:o}),A.$set(be),o[6]?s?(s.p(o,i),i[0]&64&&m(s,1)):(s=je(o),s.c(),m(s,1),s.m(a,null)):s&&(de(),h(s,1,1,()=>{s=null}),ge())},i(o){re||(m(r.$$.fragment,o),m(c.$$.fragment,o),m(b.$$.fragment,o),m(v.$$.fragment,o),m(_),m(S.$$.fragment,o),m(P),m(w),m(q.$$.fragment,o),m(A.$$.fragment,o),m(s),re=!0)},o(o){h(r.$$.fragment,o),h(c.$$.fragment,o),h(b.$$.fragment,o),h(v.$$.fragment,o),h(_),h(S.$$.fragment,o),h(P),h(w),h(q.$$.fragment,o),h(A.$$.fragment,o),h(s),re=!1},d(o){o&&I(e),E(r),E(c),E(b),E(v),_&&_.d(),E(S),P.d(o),w&&w.d(),E(q),E(A),s&&s.d()}}}function ft(n,e,t){let r,l,a,u,p,f,g,c=fe,k=()=>(c(),c=He(R,s=>t(32,g=s)),R),T;_e(n,Ce,s=>t(18,p=s)),_e(n,xe,s=>t(31,f=s)),_e(n,Xe,s=>t(12,T=s)),n.$$.on_destroy.push(()=>c());let b="",C="",j="",v="",R=Le("json/plain");k();let x=0,H="",S="",K="",ee,G=!1,O=[];Be(()=>{t(0,b=p.url.searchParams.get("workflowId")||""),t(1,C=p.url.searchParams.get("taskQueue")||""),t(2,j=p.url.searchParams.get("workflowType")||""),H=p.url.searchParams.get("workflowId")||"",S=p.url.searchParams.get("workflowType")||"",(H||S)&&le(H,S)});const te=async()=>{try{t(6,K="");const{runId:s}=await Ze({namespace:r,workflowId:b,taskQueue:C,workflowType:j,input:v,encoding:g,searchAttributes:O});ye.push({variant:"success",duration:5e3,message:oe("workflows.start-workflow-success"),link:Ne({namespace:r,workflow:b,run:s})})}catch(s){t(6,K=(s==null?void 0:s.message)||oe("workflows.start-workflow-error")),ye.push({variant:"error",message:oe("workflows.start-workflow-error")})}},F=()=>{t(0,b=et()),Ve({parameter:"workflowId",value:b,url:p.url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},q=async s=>{if(s){const{pollers:o}=await Ge({namespace:r,queue:s});t(7,ee=o.length)}},le=async(s,o)=>{const i=await Ye({namespace:r,workflowId:s,workflowType:o});if(t(3,v=i.input),t(5,x=Date.now()),i!=null&&i.searchAttributes){const J=Object.keys(f);Object.entries(i.searchAttributes).forEach(([d,U])=>{J.includes(d)&&t(9,O=[...O,{attribute:d,value:String(U)}])}),t(8,G=!0)}},A=(s,o)=>{const i=s.target.value;Ve({parameter:o,value:i,url:p.url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},ue=s=>{try{return JSON.parse(s),!0}catch{return!1}};function re(s){b=s,t(0,b)}const we=s=>A(s,"workflowId");function ce(s){C=s,t(1,C)}const $e=s=>A(s,"taskQueue");function pe(s){j=s,t(2,j)}const _=s=>A(s,"workflowType");function he(s){v=s,t(3,v)}function me(s){R=s,k(t(4,R))}function P(s){O=s,t(9,O)}const w=()=>t(8,G=!G);return n.$$.update=()=>{n.$$.dirty[0]&262144&&t(11,{namespace:r}=p.params,r),n.$$.dirty[0]&262144&&t(16,l=p.url.searchParams.get("taskQueue")),n.$$.dirty[0]&8&&t(17,a=!v||ue(v)),n.$$.dirty[0]&393223&&t(10,u=!!b&&!!C&&!!j&&!!a&&!tt(p)),n.$$.dirty[0]&65536&&q(l)},[b,C,j,v,R,x,K,ee,G,O,u,r,T,te,F,A,l,a,p,re,we,ce,$e,pe,_,he,me,P,w]}class ct extends Oe{constructor(e){super(),qe(this,e,ft,it,Se,{},null,[-1,-1])}}function pt(n){let e,t,r,l;return e=new Je({props:{title:"Start Workflow",url:n[0].url.href}}),r=new ct({}),{c(){V(e.$$.fragment),t=y(),V(r.$$.fragment)},l(a){W(e.$$.fragment,a),t=Q(a),W(r.$$.fragment,a)},m(a,u){D(e,a,u),M(a,t,u),D(r,a,u),l=!0},p(a,[u]){const p={};u&1&&(p.url=a[0].url.href),e.$set(p)},i(a){l||(m(e.$$.fragment,a),m(r.$$.fragment,a),l=!0)},o(a){h(e.$$.fragment,a),h(r.$$.fragment,a),l=!1},d(a){a&&I(t),E(e,a),E(r,a)}}}function mt(n,e,t){let r;return _e(n,Ce,l=>t(0,r=l)),[r]}class qt extends Oe{constructor(e){super(),qe(this,e,mt,pt,Se,{})}}export{qt as component,Ot as universal};
