import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as tt,l as M,s as T,m as A,g as t,a as ft,e as _,r as w,b as et,f as B,d as s,c as g,n as N,t as L}from"../chunks/BZ1i_Yzi.js";import{t as P,a as u,c as O,b as V}from"../chunks/B11KKQxI.js";import{i as ot}from"../chunks/EXou6kTq.js";import{a as C,s as rt}from"../chunks/nHCSEYHe.js";import{p as st}from"../chunks/Bbra2E9T.js";import{P as mt}from"../chunks/BSbw5w3E.js";import{t as a}from"../chunks/D2OY9xdY.js";import{W as ut}from"../chunks/CJAtYjGZ.js";import{s as y}from"../chunks/BtIgVYD3.js";import{a as dt}from"../chunks/C5EvHk3S.js";import{i as X}from"../chunks/Pfo2U1_a.js";import{A as vt}from"../chunks/CR4vVWSJ.js";import{B as kt}from"../chunks/C7lvn3c4.js";import{C as _t}from"../chunks/C2k67nnR.js";import{E as Y}from"../chunks/BH5Z54-t.js";import{L as wt}from"../chunks/t_E13Tfw.js";import{L as gt}from"../chunks/CJSepuex.js";import{g as Z}from"../chunks/Dx6ef63X.js";import{a as $t}from"../chunks/BipkNA2r.js";import{w as xt}from"../chunks/Dp52_Yis.js";var ht=P('<!> <div class="flex items-center gap-4"><!> <p> </p></div> <div class="my-2 flex h-full items-start"><!></div>',1),yt=P('<div class="text-center"><!> <p> </p></div>'),bt=P("<p> <!> </p>"),Tt=P("<section><!></section>");function Lt(D,E){tt(E,!1);const[b,Q]=rt(),$=()=>C(st,"$page",b),R=()=>C(xt,"$workflowRun",b),l=()=>C($t,"$authUser",b),r=A(),x=A(),{namespace:I}=$().params;let S=A(new Date),H=!1;const at=()=>{var e;return Z({workflow:t(r),namespace:I},(e=$().data)===null||e===void 0?void 0:e.settings,l()===null||l()===void 0?void 0:l().accessToken)};let q=A();const nt=()=>{var e;T(q,Z({workflow:t(r),namespace:I},(e=$().data)===null||e===void 0?void 0:e.settings,l()===null||l()===void 0?void 0:l().accessToken)),t(q).then(()=>{T(S,new Date)})};M(()=>(t(r),t(x),R()),()=>{(e=>(T(r,e.workflow),T(x,e.workers)))(R())}),M(()=>t(r),()=>{!(t(r)===null||t(r)===void 0)&&t(r).isRunning&&T(q,at())}),ft(),ot();var j=Tt(),lt=_(j);{var ct=e=>{var k=O(),h=B(k);dt(h,()=>t(q),c=>{var n=yt(),i=_(n);gt(i,{});var p=g(i,2),f=_(p,!0);w(p),w(n),L(o=>y(f,o),[()=>a("workflows.no-workers-failure-message")],s),u(c,n)},(c,n)=>{var i=ht(),p=B(i);const f=s(()=>a("workflows.call-stack-alert"));vt(p,{intent:"info",icon:"info",get title(){return t(f)},class:"mb-4 w-fit"});var o=g(p,2),d=_(o);kt(d,{leadingIcon:"retry",loading:H,$$events:{click:nt},children:(G,J)=>{N();var K=V();L(pt=>y(K,pt),[()=>a("common.refresh")],s),u(G,K)},$$slots:{default:!0}});var v=g(d,2),z=_(v);w(v),w(o);var m=g(o,2),W=_(m);const U=s(()=>a("common.copy-icon-title")),F=s(()=>a("common.copy-success-icon-title"));_t(W,{get content(){return t(n)},language:"text",testId:"query-call-stack",get copyIconTitle(){return t(U)},get copySuccessIconTitle(){return t(F)}}),w(m),L((G,J)=>y(z,`${G??""}
          ${J??""}`),[()=>a("workflows.call-stack-at"),()=>t(S).toLocaleTimeString()],s),u(c,i)},(c,n)=>{const i=s(()=>a("common.error-occurred")),p=s(()=>a("workflows.no-workers-running-message")),f=s(()=>{var o;return(o=t(n))==null?void 0:o.message});Y(c,{get title(){return t(i)},get content(){return t(p)},get error(){return t(f)}})}),u(e,k)},it=e=>{const k=s(()=>a("workflows.call-stack-empty-state"));Y(e,{get title(){return t(k)},testId:"query-call-stack-empty",children:(h,c)=>{var n=O(),i=B(n);{var p=f=>{var o=bt(),d=_(o,!0),v=g(d);wt(v,{newTab:!0,href:"https://docs.temporal.io/workflows#stack-trace-query",children:(m,W)=>{N();var U=V();L(F=>y(U,F),[()=>a("workflows.call-stack-link")],s),u(m,U)},$$slots:{default:!0}});var z=g(v,1,!0);w(o),L((m,W)=>{y(d,m),y(z,W)},[()=>a("workflows.call-stack-link-preface"),()=>{var m;return a("workflows.call-stack-link-postface",{taskQueue:(m=t(r))==null?void 0:m.taskQueue})}],s),u(f,o)};X(i,f=>{var o,d,v;(o=t(r))!=null&&o.isRunning&&((v=(d=t(x))==null?void 0:d.pollers)==null?void 0:v.length)===0&&f(p)})}u(h,n)},$$slots:{default:!0}})};X(lt,e=>{var k,h,c;(k=t(r))!=null&&k.isRunning&&((c=(h=t(x))==null?void 0:h.pollers)==null?void 0:c.length)>0?e(ct):e(it,!1)})}w(j),u(D,j),et(),Q()}var Pt=P("<!> <!>",1);function Vt(D,E){tt(E,!1);const[b,Q]=rt(),$=()=>C(st,"$page",b),R=$().params.workflow;ot();var l=Pt(),r=B(l);const x=s(()=>`${a("workflows.call-stack-tab")} | ${R}`);mt(r,{get title(){return t(x)},get url(){return $().url.href}});var I=g(r,2);ut(I,{children:(S,H)=>{Lt(S,{})},$$slots:{default:!0}}),u(D,l),et(),Q()}export{Vt as component};
