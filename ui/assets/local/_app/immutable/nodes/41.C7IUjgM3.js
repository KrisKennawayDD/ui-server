import{s as ae,h as T,j,k as C,f as p,i as w,c as L,b as O,d as R,m as B,n as W,t as J,l as K,v as P,O as Z,Q as x,x as ee,y as we,q as fe}from"../chunks/scheduler.D6mQsyhd.js";import{S as ue,i as ie,g as ce,b as g,e as me,t as _,c as k,a as b,m as v,d as y,h as te}from"../chunks/index.CDeUyeTp.js";import{p as pe}from"../chunks/stores.CEQTmKxB.js";import{P as ke}from"../chunks/page-title.h9prjCqF.js";import{t as h}from"../chunks/translate.BBe5dcco.js";import{W as be}from"../chunks/workflow-padded-layout.BPV8C06U.js";import{h as re,u as ve}from"../chunks/await_block.84Q0hgOp.js";import{e as oe}from"../chunks/each.5YhwczXz.js";import{P as ye}from"../chunks/payload-input.DqX7suPn.js";import{B as qe}from"../chunks/button.DsRXJZOy.js";import{C as Ie}from"../chunks/card.nkKic5l3.js";import{C as Ee}from"../chunks/code-block.DN6vuBnh.js";import{E as _e}from"../chunks/empty-state.CdXD21ju.js";import{L as Pe}from"../chunks/loading.azOfDUyA.js";import{S as Te,O as je}from"../chunks/option.LEGQzc7Y.js";import{T as Ce}from"../chunks/toggle-switch.D3NdiBBW.js";import{a as De}from"../chunks/query-service.BiY8rIpv.js";import{a as Se}from"../chunks/auth-user.CUDja-nW.js";import{w as Ve}from"../chunks/workflow-run.Bypp4j5d.js";import{e as Be}from"../chunks/encode-payload.CtknhyJt.js";import{s as Oe}from"../chunks/parse-with-big-int.Dyr6jPtv.js";function ne(s){s[30]=s[32][0],s[31]=s[32][1];const e=typeof s[30]!="string"?Oe(s[30]):s[30];s[33]=e}function le(s,e,t){const r=s.slice();return r[32]=e[t].name,r[35]=e[t].description!==void 0?e[t].description:"",r}function Re(s){let e,t,r,o,a,n;t=new Ie({props:{class:"mt-7 flex h-fit w-full flex-col gap-2",$$slots:{default:[Ae]},$$scope:{ctx:s}}});let f={ctx:s,current:null,token:null,hasCatch:!0,pending:Ge,then:ze,catch:Fe,value:32,error:34,blocks:[,,,]};return re(a=Promise.all([s[6],s[7]]),f),{c(){e=T("div"),k(t.$$.fragment),r=O(),o=T("div"),f.block.c(),this.h()},l(l){e=j(l,"DIV",{class:!0});var u=C(e);b(t.$$.fragment,u),r=R(u),o=j(u,"DIV",{class:!0});var c=C(o);f.block.l(c),c.forEach(p),u.forEach(p),this.h()},h(){B(o,"class","flex w-full flex-col gap-2"),B(e,"class","flex w-3/4 gap-4 max-2xl:w-full max-lg:flex-col")},m(l,u){w(l,e,u),v(t,e,null),W(e,r),W(e,o),f.block.m(o,f.anchor=null),f.mount=()=>o,f.anchor=null,n=!0},p(l,u){s=l;const c={};u[0]&535|u[1]&128&&(c.$$scope={dirty:u,ctx:s}),t.$set(c),f.ctx=s,u[0]&192&&a!==(a=Promise.all([s[6],s[7]]))&&re(a,f)||ve(f,s,u)},i(l){n||(_(t.$$.fragment,l),_(f.block),n=!0)},o(l){g(t.$$.fragment,l);for(let u=0;u<3;u+=1){const c=f.blocks[u];g(c)}n=!1},d(l){l&&p(e),y(t),f.block.d(),f.token=null,f=null}}}function We(s){let e,t,r,o,a=h("workflows.no-workers-failure-message")+"",n,f;return t=new Pe({}),{c(){e=T("div"),k(t.$$.fragment),r=O(),o=T("p"),n=J(a),this.h()},l(l){e=j(l,"DIV",{class:!0});var u=C(e);b(t.$$.fragment,u),r=R(u),o=j(u,"P",{class:!0});var c=C(o);n=K(c,a),c.forEach(p),u.forEach(p),this.h()},h(){B(o,"class","-mt-10"),B(e,"class","text-center")},m(l,u){w(l,e,u),v(t,e,null),W(e,r),W(e,o),W(o,n),f=!0},p:P,i(l){f||(_(t.$$.fragment,l),f=!0)},o(l){g(t.$$.fragment,l),f=!1},d(l){l&&p(e),y(t)}}}function Qe(s){var r,o;let e,t;return e=new _e({props:{title:h("common.error-occurred"),content:h("workflows.no-workers-running-message"),error:(o=(r=s[3].metadata)==null?void 0:r.error)==null?void 0:o.message}}),{c(){k(e.$$.fragment)},l(a){b(e.$$.fragment,a)},m(a,n){v(e,a,n),t=!0},p(a,n){var l,u;const f={};n[0]&8&&(f.error=(u=(l=a[3].metadata)==null?void 0:l.error)==null?void 0:u.message),e.$set(f)},i(a){t||(_(e.$$.fragment,a),t=!0)},o(a){g(e.$$.fragment,a),t=!1},d(a){y(e,a)}}}function Le(s){let e=s[32]+"",t;return{c(){t=J(e)},l(r){t=K(r,e)},m(r,o){w(r,t,o)},p(r,o){o[0]&4&&e!==(e=r[32]+"")&&fe(t,e)},d(r){r&&p(t)}}}function se(s){let e,t;return e=new je({props:{value:s[32],description:s[35],$$slots:{default:[Le]},$$scope:{ctx:s}}}),{c(){k(e.$$.fragment)},l(r){b(e.$$.fragment,r)},m(r,o){v(e,r,o),t=!0},p(r,o){const a={};o[0]&4&&(a.value=r[32]),o[0]&4&&(a.description=r[35]),o[0]&4|o[1]&128&&(a.$$scope={dirty:o,ctx:r}),e.$set(a)},i(r){t||(_(e.$$.fragment,r),t=!0)},o(r){g(e.$$.fragment,r),t=!1},d(r){y(e,r)}}}function Ne(s){let e,t,r=oe(s[2]),o=[];for(let n=0;n<r.length;n+=1)o[n]=se(le(s,r,n));const a=n=>g(o[n],1,1,()=>{o[n]=null});return{c(){for(let n=0;n<o.length;n+=1)o[n].c();e=ee()},l(n){for(let f=0;f<o.length;f+=1)o[f].l(n);e=ee()},m(n,f){for(let l=0;l<o.length;l+=1)o[l]&&o[l].m(n,f);w(n,e,f),t=!0},p(n,f){if(f[0]&4){r=oe(n[2]);let l;for(l=0;l<r.length;l+=1){const u=le(n,r,l);o[l]?(o[l].p(u,f),_(o[l],1)):(o[l]=se(u),o[l].c(),_(o[l],1),o[l].m(e.parentNode,e))}for(ce(),l=r.length;l<o.length;l+=1)a(l);me()}},i(n){if(!t){for(let f=0;f<r.length;f+=1)_(o[f]);t=!0}},o(n){o=o.filter(Boolean);for(let f=0;f<o.length;f+=1)g(o[f]);t=!1},d(n){n&&p(e),we(o,n)}}}function Ue(s){let e=(s[9]?h("workflows.run-query"):h("workflows.refresh-query"))+"",t;return{c(){t=J(e)},l(r){t=K(r,e)},m(r,o){w(r,t,o)},p(r,o){o[0]&512&&e!==(e=(r[9]?h("workflows.run-query"):h("workflows.refresh-query"))+"")&&fe(t,e)},d(r){r&&p(t)}}}function Ae(s){let e,t,r,o,a,n,f,l,u,c;function D(i){s[19](i)}let q={id:"query-select",label:h("workflows.query-type"),class:"min-w-fit","data-testid":"query-select",required:!0,$$slots:{default:[Ne]},$$scope:{ctx:s}};s[0]!==void 0&&(q.value=s[0]),e=new Te({props:q}),Z.push(()=>te(e,"value",D));function S(i){s[20](i)}let I={label:h("workflows.query-arg")};return s[1]!==void 0&&(I.input=s[1]),a=new ye({props:I}),Z.push(()=>te(a,"input",S)),u=new qe({props:{loading:s[4],variant:s[9]?"primary":"secondary",leadingIcon:s[9]?null:"retry",disabled:s[4],$$slots:{default:[Ue]},$$scope:{ctx:s}}}),u.$on("click",s[21]),{c(){k(e.$$.fragment),r=O(),o=T("div"),k(a.$$.fragment),f=O(),l=T("div"),k(u.$$.fragment),this.h()},l(i){b(e.$$.fragment,i),r=R(i),o=j(i,"DIV",{class:!0});var m=C(o);b(a.$$.fragment,m),m.forEach(p),f=R(i),l=j(i,"DIV",{class:!0});var E=C(l);b(u.$$.fragment,E),E.forEach(p),this.h()},h(){B(o,"class","flex flex-col gap-1"),B(l,"class","flex w-full flex-wrap items-end justify-end gap-4")},m(i,m){v(e,i,m),w(i,r,m),w(i,o,m),v(a,o,null),w(i,f,m),w(i,l,m),v(u,l,null),c=!0},p(i,m){const E={};m[0]&4|m[1]&128&&(E.$$scope={dirty:m,ctx:i}),!t&&m[0]&1&&(t=!0,E.value=i[0],x(()=>t=!1)),e.$set(E);const Q={};!n&&m[0]&2&&(n=!0,Q.input=i[1],x(()=>n=!1)),a.$set(Q);const d={};m[0]&16&&(d.loading=i[4]),m[0]&512&&(d.variant=i[9]?"primary":"secondary"),m[0]&512&&(d.leadingIcon=i[9]?null:"retry"),m[0]&16&&(d.disabled=i[4]),m[0]&512|m[1]&128&&(d.$$scope={dirty:m,ctx:i}),u.$set(d)},i(i){c||(_(e.$$.fragment,i),_(a.$$.fragment,i),_(u.$$.fragment,i),c=!0)},o(i){g(e.$$.fragment,i),g(a.$$.fragment,i),g(u.$$.fragment,i),c=!1},d(i){i&&(p(r),p(o),p(f),p(l)),y(e,i),y(a),y(u)}}}function Fe(s){var r;let e,t;return e=new _e({props:{title:h("common.error-occurred"),error:(r=s[34])==null?void 0:r.message}}),{c(){k(e.$$.fragment)},l(o){b(e.$$.fragment,o)},m(o,a){v(e,o,a),t=!0},p(o,a){var f;const n={};a[0]&192&&(n.error=(f=o[34])==null?void 0:f.message),e.$set(n)},i(o){t||(_(e.$$.fragment,o),t=!0)},o(o){g(e.$$.fragment,o),t=!1},d(o){y(e,o)}}}function ze(s){ne(s);let e,t,r,o,a;return t=new Ce({props:{label:h("workflows.json-formatting"),labelPosition:"left",id:"json-formatting",checked:s[5]}}),t.$on("change",s[22]),o=new Ee({props:{content:s[33],language:s[5]?"json":"text",copyIconTitle:h("common.copy-icon-title"),copySuccessIconTitle:h("common.copy-success-icon-title"),testId:"query-result",class:s[9]&&"opacity-50"}}),{c(){e=T("div"),k(t.$$.fragment),r=O(),k(o.$$.fragment),this.h()},l(n){e=j(n,"DIV",{class:!0});var f=C(e);b(t.$$.fragment,f),f.forEach(p),r=R(n),b(o.$$.fragment,n),this.h()},h(){B(e,"class","ml-auto")},m(n,f){w(n,e,f),v(t,e,null),w(n,r,f),v(o,n,f),a=!0},p(n,f){ne(n);const l={};f[0]&32&&(l.checked=n[5]),t.$set(l);const u={};f[0]&192&&(u.content=n[33]),f[0]&32&&(u.language=n[5]?"json":"text"),f[0]&512&&(u.class=n[9]&&"opacity-50"),o.$set(u)},i(n){a||(_(t.$$.fragment,n),_(o.$$.fragment,n),a=!0)},o(n){g(t.$$.fragment,n),g(o.$$.fragment,n),a=!1},d(n){n&&(p(e),p(r)),y(t),y(o,n)}}}function Ge(s){return{c:P,l:P,m:P,p:P,i:P,o:P,d:P}}function He(s){let e,t,r,o;const a=[Qe,We,Re],n=[];function f(l,u){return l[8]?0:l[2].length?2:1}return t=f(s),r=n[t]=a[t](s),{c(){e=T("section"),r.c()},l(l){e=j(l,"SECTION",{});var u=C(e);r.l(u),u.forEach(p)},m(l,u){w(l,e,u),n[t].m(e,null),o=!0},p(l,u){let c=t;t=f(l),t===c?n[t].p(l,u):(ce(),g(n[c],1,1,()=>{n[c]=null}),me(),r=n[t],r?r.p(l,u):(r=n[t]=a[t](l),r.c()),_(r,1),r.m(e,null))},i(l){o||(_(r),o=!0)},o(l){g(r),o=!1},d(l){l&&p(e),n[t].d()}}}function Je(s,e,t){let r,o,a,n,f,l;L(s,Se,$=>t(23,n=$)),L(s,pe,$=>t(24,f=$)),L(s,Ve,$=>t(3,l=$));var u,c,D,q,S,I;const{namespace:i,workflow:m,run:E}=f.params,Q={id:m,runId:E};let d,N,V="",U="",A=!1,F=!0,M,z;const X=()=>{t(4,A=!1),t(17,N=d),t(18,U=V)},Y=async $=>{var G;t(4,A=!0);let H;try{t(7,z=V?Be(V,"json/plain",!1):Promise.resolve(null)),H=await z}catch{X();return}t(6,M=De({namespace:i,workflow:Q,queryType:$,queryArgs:H?{payloads:H}:null},(G=f.data)===null||G===void 0?void 0:G.settings,n==null?void 0:n.accessToken).finally(()=>{X()}))};function ge($){d=$,t(0,d),t(2,a),t(16,I),t(3,l),t(13,D),t(14,q),t(15,S)}function de($){V=$,t(1,V)}const $e=()=>Y(d),he=()=>t(5,F=!F);return s.$$.update=()=>{s.$$.dirty[0]&57352&&t(2,a=(t(15,S=t(14,q=t(13,D=l==null?void 0:l.metadata)===null||D===void 0?void 0:D.definition)===null||q===void 0?void 0:q.queryDefinitions)===null||S===void 0?void 0:S.filter($=>($==null?void 0:$.name)!=="__stack_trace"))||[]),s.$$.dirty[0]&65541&&t(0,d=d||(t(16,I=a==null?void 0:a[0])===null||I===void 0?void 0:I.name)),s.$$.dirty[0]&393219&&t(9,r=N!==d||V!==U),s.$$.dirty[0]&6152&&t(8,o=t(12,c=t(11,u=l.metadata)===null||u===void 0?void 0:u.error)===null||c===void 0?void 0:c.message)},[d,V,a,l,A,F,M,z,o,r,Y,u,c,D,q,S,I,N,U,ge,de,$e,he]}class Ke extends ue{constructor(e){super(),ie(this,e,Je,He,ae,{},null,[-1,-1])}}function Me(s){let e,t;return e=new Ke({}),{c(){k(e.$$.fragment)},l(r){b(e.$$.fragment,r)},m(r,o){v(e,r,o),t=!0},i(r){t||(_(e.$$.fragment,r),t=!0)},o(r){g(e.$$.fragment,r),t=!1},d(r){y(e,r)}}}function Xe(s){let e,t,r,o;return e=new ke({props:{title:`${h("workflows.queries-tab")} | ${s[1]}`,url:s[0].url.href}}),r=new be({props:{$$slots:{default:[Me]},$$scope:{ctx:s}}}),{c(){k(e.$$.fragment),t=O(),k(r.$$.fragment)},l(a){b(e.$$.fragment,a),t=R(a),b(r.$$.fragment,a)},m(a,n){v(e,a,n),w(a,t,n),v(r,a,n),o=!0},p(a,[n]){const f={};n&1&&(f.url=a[0].url.href),e.$set(f);const l={};n&4&&(l.$$scope={dirty:n,ctx:a}),r.$set(l)},i(a){o||(_(e.$$.fragment,a),_(r.$$.fragment,a),o=!0)},o(a){g(e.$$.fragment,a),g(r.$$.fragment,a),o=!1},d(a){a&&p(t),y(e,a),y(r,a)}}}function Ye(s,e,t){let r;L(s,pe,a=>t(0,r=a));const o=r.params.workflow;return[r,o]}class kt extends ue{constructor(e){super(),ie(this,e,Ye,Xe,ae,{})}}export{kt as component};
