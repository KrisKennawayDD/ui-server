import{r as Be}from"../chunks/index.g5YcAAdQ.js";import{e as he,b as Je,g as Ie}from"../chunks/route-for.cCUMa9hN.js";import{s as ve,h as B,b as j,j as J,k as G,d as D,o as Me,f as _,m as X,i as h,n as N,c as de,W as Ke,t as Y,l as Z,v as le,O as ne,x as Te,Q as se,R as Ge,q as Se}from"../chunks/scheduler.9nPpm2FE.js";import{S as Ce,i as Oe,c as P,a as y,m as Q,t as b,b as k,d as E,h as ae,g as ce,e as $e}from"../chunks/index.DU2w1i_i.js";import{p as qe}from"../chunks/stores.D7vvjZHH.js";import{P as Xe}from"../chunks/page-title.BVcIpxci.js";import{w as Ye}from"../chunks/entry.CWLAi35G.js";import{P as Ze}from"../chunks/payload-input-with-encoding.fiYANLJz.js";import{A as xe}from"../chunks/add-search-attributes.YnWhnz1R.js";import{A as Fe}from"../chunks/alert.NGZ0VcR0.js";import{B as be}from"../chunks/button.B9KJZ_sq.js";import{C as Ne}from"../chunks/card.L31Vb8Ak.js";import{I as et}from"../chunks/icon.BMRA5wr6.js";import{I as ke}from"../chunks/input.D2z507HA.js";import{L as Ae}from"../chunks/label.DUQKmP4k.js";import{L as Re}from"../chunks/link.DdyDgg3R.js";import{E as Pe}from"../chunks/editor.VApz58lY.js";import{T as tt}from"../chunks/tooltip.Djva02zh.js";import{t as H}from"../chunks/translate.BBe5dcco.js";import{g as rt}from"../chunks/pollers-service.BberH4kd.js";import{c as nt,e as st,g as at}from"../chunks/workflows.3u63bX4o.js";import{c as lt}from"../chunks/search-attributes.DlND9Yni.js";import{t as ye,v as ot}from"../chunks/toaster.gJNmuSOX.js";import{p as Qe}from"../chunks/format-time.B41gu77r.js";import{u as Ee}from"../chunks/update-query-parameters.pLfMk9Ir.js";import{w as ut}from"../chunks/workflow-create-disabled.CY46qaBD.js";const ft=async function({params:n,parent:e}){if((await e()).settings.startWorkflowDisabled){const{namespace:r}=n;Be(302,he({namespace:r}))}},Xt=Object.freeze(Object.defineProperty({__proto__:null,load:ft},Symbol.toStringTag,{value:"Module"}));function it(n){let e=H("workflows.back-to-workflows")+"",t;return{c(){t=Y(e)},l(r){t=Z(r,e)},m(r,o){h(r,t,o)},p:le,d(r){r&&_(t)}}}function pt(n){let e;return{c(){e=Y("Random UUID")},l(t){e=Z(t,"Random UUID")},m(t,r){h(t,e,r)},d(t){t&&_(e)}}}function We(n){let e,t;return e=new Fe({props:{intent:n[9]>0?"success":"warning",title:n[9]?"Task Queue is Active":"Task Queue is Inactive",$$slots:{default:[ct]},$$scope:{ctx:n}}}),{c(){P(e.$$.fragment)},l(r){y(e.$$.fragment,r)},m(r,o){Q(e,r,o),t=!0},p(r,o){const l={};o[0]&512&&(l.intent=r[9]>0?"success":"warning"),o[0]&512&&(l.title=r[9]?"Task Queue is Active":"Task Queue is Inactive"),o[0]&8706|o[1]&512&&(l.$$scope={dirty:o,ctx:r}),e.$set(l)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){E(e,r)}}}function mt(n){let e;return{c(){e=Y("View Task Queue")},l(t){e=Z(t,"View Task Queue")},m(t,r){h(t,e,r)},d(t){t&&_(e)}}}function ct(n){let e,t,r,o,l=Qe("Worker",n[9])+"",$,p,a,f;return a=new Re({props:{href:Ie({namespace:n[13],queue:n[1]}),newTab:!0,$$slots:{default:[mt]},$$scope:{ctx:n}}}),{c(){e=B("div"),t=B("p"),r=Y(n[9]),o=j(),$=Y(l),p=j(),P(a.$$.fragment),this.h()},l(u){e=J(u,"DIV",{class:!0});var d=G(e);t=J(d,"P",{});var g=G(t);r=Z(g,n[9]),o=D(g),$=Z(g,l),g.forEach(_),p=D(d),y(a.$$.fragment,d),d.forEach(_),this.h()},h(){X(e,"class","flex w-full items-center justify-between")},m(u,d){h(u,e,d),N(e,t),N(t,r),N(t,o),N(t,$),N(e,p),Q(a,e,null),f=!0},p(u,d){(!f||d[0]&512)&&Se(r,u[9]),(!f||d[0]&512)&&l!==(l=Qe("Worker",u[9])+"")&&Se($,l);const g={};d[0]&8194&&(g.href=Ie({namespace:u[13],queue:u[1]})),d[1]&512&&(g.$$scope={dirty:d,ctx:u}),a.$set(g)},i(u){f||(b(a.$$.fragment,u),f=!0)},o(u){k(a.$$.fragment,u),f=!1},d(u){u&&_(e),E(a)}}}function je(n){let e,t,r,o;function l(a){n[27](a)}function $(a){n[28](a)}let p={};return n[3]!==void 0&&(p.input=n[3]),n[6]!==void 0&&(p.encoding=n[6]),e=new Ze({props:p}),ne.push(()=>ae(e,"input",l)),ne.push(()=>ae(e,"encoding",$)),{c(){P(e.$$.fragment)},l(a){y(e.$$.fragment,a)},m(a,f){Q(e,a,f),o=!0},p(a,f){const u={};!t&&f[0]&8&&(t=!0,u.input=a[3],se(()=>t=!1)),!r&&f[0]&64&&(r=!0,u.encoding=a[6],se(()=>r=!1)),e.$set(u)},i(a){o||(b(e.$$.fragment,a),o=!0)},o(a){k(e.$$.fragment,a),o=!1},d(a){E(e,a)}}}function De(n){let e,t,r,o,l;e=new Ne({props:{class:"flex flex-col gap-2",$$slots:{default:[dt]},$$scope:{ctx:n}}});function $(a){n[31](a)}let p={};return n[11]!==void 0&&(p.attributesToAdd=n[11]),r=new xe({props:p}),ne.push(()=>ae(r,"attributesToAdd",$)),{c(){P(e.$$.fragment),t=j(),P(r.$$.fragment)},l(a){y(e.$$.fragment,a),t=D(a),y(r.$$.fragment,a)},m(a,f){Q(e,a,f),h(a,t,f),Q(r,a,f),l=!0},p(a,f){const u={};f[0]&48|f[1]&512&&(u.$$scope={dirty:f,ctx:a}),e.$set(u);const d={};!o&&f[0]&2048&&(o=!0,d.attributesToAdd=a[11],se(()=>o=!1)),r.$set(d)},i(a){l||(b(e.$$.fragment,a),b(r.$$.fragment,a),l=!0)},o(a){k(e.$$.fragment,a),k(r.$$.fragment,a),l=!1},d(a){a&&_(t),E(e,a),E(r,a)}}}function $t(n){let e,t;return e=new et({props:{name:"info"}}),{c(){P(e.$$.fragment)},l(r){y(e.$$.fragment,r)},m(r,o){Q(e,r,o),t=!0},p:le,i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){E(e,r)}}}function dt(n){let e,t,r=H("workflows.user-metadata")+"",o,l,$,p=H("workflows.markdown-supported")+"",a,f,u,d,g,C,W,R,I,q,v,V;return u=new tt({props:{topRight:!0,width:200,text:H("workflows.markdown-description"),$$slots:{default:[$t]},$$scope:{ctx:n}}}),g=new Ae({props:{label:H("workflows.summary"),for:"summary"}}),W=new Pe({props:{content:n[4],class:"min-h-48"}}),W.$on("change",n[29]),I=new Ae({props:{label:H("workflows.details"),for:"details"}}),v=new Pe({props:{content:n[5]}}),v.$on("change",n[30]),{c(){e=B("div"),t=B("h3"),o=Y(r),l=j(),$=B("p"),a=Y(p),f=j(),P(u.$$.fragment),d=j(),P(g.$$.fragment),C=j(),P(W.$$.fragment),R=j(),P(I.$$.fragment),q=j(),P(v.$$.fragment),this.h()},l(i){e=J(i,"DIV",{class:!0});var w=G(e);t=J(w,"H3",{});var L=G(t);o=Z(L,r),L.forEach(_),l=D(w),$=J(w,"P",{class:!0});var O=G($);a=Z(O,p),f=D(O),y(u.$$.fragment,O),O.forEach(_),w.forEach(_),d=D(i),y(g.$$.fragment,i),C=D(i),y(W.$$.fragment,i),R=D(i),y(I.$$.fragment,i),q=D(i),y(v.$$.fragment,i),this.h()},h(){X($,"class","flex items-center gap-1 text-sm text-subtle"),X(e,"class","flex flex-wrap justify-between")},m(i,w){h(i,e,w),N(e,t),N(t,o),N(e,l),N(e,$),N($,a),N($,f),Q(u,$,null),h(i,d,w),Q(g,i,w),h(i,C,w),Q(W,i,w),h(i,R,w),Q(I,i,w),h(i,q,w),Q(v,i,w),V=!0},p(i,w){const L={};w[1]&512&&(L.$$scope={dirty:w,ctx:i}),u.$set(L);const O={};w[0]&16&&(O.content=i[4]),W.$set(O);const z={};w[0]&32&&(z.content=i[5]),v.$set(z)},i(i){V||(b(u.$$.fragment,i),b(g.$$.fragment,i),b(W.$$.fragment,i),b(I.$$.fragment,i),b(v.$$.fragment,i),V=!0)},o(i){k(u.$$.fragment,i),k(g.$$.fragment,i),k(W.$$.fragment,i),k(I.$$.fragment,i),k(v.$$.fragment,i),V=!1},d(i){i&&(_(e),_(d),_(C),_(R),_(q)),E(u),E(g,i),E(W,i),E(I,i),E(v,i)}}}function _t(n){let e=H("common.more-options")+"",t;return{c(){t=Y(e)},l(r){t=Z(r,e)},m(r,o){h(r,t,o)},p:le,d(r){r&&_(t)}}}function gt(n){let e=H("workflows.start-workflow")+"",t;return{c(){t=Y(e)},l(r){t=Z(r,e)},m(r,o){h(r,t,o)},p:le,d(r){r&&_(t)}}}function Ve(n){let e,t;return e=new Fe({props:{intent:"error",title:n[8]}}),{c(){P(e.$$.fragment)},l(r){y(e.$$.fragment,r)},m(r,o){Q(e,r,o),t=!0},p(r,o){const l={};o[0]&256&&(l.title=r[8]),e.$set(l)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){E(e,r)}}}function wt(n){let e,t,r,o,l,$,p,a,f,u,d,g,C,W,R=n[7],I,q,v,V,i,w,L,O,z;function te(s){n[21](s)}let M={id:"workflowId",required:!0,label:"Workflow ID",class:"w-full grow"};n[0]!==void 0&&(M.value=n[0]),t=new ke({props:M}),ne.push(()=>ae(t,"value",te)),t.$on("blur",n[22]),l=new be({props:{class:"mt-0 md:mt-6",variant:"secondary",leadingIcon:"retry",$$slots:{default:[pt]},$$scope:{ctx:n}}}),l.$on("click",n[16]);function _e(s){n[23](s)}let ie={id:"taskQueue",required:!0,label:"Task Queue",class:"grow"};n[1]!==void 0&&(ie.value=n[1]),a=new ke({props:ie}),ne.push(()=>ae(a,"value",_e)),a.$on("blur",n[24]);let T=n[9]!==void 0&&We(n);function ge(s){n[25](s)}let x={id:"workflowType",required:!0,label:"Workflow Type"};n[2]!==void 0&&(x.value=n[2]),g=new ke({props:x}),ne.push(()=>ae(g,"value",ge)),g.$on("blur",n[26]);let U=je(n),S=n[10]&&De(n);V=new be({props:{variant:"ghost",class:"max-sm:w-full",trailingIcon:n[10]?"chevron-up":"chevron-down",$$slots:{default:[_t]},$$scope:{ctx:n}}}),V.$on("click",n[32]),w=new be({props:{disabled:!n[12],"data-testid":"start-workflow-button",class:"max-sm:w-full",$$slots:{default:[gt]},$$scope:{ctx:n}}}),w.$on("click",n[15]);let A=n[8]&&Ve(n);return{c(){e=B("div"),P(t.$$.fragment),o=j(),P(l.$$.fragment),$=j(),p=B("div"),P(a.$$.fragment),u=j(),T&&T.c(),d=j(),P(g.$$.fragment),W=j(),U.c(),I=j(),S&&S.c(),q=j(),v=B("div"),P(V.$$.fragment),i=j(),P(w.$$.fragment),L=j(),A&&A.c(),O=Te(),this.h()},l(s){e=J(s,"DIV",{class:!0});var c=G(e);y(t.$$.fragment,c),o=D(c),y(l.$$.fragment,c),c.forEach(_),$=D(s),p=J(s,"DIV",{class:!0});var ee=G(p);y(a.$$.fragment,ee),ee.forEach(_),u=D(s),T&&T.l(s),d=D(s),y(g.$$.fragment,s),W=D(s),U.l(s),I=D(s),S&&S.l(s),q=D(s),v=J(s,"DIV",{class:!0});var K=G(v);y(V.$$.fragment,K),i=D(K),y(w.$$.fragment,K),K.forEach(_),L=D(s),A&&A.l(s),O=Te(),this.h()},h(){X(e,"class","flex w-full flex-col justify-between gap-2 sm:items-center md:flex-row md:gap-4"),X(p,"class","flex w-full items-center justify-between gap-4"),X(v,"class","mt-4 flex w-full flex-row justify-between gap-4 max-sm:flex-col")},m(s,c){h(s,e,c),Q(t,e,null),N(e,o),Q(l,e,null),h(s,$,c),h(s,p,c),Q(a,p,null),h(s,u,c),T&&T.m(s,c),h(s,d,c),Q(g,s,c),h(s,W,c),U.m(s,c),h(s,I,c),S&&S.m(s,c),h(s,q,c),h(s,v,c),Q(V,v,null),N(v,i),Q(w,v,null),h(s,L,c),A&&A.m(s,c),h(s,O,c),z=!0},p(s,c){const ee={};!r&&c[0]&1&&(r=!0,ee.value=s[0],se(()=>r=!1)),t.$set(ee);const K={};c[1]&512&&(K.$$scope={dirty:c,ctx:s}),l.$set(K);const pe={};!f&&c[0]&2&&(f=!0,pe.value=s[1],se(()=>f=!1)),a.$set(pe),s[9]!==void 0?T?(T.p(s,c),c[0]&512&&b(T,1)):(T=We(s),T.c(),b(T,1),T.m(d.parentNode,d)):T&&(ce(),k(T,1,1,()=>{T=null}),$e());const me={};!C&&c[0]&4&&(C=!0,me.value=s[2],se(()=>C=!1)),g.$set(me),c[0]&128&&ve(R,R=s[7])?(ce(),k(U,1,1,le),$e(),U=je(s),U.c(),b(U,1),U.m(I.parentNode,I)):U.p(s,c),s[10]?S?(S.p(s,c),c[0]&1024&&b(S,1)):(S=De(s),S.c(),b(S,1),S.m(q.parentNode,q)):S&&(ce(),k(S,1,1,()=>{S=null}),$e());const oe={};c[0]&1024&&(oe.trailingIcon=s[10]?"chevron-up":"chevron-down"),c[1]&512&&(oe.$$scope={dirty:c,ctx:s}),V.$set(oe);const ue={};c[0]&4096&&(ue.disabled=!s[12]),c[1]&512&&(ue.$$scope={dirty:c,ctx:s}),w.$set(ue),s[8]?A?(A.p(s,c),c[0]&256&&b(A,1)):(A=Ve(s),A.c(),b(A,1),A.m(O.parentNode,O)):A&&(ce(),k(A,1,1,()=>{A=null}),$e())},i(s){z||(b(t.$$.fragment,s),b(l.$$.fragment,s),b(a.$$.fragment,s),b(T),b(g.$$.fragment,s),b(U),b(S),b(V.$$.fragment,s),b(w.$$.fragment,s),b(A),z=!0)},o(s){k(t.$$.fragment,s),k(l.$$.fragment,s),k(a.$$.fragment,s),k(T),k(g.$$.fragment,s),k(U),k(S),k(V.$$.fragment,s),k(w.$$.fragment,s),k(A),z=!1},d(s){s&&(_(e),_($),_(p),_(u),_(d),_(W),_(I),_(q),_(v),_(L),_(O)),E(t),E(l),E(a),T&&T.d(s),E(g,s),U.d(s),S&&S.d(s),E(V),E(w),A&&A.d(s)}}}function bt(n){let e,t,r,o,l="Start a Workflow",$,p,a;return t=new Re({props:{href:`${he({namespace:n[13]})}?${n[14]}`,"data-testid":"back-to-workflows",icon:"chevron-left",$$slots:{default:[it]},$$scope:{ctx:n}}}),p=new Ne({props:{class:"flex w-full flex-col gap-4 xl:w-3/4 2xl:w-1/2",$$slots:{default:[wt]},$$scope:{ctx:n}}}),{c(){e=B("div"),P(t.$$.fragment),r=j(),o=B("h1"),o.textContent=l,$=j(),P(p.$$.fragment),this.h()},l(f){e=J(f,"DIV",{class:!0});var u=G(e);y(t.$$.fragment,u),r=D(u),o=J(u,"H1",{class:!0,"data-testid":!0,"data-svelte-h":!0}),Me(o)!=="svelte-wf0qpn"&&(o.textContent=l),$=D(u),y(p.$$.fragment,u),u.forEach(_),this.h()},h(){X(o,"class","mb-4 overflow-hidden"),X(o,"data-testid","start-workflow"),X(e,"class","flex w-full flex-col gap-4 pb-20")},m(f,u){h(f,e,u),Q(t,e,null),N(e,r),N(e,o),N(e,$),Q(p,e,null),a=!0},p(f,u){const d={};u[0]&24576&&(d.href=`${he({namespace:f[13]})}?${f[14]}`),u[1]&512&&(d.$$scope={dirty:u,ctx:f}),t.$set(d);const g={};u[0]&16383|u[1]&512&&(g.$$scope={dirty:u,ctx:f}),p.$set(g)},i(f){a||(b(t.$$.fragment,f),b(p.$$.fragment,f),a=!0)},o(f){k(t.$$.fragment,f),k(p.$$.fragment,f),a=!1},d(f){f&&_(e),E(t),E(p)}}}function kt(n,e,t){let r,o,l,$,p,a,f,u=le,d=()=>(u(),u=Ge(V,m=>t(36,f=m)),V),g;de(n,qe,m=>t(20,p=m)),de(n,lt,m=>t(35,a=m)),de(n,nt,m=>t(14,g=m)),n.$$.on_destroy.push(()=>u());let C="",W="",R="",I="",q="",v="",V=Ye("json/plain");d();let i=0,w="",L="",O="",z,te=!1,M=[];Ke(()=>{t(0,C=p.url.searchParams.get("workflowId")||""),t(1,W=p.url.searchParams.get("taskQueue")||""),t(2,R=p.url.searchParams.get("workflowType")||""),w=p.url.searchParams.get("workflowId")||"",L=p.url.searchParams.get("workflowType")||"",(w||L)&&ge(w,L)});const _e=async()=>{try{t(8,O="");const{runId:m}=await at({namespace:r,workflowId:C,taskQueue:W,workflowType:R,input:I,summary:q,details:v,encoding:f,searchAttributes:M});ye.push({variant:"success",duration:5e3,message:H("workflows.start-workflow-success"),link:Je({namespace:r,workflow:C,run:m})})}catch(m){t(8,O=(m==null?void 0:m.message)||H("workflows.start-workflow-error")),ye.push({variant:"error",message:H("workflows.start-workflow-error")})}},ie=()=>{t(0,C=ot()),Ee({parameter:"workflowId",value:C,url:p.url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},T=async m=>{if(m){const{pollers:re}=await rt({namespace:r,queue:m});t(9,z=re.length)}},ge=async(m,re)=>{var fe;const F=await st({namespace:r,workflowId:m,workflowType:re});if(t(3,I=F.input),t(7,i=Date.now()),t(4,q=F.summary),t(5,v=F.details),F!=null&&F.searchAttributes){const He=Object.keys(a);Object.entries(F.searchAttributes).forEach(([we,ze])=>{He.includes(we)&&t(11,M=[...M,{label:we,value:ze,type:a[we]}])})}(Object.keys((fe=F==null?void 0:F.searchAttributes)!==null&&fe!==void 0?fe:{}).length||F!=null&&F.summary||F!=null&&F.details)&&t(10,te=!0)},x=(m,re)=>{const fe=m.target.value;Ee({parameter:re,value:fe,url:p.url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},U=m=>{try{return JSON.parse(m),!0}catch{return!1}};function S(m){C=m,t(0,C)}const A=m=>x(m,"workflowId");function s(m){W=m,t(1,W)}const c=m=>x(m,"taskQueue");function ee(m){R=m,t(2,R)}const K=m=>x(m,"workflowType");function pe(m){I=m,t(3,I)}function me(m){V=m,d(t(6,V))}const oe=m=>t(4,q=m.detail.value),ue=m=>t(5,v=m.detail.value);function Le(m){M=m,t(11,M)}const Ue=()=>t(10,te=!te);return n.$$.update=()=>{n.$$.dirty[0]&1048576&&t(13,{namespace:r}=p.params,r),n.$$.dirty[0]&1048576&&t(18,o=p.url.searchParams.get("taskQueue")),n.$$.dirty[0]&8&&t(19,l=!I||U(I)),n.$$.dirty[0]&1572871&&t(12,$=!!C&&!!W&&!!R&&!!l&&!ut(p)),n.$$.dirty[0]&262144&&T(o)},[C,W,R,I,q,v,V,i,O,z,te,M,$,r,g,_e,ie,x,o,l,p,S,A,s,c,ee,K,pe,me,oe,ue,Le,Ue]}class ht extends Ce{constructor(e){super(),Oe(this,e,kt,bt,ve,{},null,[-1,-1])}}function vt(n){let e,t,r,o;return e=new Xe({props:{title:"Start Workflow",url:n[0].url.href}}),r=new ht({}),{c(){P(e.$$.fragment),t=j(),P(r.$$.fragment)},l(l){y(e.$$.fragment,l),t=D(l),y(r.$$.fragment,l)},m(l,$){Q(e,l,$),h(l,t,$),Q(r,l,$),o=!0},p(l,[$]){const p={};$&1&&(p.url=l[0].url.href),e.$set(p)},i(l){o||(b(e.$$.fragment,l),b(r.$$.fragment,l),o=!0)},o(l){k(e.$$.fragment,l),k(r.$$.fragment,l),o=!1},d(l){l&&_(t),E(e,l),E(r,l)}}}function It(n,e,t){let r;return de(n,qe,o=>t(0,r=o)),[r]}class Yt extends Ce{constructor(e){super(),Oe(this,e,It,vt,ve,{})}}export{Yt as component,Xt as universal};
